<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>B.5. Opțiuni avansate</title>
<link rel="stylesheet" type="text/css" href="install.css">
<meta name="generator" content="DocBook XSL Stylesheets Vsnapshot">
<link rel="home" href="index.html" title="Debian GNU/Linux - Ghid de instalare">
<link rel="up" href="apb.html" title="Anexa B. Automatizarea instalării folosind preconfigurarea">
<link rel="prev" href="apbs04.html" title="B.4. Conținutul fișierului de preconfigurare (pentru trixie)">
<link rel="next" href="apc.html" title="Anexa C. Partiționarea pentru Debian">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">B.5. Opțiuni avansate</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="apbs04.html"><img src="images/prev.png" alt="Înapoi"></a> </td>
<th width="60%" align="center">Anexa B. Automatizarea instalării folosind preconfigurarea</th>
<td width="20%" align="right"> <a accesskey="n" href="apc.html"><img src="images/next.png" alt="Înainte"></a>
</td>
</tr>
</table>
<hr>
</div>
<div class="sect1">
<div class="titlepage"><div><div><h2 class="title">
<a name="preseed-advanced"></a>B.5. Opțiuni avansate</h2></div></div></div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-hooks"></a>B.5.1. Rularea comenzilor personalizate în timpul instalării</h3></div></div></div>
<p>O opțiune foarte puternică și flexibilă oferită de instrumentele de preconfigurare este capacitatea de a rula comenzi sau scripturi în anumite puncte ale instalării. </p>
<p>Când sistemul de fișiere al sistemului țintă este montat, acesta este disponibil în <code class="filename">/target</code>. Dacă se folosește un DVD de instalare, atunci când este montat, acesta este disponibil în <code class="filename">/cdrom</code>. </p>
<div class="informalexample"><pre class="screen"># Preconfigurarea d-i este în mod inerent nesigură. Nimic din programul de
# instalare nu verifică încercările de depășire a memoriei tampon sau alte
# exploatări ale valorilor unui fișier de preconfigurare ca acesta. Utilizați
# numai fișiere de preconfigurare din locații de încredere! Din acest motiv,
# și pentru că este în general util, iată o modalitate de a rula automat orice
# comandă de shell pe care o doriți în interiorul programului de instalare.

# Această primă comandă este executată cât mai devreme posibil, imediat
# după ce este citită preconfigurarea.
#d-i preseed/early_command string anna-install some-udeb
# Această comandă se execută imediat înainte de pornirea programului de
# partiționare. Poate fi utilă pentru a aplica preconfigurarea dinamică a
# programului de partiționare, care depinde de starea discurilor (care poate
# să nu fie vizibilă atunci când se execută preseed/early_command).
#d-i partman/early_command \
#       string debconf-set partman-auto/disk "$(list-devices disk | head -n1)"
# Această comandă este rulată chiar înainte de finalizarea instalării, dar când
# încă mai există un director /target utilizabil. Puteți să faceți chroot la
# /target și s-o utilizați direct, sau să utilizați comenzile «apt-install» și
# «in-target» pentru a instala cu ușurință pachete și a rula comenzi în sistemul
# țintă.
#d-i preseed/late_command string apt-install zsh; in-target chsh -s /bin/zsh
</pre></div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-seenflag"></a>B.5.2. Utilizarea preconfigurării pentru a modifica valorile implicite</h3></div></div></div>
<p>Este posibil să se utilizeze preconfigurarea pentru a schimba răspunsul implicit la o întrebare, dar întrebarea să fie totuși adresată. Pentru a face acest lucru, fanionul <em class="firstterm">seen</em> trebuie restabilit la <span class="quote">„<span class="quote">false</span>”</span> după stabilirea valorii unei întrebări. </p>
<div class="informalexample"><pre class="screen">
d-i foo/bar string value
d-i foo/bar seen false
</pre></div>
<p> Același efect poate fi obținut pentru <span class="emphasis"><em>toate</em></span> întrebările prin pasarea parametrului <code class="classname">preseed/interactive=true</code> la promptul de pornire. Acest lucru poate fi util și pentru testarea sau depanarea fișierului de preconfigurare. </p>
<p>Rețineți că proprietarul <span class="quote">„<span class="quote">d-i</span>”</span> ar trebui folosit numai pentru variabilele utilizate în programul de instalare însuși. Pentru variabilele care aparțin pachetelor instalate pe sistemul țintă, ar trebui să utilizați în schimb numele pachetului respectiv. Consultați nota de subsol la <a class="xref" href="apbs02.html#preseed-bootparms" title="B.2.2. Utilizarea parametrilor de pornire pentru a preconfigura întrebări">Secțiune B.2.2, „Utilizarea parametrilor de pornire pentru a preconfigura întrebări”</a>. </p>
<p>Dacă preconfigurați folosind parametrii de pornire, puteți determina instalatorul să pună întrebarea corespunzătoare utilizând operatorul <span class="quote">„<span class="quote">?=</span>”</span>, adică <strong class="userinput"><code><em class="replaceable"><code>foo</code></em>/<em class="replaceable"><code>bar</code></em>?=<em class="replaceable"><code>valoare</code></em></code></strong> (sau <strong class="userinput"><code><em class="replaceable"><code>proprietar</code></em>:<em class="replaceable"><code>foo/bar</code></em>?=<em class="replaceable"><code>valoare</code></em> </code></strong>). Desigur, acest lucru va avea efect numai pentru parametrii care corespund întrebărilor care sunt de fapt afișate în timpul unei instalări și nu pentru parametrii <span class="quote">„<span class="quote">interni</span>”</span>. </p>
<p>Pentru mai multe informații de depanare, utilizați parametrul de pornire <code class="classname">DEBCONF_DEBUG=5</code>. Acest lucru va face ca <code class="classname">debconf</code> să imprime mult mai multe detalii despre valorile curente ale fiecărei variabile și despre progresul acestuia prin scripturile de instalare ale fiecărui pachet. </p>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-chainload"></a>B.5.3. Încărcarea în lanț a fișierelor de preconfigurare</h3></div></div></div>
<p>Este posibil să includeți și alte fișiere de preconfigurare într-un fișier de preconfigurare. Orice configurări din acele fișiere vor înlocui configurările preexistente din fișierele încărcate anterior. Acest lucru face posibilă plasarea, de exemplu, de configurări generale de rețea pentru locația dvs. într-un fișier și configurări mai specifice pentru anumite configurații în alte fișiere. </p>
<div class="informalexample"><pre class="screen"># Pot fi listate mai multe fișiere, separate prin spații; toate vor fi
# încărcate. Fișierele incluse pot avea, de asemenea, directive de
# preconfigurare/includere proprii. Rețineți că, dacă numele fișierelor
# sunt relative, acestea sunt preluate din același director ca și fișierul
# de preconfigurare care le include.
#d-i preseed/include string x.cfg

# Programul de instalare poate verifica opțional sumele de control ale
# fișierelor de preconfigurare înainte de a le utiliza. În prezent, sunt
# acceptate doar sumele MD5; listați sumele MD5 în aceeași ordine ca și
# lista de fișiere care trebuie incluse.
#d-i preseed/include/checksum string 5da499872becccfeda2c4872f9171c3d

# Mai flexibilă, aceasta rulează o comandă shell și, dacă aceasta indică numele
# fișierelor de preconfigurare, include aceste fișiere. 
#d-i preseed/include_command \
#      string if [ "`hostname`" = bob ]; then echo bob.cfg; fi

# Cea mai flexibilă dintre toate, aceasta descarcă un program și îl rulează.
# Programul poate folosi comenzi precum debconf-set pentru a manipula baza
# de date debconf.
# Pot fi listate mai multe scripturi, separate prin spații.
# Rețineți că, dacă numele fișierelor sunt relative, acestea sunt preluate
# din același director ca și fișierul de preconfigurare care le rulează.
#d-i preseed/run string foo.sh
</pre></div>
<p>De asemenea, este posibilă încărcarea în lanț de la faza de preconfigurare de tip „initrd” sau „file”, în faza de preconfigurare de tip „network” prin configurarea „preseed/url” în fișierele anterioare. Acest lucru va face ca preconfigurarea din rețea (de tip „network”) să fie efectuată atunci când rețeaua se activează. Fiți atenți, deoarece vor exista două execuții separate ale preconfigurării. Aceasta înseamnă că puteți rula din nou comanda „preseed/early”, a doua oară după ce rețeaua se activează. </p>
</div>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="apbs04.html"><img src="images/prev.png" alt="Înapoi"></a> </td>
<td width="20%" align="center"><a accesskey="u" href="apb.html"><img src="images/up.png" alt="Sus"></a></td>
<td width="40%" align="right"> <a accesskey="n" href="apc.html"><img src="images/next.png" alt="Înainte"></a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">B.4. Conținutul fișierului de preconfigurare (pentru trixie) </td>
<td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/home.png" alt="Acasă"></a></td>
<td width="40%" align="right" valign="top"> Anexa C. Partiționarea pentru Debian</td>
</tr>
</table>
</div>
</body>
</html>
