Руководство по установке Debian GNU/Linux

Авторские права © 2004 - 2025 Команда разработчиков программы установки Debian

Это руководство является свободным программным обеспечением; вы можете его
распространять и/или модифицировать на условиях Стандартной Общественной
Лицензии GNU. С текстом соглашения можно ознакомиться здесь: Приложение F, GNU
General Public License.

Build version of this manual: 20250803+deb13u1.

Аннотация

Данный документ содержит инструкции по установке системы Debian GNU/Linux 13 («
trixie») для архитектуры 64-bit PC («amd64»). Кроме того, в нём указаны
источники более подробной информации и описаны методы наиболее эффективного
применения системы Debian.

Предупреждение

This translation of the installation guide is not up-to-date and currently
there is noone actively working on updating it. Keep this in mind when reading
it; it may contain outdated or wrong information. Read or double-check the
English variant, if in doubt. If you can help us with updating the translation,
please contact <debian-boot@lists.debian.org> or the debian-l10n-xxx
mailinglist for this language. Many thanks

Замечания, исправления можно отправлять в список рассылки
debian-l10n-russian@lists.debian.org.

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Содержание

Установка Debian GNU/Linux 13 на amd64
1. Добро пожаловать в Debian
    1.1. Что такое Debian?
    1.2. Что такое GNU/Linux?
    1.3. Что такое Debian GNU/Linux?
    1.4. Что такое программа установки Debian?
    1.5. Получение Debian
    1.6. Получение последней версии этого документа
    1.7. Структура этого документа
    1.8. Об авторских правах и лицензиях на программы
2. Системные требования
    2.1. Поддерживаемое оборудование
        2.1.1. Поддерживаемые архитектуры
        2.1.2. Поддержка ЦП
        2.1.3. Ноутбуки
        2.1.4. Несколько процессоров
        2.1.5. Поддержка видеокарт
        2.1.6. Аппаратура для подключения к сети
        2.1.7. Дисплеи Брайля
        2.1.8. Устройства речевого синтеза
        2.1.9. Периферия и другое оборудование
    2.2. Устройства, которым требуются микропрограммы
    2.3. Покупка аппаратного обеспечения специально для GNU/Linux
        2.3.1. Избегайте собственнического или закрытого аппаратного
        обеспечения
    2.4. Установочные носители
        2.4.1. CD-ROM/DVD-ROM/BD-ROM
        2.4.2. Карта памяти USB
        2.4.3. Сеть
        2.4.4. Жёсткий диск
        2.4.5. Система Un*x или GNU
        2.4.6. Поддерживаемые системы хранения
    2.5. Требования к памяти и дисковому пространству
3. Перед установкой Debian GNU/Linux
    3.1. Обзор процесса установки
    3.2. Сохраните ваши данные в надёжном месте!
    3.3. Информация, которая понадобится
        3.3.1. Документация
        3.3.2. Поиск источников технической информации
        3.3.3. Совместимость аппаратного обеспечения
        3.3.4. Настройки сети
    3.4. Минимальные требования к аппаратному обеспечению
    3.5. Переразметка для мульти-загрузочных систем
    3.6. Настройка аппаратного обеспечения и операционной системы перед
    установкой
        3.6.1. Invoking the BIOS/UEFI Set-Up Menu
        3.6.2. Выбор загрузочного устройства
        3.6.3. Устройства с микропрограммой UEFI
        3.6.4. Secure boot
        3.6.5. Disabling the Windows «fast boot»/«fast startup» feature
        3.6.6. Аппаратные проблемы, которых нужно остерегаться
4. Получение носителя с дистрибутивом
    4.1. Official Debian GNU/Linux installation images
    4.2. Скачивание файлов с серверов-зеркал Debian
        4.2.1. Where to Find Installation Files
    4.3. Подготовка файлов для загрузки с карты памяти USB
        4.3.1. Preparing a USB stick using a hybrid CD/DVD image
    4.4. Подготовка файлов для загрузки с жёсткого диска
        4.4.1. Hard disk installer booting from Linux using GRUB
    4.5. Подготовка файлов для загрузки по TFTP
        4.5.1. Настройка DHCP сервера
        4.5.2. Настройка BOOTP сервера
        4.5.3. Включение TFTP сервера
        4.5.4. Копирование TFTP образов в каталог TFTP сервера
    4.6. Автоматическая установка
        4.6.1. Автоматическая установка с помощью программы установки Debian
    4.7. Verifying the integrity of installation files
5. Загрузка системы установки
    5.1. Запуск программы установки на 64-bit PC
        5.1.1. Загрузка с карты памяти USB
        5.1.2. Booting from optical disc (CD/DVD)
        5.1.3. Booting from Linux using GRUB
        5.1.4. Загрузка по TFTP
        5.1.5. Экран запуска
        5.1.6. Программа установки с графическим интерфейсом
    5.2. Лёгкость управления
        5.2.1. Пользовательский интерфейс программы установки
        5.2.2. USB-дисплеи Брайля
        5.2.3. Дисплеи Брайля, подключаемые к последовательному порту
        5.2.4. ПО речевого синтеза
        5.2.5. Устройства речевого синтеза
        5.2.6. Встраиваемые устройства
        5.2.7. Тема с высокой контрастностью
        5.2.8. Увеличение
        5.2.9. Экспертная установка, режим восстановления и автоматизированная
        установка
        5.2.10. Специальные возможности установленной системы
    5.3. Параметры загрузки
        5.3.1. Boot serial console
        5.3.2. Параметры программы установки Debian
        5.3.3. Использование параметров загрузки для ответов на вопросы
        5.3.4. Передача параметров модулям ядра
        5.3.5. Внесение модулей ядра в чёрный список
    5.4. Диагностика проблем процесса установки
        5.4.1. Reliability of optical media
        5.4.2. Настройка загрузки
        5.4.3. ПО речевого синтеза
        5.4.4. Распространённые проблемы установки на 64-bit PC
        5.4.5. Интерпретация загрузочных сообщений ядра
        5.4.6. Сообщение о проблемах при установке
        5.4.7. Отправка отчётов об ошибках установки
6. Использование программы установки Debian
    6.1. Как работает программа установки
        6.1.1. Использование программы установки с графическим интерфейсом
    6.2. Описание компонент
    6.3. Применение отдельных компонент
        6.3.1. Настройка программы установки Debian и оборудования
        6.3.2. Добавление пользователей и паролей
        6.3.3. Настройка времени и часового пояса
        6.3.4. Разметка разделов и выбор точек монтирования
        6.3.5. Установка базовой системы
        6.3.6. Установка дополнительного программного обеспечения
        6.3.7. Установка и настройка системного загрузчика
        6.3.8. Завершение установки
        6.3.9. Устранение проблем
        6.3.10. Installation over network-console
    6.4. Загрузка отсутствующих микропрограмм
        6.4.1. Подготовка носителя
        6.4.2. Микропрограмма в установленной системе
        6.4.3. Completing the Installed System
    6.5. Customization
        6.5.1. Installing an alternative init system
7. Загрузка только что установленной системы Debian
    7.1. Момент истины
    7.2. Монтирование шифрованных томов
        7.2.1. Устранение неполадок
    7.3. Вход в систему
8. Следующие шаги и что делать дальше
    8.1. Выключение системы
    8.2. Самостоятельное ориентирование в Debian
        8.2.1. Система управления пакетами Debian
        8.2.2. Дополнительное программное обеспечение для Debian
        8.2.3. Управление версиями приложений
        8.2.4. Управление заданиями cron
    8.3. Что почитать
    8.4. Настройка почты
        8.4.1. Почтовая конфигурация по умолчанию
        8.4.2. Отправка почты из системы
        8.4.3. Настройка агента пересылки почты Exim4
    8.5. Сборка нового ядра
    8.6. Восстановление неработающей системы
A. Краткая инструкция по установке
    A.1. Предварительные сведения
    A.2. Загрузка программы установки
        A.2.1. Optical disc
        A.2.2. Загрузка с карты памяти USB
        A.2.3. Загрузка по сети
        A.2.4. Загрузка с жёсткого диска
    A.3. Установка
    A.4. Отправьте нам отчёт об установке
    A.5. И напоследок...
B. Автоматическая установка с помощью списка ответов
    B.1. Введение
        B.1.1. Методы использования файла ответов
        B.1.2. Ограничения
    B.2. Использование автоматической установки
        B.2.1. Загрузка файла ответов
        B.2.2. Использование параметров загрузки для автоматизации
        B.2.3. Автоматический режим
        B.2.4. Полезные в автоматизации псевдонимы
        B.2.5. Examples of boot prompt preseeding
        B.2.6. Использование сервера DHCP для указания файлов автоматической
        конфигурации
    B.3. Создание файла ответов
    B.4. Содержимое файла ответов (для trixie)
        B.4.1. Локализация
        B.4.2. Speech synthesis
        B.4.3. Настройка сети
        B.4.4. Сетевая консоль
        B.4.5. Настройка сервера-зеркала
        B.4.6. Настройка учётной записи
        B.4.7. Настройка времени и часового пояса
        B.4.8. Разметка дисков
        B.4.9. Установка базовой системы
        B.4.10. Настройка Apt
        B.4.11. Выбор пакетов
        B.4.12. Установка загрузчика
        B.4.13. Завершение установки
        B.4.14. Автоматизация других пакетов
    B.5. Дополнительные параметры
        B.5.1. Запуск пользовательских команд во время установки
        B.5.2. Использование автоматической установки для изменения значений по
        умолчанию
        B.5.3. Последовательная загрузка нескольких файлов ответов
C. Разметка дисков в Debian
    C.1. Дисковые разделы Debian и их размеры
    C.2. Структура каталогов
    C.3. Рекомендуемые схемы разметки
    C.4. Имена устройств в Linux
    C.5. Программы разметки в Debian
        C.5.1. Разметка для 64-bit PC
D. Разное
    D.1. Устройства Linux
        D.1.1. Установка мыши
    D.2. Дисковое пространство, необходимое для задач
    D.3. Установка Debian GNU/Linux из системы Unix/Linux
        D.3.1. Начинаем
        D.3.2. Установка debootstrap
        D.3.3. Запуск debootstrap
        D.3.4. Настройка базовой системы
        D.3.5. Установка ядра
        D.3.6. Установка системного загрузчика
        D.3.7. Удалённый доступ: установка SSH и настройка доступа
        D.3.8. Заключительные шаги
    D.4. Установка Debian GNU/Linux через Parallel Line IP (PLIP)
        D.4.1. Требования
        D.4.2. Настройка источника
        D.4.3. Установка приёмника
    D.5. Установка Debian GNU/Linux с использованием PPP через Ethernet (PPPoE)
E. Общие сведения
    E.1. Об этом документе
    E.2. Как помочь в разработке этого документа
    E.3. Люди, внёсшие значительный вклад в написание этого руководства
    E.4. Торговые марки
F. GNU General Public License

Список таблиц

3.1. Информация об оборудовании, полезная при установке
3.2. Рекомендуемые минимальные требования к системе

Установка Debian GNU/Linux 13 на amd64

Мы рады, что вы решили попробовать Debian. Мы уверены, что дистрибутив Debian
GNU/Linux покажется вам замечательным. Debian GNU/Linux собирает
высококачественное свободное ПО со всего света, объединяя его в единое целое.
Мы верим, вы признаете, что получившийся результат -- это действительно больше,
чем сумма частей.

Мы понимаем, что многие из вас хотят установить Debian, не читая этого
руководства, и поэтому программа установки Debian была спроектирована с учётом
этого. Если прямо сейчас у вас нет времени на чтение всего руководства,
прочтите "Краткое руководство по установке", которое покажет вам основы
процесса установки, а также укажет на конкретные главы руководства для
углублённого изучения конкретных тем или на случай непредвиденных проблем.
Приложение A, Краткая инструкция по установке содержит это краткое руководство.

Тем не менее, мы надеемся, что у вас найдётся время на чтение большей части
этого руководства, так как прочитав его, вы сможете более умело и успешно
установить систему.

Глава 1. Добро пожаловать в Debian

Содержание

1.1. Что такое Debian?
1.2. Что такое GNU/Linux?
1.3. Что такое Debian GNU/Linux?
1.4. Что такое программа установки Debian?
1.5. Получение Debian
1.6. Получение последней версии этого документа
1.7. Структура этого документа
1.8. Об авторских правах и лицензиях на программы

Эта глава посвящена обзору проекта Debian и Debian GNU/Linux. Если вы уже
знаете историю проекта Debian и дистрибутива Debian GNU/Linux, спокойно
переходите к следующей главе.

1.1. Что такое Debian?

Debian -- это организация, полностью состоящая из добровольцев, посвятившая
себя разработке свободного программного обеспечения и распространению идеалов
сообщества Свободного Программного Обеспечения (Free Software). Проект Debian
начался в 1993 году, когда Иэн Мёрдок (Ian Murdock) выпустил открытое
приглашение к разработчикам программ внести свой вклад в полноценный
программный дистрибутив, основанный на относительно новом ядре Linux. Небольшая
группа энтузиастов, на которых повлияла философия GNU, изначально
поддерживаемая Фондом Свободного Программного Обеспечения, с годами выросла в
организацию, с количеством разработчиков Debian 1000.

Разработчики Debian выполняют различные задачи, включая администрирование Web и
FTP сайтов, графический дизайн, юридический анализ программных лицензий,
написание документации и, конечно же, сопровождение пакетов.

В интересах распространения нашей философии и привлечения разработчиков,
которые верят в принципы Debian, проект Debian выпустил множество документов,
которые подчёркивают наши ценности и рассказывают, что значит быть
разработчиком Debian:

  • Общественный Договор Debian -- это утверждение обязательств Debian перед
    Сообществом Свободного Программного Обеспечения. Любой, кто соглашается
    следовать Общественному Договору Debian может стать сопровождающим. Любой
    сопровождающий может добавить новые программы в Debian -- при условии, что
    программы соответствуют нашим критериям свободы, а пакеты следуют нашим
    стандартам качества.

  • Критерии Debian по определению Свободного Программного Обеспечения (DFSG)
    -- это краткие и ясные определения критериев Debian к свободным программам.
    DFSG является очень влиятельным документом в Движении Свободного
    Программного Обеспечения и взят за основу Определения Открытых Исходных
    Текстов.

  • Руководство по политике Debian -- это обширная спецификация стандартов
    качества проекта Debian.

Разработчики Debian также вовлечены и в другие проекты, некоторые из которых
созданы специально для Debian, другие выполняются для части или для всего
сообщества Linux. Вот несколько примеров:

  • Стандарт Иерархии Файловой Системы (FHS) -- это попытка стандартизировать
    организацию файловой системы Linux. Стандарт FHS позволит разработчикам
    программ сконцентрировать свои усилия на создании программы и не
    беспокоиться о том, как пакет будет устанавливаться в различные
    дистрибутивы GNU/Linux.

  • Внутренний проект Debian для детей, его цель -- уверенность в том, что
    Debian'у есть что предложить нашим младшим пользователям.

Для более общей информации о Debian, смотрите Debian FAQ.

1.2. Что такое GNU/Linux?

GNU/Linux -- это операционная система: набор программ, которые позволяют вам
работать с вашим компьютером и запускать другие программы.

Операционная система (ОС) состоит из нескольких основных программ, которые
нужны вашему компьютеру, чтобы он мог общаться и получать инструкции от
пользователей; читать и записывать данные на жёсткие диски, ленты и принтеры;
контролировать использование памяти; запускать другие программы. Самая важная
часть ОС -- ядро. В системе GNU/Linux ядром является Linux. Оставшаяся часть
системы состоит из других программ, многие из которых написаны проектом GNU или
для проекта GNU. Поскольку одно ядро Linux -- это ещё не вся работающая ОС, мы
предпочитаем использовать термин «GNU/Linux» для обозначения систем, которые
многие люди ошибочно называют «Linux».

GNU/Linux сделана по образцу операционной системы Unix. С самого начала GNU/
Linux разрабатывалась как многозадачная, многопользовательская система. Этих
факторов достаточно, чтобы сделать GNU/Linux отличной от других широко
известных операционных систем. Однако, GNU/Linux отличается намного сильнее,
чем вы можете себе представить. В отличие от других операционных систем, GNU/
Linux никому не принадлежит. Значительная часть системы разработана
добровольцами бесплатно.

Разработка того, что позже станет GNU/Linux, началась в 1984 году, когда Фонд
Свободного Программного обеспечения начал разработку свободной Unix-подобной
операционной системы, названной GNU.

Проект GNU разработал всеобъемлющий набор свободного программного обеспечения
для использования в Unix (tm) и Unix-подобных операционных системах, таких как
GNU/Linux. Эти программы позволяют пользователям выполнять задачи широкого
спектра, от простых (копирование или удаление файлов из системы) до сложных
(написание и компилирование программ или выполнение сложного редактирования в
различных форматах документов).

Хотя многие рабочие группы и отдельные люди вложили свой труд в создание GNU/
Linux, наибольшим пока ещё остаётся вклад Фонда Свободного Программного
Обеспечения. Помимо разработки большинства используемых инструментов, фонд
также создал философию и организовал сообщество (независимых программистов и
энтузиастов-пользователей). Благодаря этому, в свою очередь, стало возможным
появление отлаженных GNU/Linux систем.

Ядро Linux впервые появилось в 1991 году, когда финский студент-компьютерщик по
имени Линус Торвальдс (Linus Torvalds) анонсировал первую версию замены ядра
Minix в группе новостей comp.os.minix. Подробнее смотрите на сайте Linux
Internationals страничку истории Linux.

Линус Торвальдс продолжает координировать работу нескольких сотен разработчиков
с помощью нескольких сопровождающих подсистем. Есть официальный сайт для ядра
Linux. Информацию о списке рассылки linux-kernel можно найти в FAQ списка
рассылки linux-kernel.

GNU/Linux users have immense freedom of choice in their software. For example,
they can choose from a dozen different command line shells and several
graphical desktops. This selection is often bewildering to users of other
operating systems, who are not used to thinking of the command line or desktop
as something that they can change.

GNU/Linux также менее подвержен сбоям, лучше приспособлен для одновременного
выполнения более чем одной программы и более защищён, чем многие другие
системы. Благодаря этим преимуществам, Linux быстро завоёвывает рынок серверных
операционных систем. С недавних пор, Linux начал становиться популярным среди
домашних пользователей и в корпоративной среде.

1.3. Что такое Debian GNU/Linux?

Комбинация философии и методологии Debian, средств GNU, ядра Linux и других
важных программ, составляют уникальный дистрибутив под названием Debian GNU/
Linux. Этот дистрибутив собран из большого количества пакетов программ. Каждый
пакет в дистрибутиве содержит исполняемые файлы, сценарии, документацию,
конфигурационную информацию и имеет сопровождающего, который отвечает за
поддержание пакета в актуальном состоянии, отслеживает сообщения об ошибках
(bug reports) и общается с основными авторами программы. Огромная база наших
пользователей в сочетании с нашей системой отслеживания сообщений об ошибках
гарантируют, что проблемы будут быстро обнаружены и устранены.

Внимание Debian к деталям позволило создать высококачественный, стабильный и
расширяемый дистрибутив. Установленные системы могут быть легко настроены на
выполнение самых различных задач: от упрощённого межсетевого экрана (firewall),
рабочей станции учёного, до высокопроизводительного сетевого сервера.

Debian особенно популярен среди опытных пользователей из-за его технического
совершенства и глубокого понимания нужд и ожиданий сообщества Linux. Debian
также добавил много новых свойств в Linux, которые теперь повсеместно
используются.

Например, Debian был первым дистрибутивом Linux, который имел систему
управления пакетами для более лёгкой установки и удаления программ. Также он
был первым дистрибутивом Linux, который можно обновить до последней версии без
переустановки.

Debian продолжает быть лидером в разработке Linux. Его процесс разработки
является примером того, как хорошо может работать модель Открытых Исходников
(Open Source) даже для очень сложных задач, таких как построение и
сопровождение целой операционной системы.

Наиболее отличительной особенностью Debian от других дистрибутивов Linux
является его система управления пакетами. Она даёт администратору системы
Debian полный контроль над пакетами, установленными в системе, будь это
установка одного пакета или автоматическое обновление всей операционной
системы. Также, отдельные пакеты могут быть защищены от обновления. Вы даже
можете указать системе управления пакетами программы, которые вы собрали сами и
о том, от каких программ они зависят.

Для защиты вашей системы от «троянских коней» и других вредоносных программ, на
серверах Debian выполняется проверка того, что поступающие пакеты получены
только от зарегистрированных сопровождающих Debian. Также разработчики Debian
заботятся о настройке безопасности программ в своих пакетах. Когда случаются
проблемы с безопасностью в выпущенном пакете, обычно очень быстро выходят
исправления. С помощью простой системы обновлений Debian исправления
безопасности можно загружать и устанавливать автоматически через Интернет.

Основным и самым лучшим способом получения поддержки системы Debian GNU/Linux и
общения с разработчиками Debian является множество списков рассылки проекта
Debian (на момент написания этих строк их было более 334). Самый простой способ
подписаться на один из этих списков -- посетить страницу подписки на списки
рассылки Debian и заполнить форму.

1.4. Что такое программа установки Debian?

Программа установки Debian, также называемая «d-i», -- это программная система,
устанавливающая работающую основу системы Debian. Она поддерживает широкий круг
аппаратного обеспечения, такого как встраиваемые устройства, ноутбуки, ПК и
серверы, а также предлагает большой набор свободного ПО для разных нужд.

Установка проводится исходя из ответов на простые вопросы. Также доступен
экспертный режим, позволяющий изменять каждое свойство установки, и имеется
дополнительная возможность выполнения автоматизированных установок.
Установленная система может использоваться сразу или может донастраиваться.
Установка может производиться из разных источников: USB, CD/DVD/Blu-Ray или из
сети. Интерфейс программы установки переведён на 80 языков.

Программа установки выросла из проекта boot-floppies и впервые упомянута Джоуи
Хессом в 2000 году. С этих пор система установки непрерывно разрабатывается
добровольцами, которые делают её лучше и добавляют новые возможности.

Дополнительную информацию можно найти на странице программы установки Debian,
вики и списке рассылки debian-boot.

1.5. Получение Debian

For information on how to download Debian GNU/Linux from the Internet or from
whom official Debian installation media can be purchased, see the distribution
web page. The list of Debian mirrors contains a full set of official Debian
mirrors, so you can easily find the nearest one.

После установки Debian может быть легко обновлён. Процедура установки поможет
настроить систему так, чтобы вы смогли сделать это обновление после завершения
установки, если нужно.

1.6. Получение последней версии этого документа

Этот документ постоянно обновляется. На странице Debian 13 вы найдёте самую
свежую информацию о последних изменениях в выпуске 13 системы Debian GNU/Linux.
Обновлённые версии этого руководства по установке также доступны на официальных
страницах руководства по установке.

1.7. Структура этого документа

Этот документ может служить руководством для начинающих пользователей Debian. В
нём делается несколько предположений о вашем уровне знаний. Однако, мы
надеемся, что вы в целом понимаете, как работает аппаратная часть (hardware)
вашего компьютера.

Опытные пользователи в этом документе смогут найти ссылки на интересную
справочную информацию, например, минимальные размеры установки, детали о
поддержке аппаратных средств системой установки Debian и так далее. Мы
призываем опытных пользователей хотя бы пробежаться глазами по документу.

Это руководство построено последовательно, оно проведёт вас через процесс
установки от начала и до конца. Вот шаги установки Debian GNU/Linux и
соответствующие им разделы документа:

 1. Определите, соответствует ли ваше аппаратное обеспечение требованиям
    системы установки (Глава 2, Системные требования).

 2. Сделайте резервную копию вашей системы, выполните необходимое планирование
    и настройку аппаратного обеспечения перед установкой Debian (Глава 3, Перед
    установкой Debian GNU/Linux). Если вы подготавливаете мульти-загрузочную
    систему, то вам, возможно, понадобится выделить место на жёстком диске под
    раздел Debian.

 3. Выбрав способ установки, получите необходимые файлы (Глава 4, Получение
    носителя с дистрибутивом).

 4. Глава 5, Загрузка системы установки описывает загрузку системы установки. В
    этом разделе также обсуждается процедура поиска неисправностей при
    возникновении проблем.

 5. Perform the actual installation according to Глава 6, Использование
    программы установки Debian. This involves choosing your language,
    configuring peripheral driver modules, configuring your network connection,
    so that remaining installation files can be obtained directly from a Debian
    server (if you are not installing from a set of DVD installation images),
    partitioning your hard drives and installation of a base system, then
    selection and installation of tasks. (Some background about setting up the
    partitions for your Debian system is explained in Приложение C, Разметка
    дисков в Debian.)

 6. Загрузите вашу только что установленную базовую систему (Глава 7, Загрузка
    только что установленной системы Debian).

Глава 8, Следующие шаги и что делать дальше предназначена для чтения после
установки системы. В ней рассказывается о том, где найти дополнительную
информации о Unix и Debian, и как заменить ядро.

И наконец, для информации об этом документе и о том как помочь его развитию,
смотрите Приложение E, Общие сведения.

1.8. Об авторских правах и лицензиях на программы

Мы уверены, что вы читали некоторые лицензии, на условиях которых
распространяется большинство коммерческих программ -- обычно в них говорится,
что вы можете использовать только одну копию программы на одном компьютере.
Лицензия этой системы совсем не такая. Мы предлагаем вам установить копию
Debian GNU/Linux на каждый компьютер в вашей школе или на работе. Дайте ваши
установочные носители друзьям и помогите им поставить систему на их компьютеры!
Вы даже можете сделать тысячи копий и продавать их -- хотя и с некоторыми
ограничениями. Ваша свобода ставить и использовать систему происходит
непосредственно из того, что Debian основан на свободном программном
обеспечении.

Calling software free doesn't mean that the software isn't copyrighted, and it
doesn't mean that installation media containing that software must be
distributed at no charge. Free software, in part, means that the licenses of
individual programs do not require you to pay for the privilege of distributing
or using those programs. Free software also means that not only may anyone
extend, adapt, and modify the software, but that they may distribute the
results of their work as well.

Примечание

Заметьте, что проект Debian, уступая требованиям пользователей, добавил
некоторые пакеты, хотя они и не отвечают нашим критериям свободы. Однако, эти
пакеты не являются частью официального дистрибутива, и доступны только из
областей contrib или non-free серверов-зеркал Debian или на неофициальных CD/
DVD-ROM; более подробную информацию о расположении и содержании архивов
смотрите в разделе «FTP-архивы Debian» в Debian FAQ.

Большинство программ в системе выпущено под Стандартной Общественной Лицензией 
GNU, часто называемой просто «GPL». Лицензия GPL требует от вас сделать 
исходный код программ доступным, если вы распространяете двоичную копию
программы; это условие лицензии даёт гарантию того, что любой пользователь
сможет изменять программу. Согласно этому положению, в системе Debian доступен
исходный код^[1] всех таких программ.

Программы в Debian доступны по нескольким соглашениям об авторских правах и
программных лицензий. Сразу после установки в систему, лицензия на пакет
сохраняется в файле /usr/share/doc/имя-пакета/copyright .

Более полную информацию о лицензиях и о том, как Debian определяет, является ли
программа достаточно свободной, чтобы быть включённой в основную (main) часть
дистрибутива, смотрите в критериях Debian для свободного программного
обеспечения.

Самое важное юридическое замечание -- программное обеспечение поставляется без
гарантий. Программисты, создавшие программу, сделали это на пользу обществу. Не
даётся никаких гарантий о пригодности поставляемого программного обеспечения
для каких-то определённых целей. Однако, поскольку программное обеспечение
свободно, вы вольны модифицировать программу для достижения необходимых вам
целей -- и наслаждаться выгодами изменений, сделанных другими людьми, которые
расширили возможности программы тем же путём.


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[1] Информацию о том как найти, распаковать и собрать двоичные программы из
исходных кодов Debian, смотрите в Debian FAQ, в разделе «Основы системы
управления пакетами Debian».

Глава 2. Системные требования

Содержание

2.1. Поддерживаемое оборудование
    2.1.1. Поддерживаемые архитектуры
    2.1.2. Поддержка ЦП
    2.1.3. Ноутбуки
    2.1.4. Несколько процессоров
    2.1.5. Поддержка видеокарт
    2.1.6. Аппаратура для подключения к сети
    2.1.7. Дисплеи Брайля
    2.1.8. Устройства речевого синтеза
    2.1.9. Периферия и другое оборудование
2.2. Устройства, которым требуются микропрограммы
2.3. Покупка аппаратного обеспечения специально для GNU/Linux
    2.3.1. Избегайте собственнического или закрытого аппаратного обеспечения
2.4. Установочные носители
    2.4.1. CD-ROM/DVD-ROM/BD-ROM
    2.4.2. Карта памяти USB
    2.4.3. Сеть
    2.4.4. Жёсткий диск
    2.4.5. Система Un*x или GNU
    2.4.6. Поддерживаемые системы хранения
2.5. Требования к памяти и дисковому пространству

Этот раздел содержит информацию о том, какое оборудование требуется для запуска
Debian. Также, вы найдете ссылки на информацию об оборудовании, поддерживаемом
GNU и Linux.

2.1. Поддерживаемое оборудование

Debian does not impose hardware requirements beyond the requirements of the
Linux kernel and the GNU tool-sets. Therefore, any architecture or platform to
which the Linux kernel, libc, gcc, etc. have been ported, and for which a
Debian port exists, can run Debian. Please refer to the Ports pages at https://
www.debian.org/ports/amd64/ for more details on 64-bit PC architecture systems
which have been tested with Debian GNU/Linux.

Вместо того, чтобы пытаться описать всё разнообразие аппаратных конфигураций,
которое существует на 64-bit PC, эта глава содержит общую информацию и
указания, где можно найти дополнительную информацию.

2.1.1. Поддерживаемые архитектуры

Debian GNU/Linux 13 supports 6 major architectures and several variations of
each architecture known as «flavors».

┌─────────────────────────┬──────────────────┬────────────────────────┬───────┐
│       Архитектура       │  Обозначение в   │     Субархитектура     │Вариант│
│                         │      Debian      │                        │       │
├─────────────────────────┼──────────────────┼────────────────────────┼───────┤
│AMD64 & Intel 64         │amd64             │                        │       │
├─────────────────────────┼──────────────────┼────────────────────────┼───────┤
│ARM с аппаратным FPU     │armhf             │multiplatform           │armmp  │
├─────────────────────────┼──────────────────┼────────────────────────┼───────┤
│64-битные ARM            │arm64             │                        │       │
├─────────────────────────┼──────────────────┼────────────────────────┼───────┤
│Power Systems            │ppc64el           │машины IBM POWER8 или   │       │
│                         │                  │новее                   │       │
├─────────────────────────┼──────────────────┼────────────────────────┼───────┤
│64bit RISC-V             │riscv64           │                        │       │
│(little-endian)          │                  │                        │       │
├─────────────────────────┼──────────────────┼────────────────────────┼───────┤
│64-битный IBM S/390      │s390x             │IPL с VM-reader и DASD  │generic│
└─────────────────────────┴──────────────────┴────────────────────────┴───────┘

Этот документ содержит описание установки на архитектуру 64-bit PC. Если вы
ищете информацию по любой другой архитектуре, поддерживаемой Debian, посмотрите
на странице переносов Debian.

2.1.2. Поддержка ЦП

Поддерживаются процессоры AMD64 и Intel 64.

2.1.3. Ноутбуки

С технической точки зрения ноутбуки -- это обычны ПК, поэтому вся информация о
ПК применима и к ноутбукам. Установка на ноутбуки сегодня это обычная установка
где всё начинает сразу работать, включая автоматическое засыпание системы при
закрытии крышки и специальные кнопки на корпусе ноутбука, например для
выключения интерфейса wifi («режим самолёта»). Тем не менее, иногда для
некоторых специальных возможностей ноутбуков производители используют
специализированное или проприетарное оборудование, которое может не
поддерживаться. На странице Linux на ноутбуках можно посмотреть, будет ли
работать GNU/Linux на вашем ноутбуке.

2.1.4. Несколько процессоров

На этой архитектуре поддерживается нескольких процессоров -- так называемая «
симметричная многопроцессорная обработка (symmetric multi-processing)» или SMP.
Стандартное ядро Debian 13 собрано с поддержкой SMP-alternatives. Это означает,
что ядро определит число процессоров (или процессорных ядер) и автоматически
выключит SMP в однопроцессорных системах.

Раньше, несколько процессоров имелось только в высокопроизводительных серверных
системах, но в настоящее время так называемые «многоядерные»процессоры
встраивают почти по всё. В них содержится один ЦП с двумя и более
вычислительными блоками, называемыми «ядрами».

2.1.5. Поддержка видеокарт

Debian's support for graphical interfaces is determined by the underlying
support found in X.Org's X11 system, and the kernel. Basic framebuffer graphics
is provided by the kernel, whilst desktop environments use X11. Whether
advanced graphics card features such as 3D-hardware acceleration or
hardware-accelerated video are available, depends on the actual graphics
hardware used in the system and in some cases on the installation of additional
«firmware» blobs (see Раздел 2.2, «Устройства, которым требуются
микропрограммы»).

On modern PCs, having a graphical display usually works out of the box. For
quite a lot of hardware, 3D acceleration also works well out of the box, but
there is still some hardware that needs binary firmware blobs to work well. In
some cases there have been reports about hardware on which installation of
additional graphics card firmware was required even for basic graphics support.

Список поддерживаемых графического оборудовния и устройств ввода можно найти на
https://wiki.freedesktop.org/xorg/. Debian 13 поставляется с X.Org версии 7.7.

2.1.6. Аппаратура для подключения к сети

Почти любая сетевая плата (NIC), поддерживаемая ядром Linux, должна
поддерживаться системой установки; драйверы модулей должны загрузиться
автоматически. Это относится к почти всем картам PCI/PCI-Express и PCMCIA/
Express Cards на ноутбуках.

ISDN поддерживается, но не во время установки.

2.1.6.1. Карты для беспроводных сетей

Беспроводные сети, в основном, поддерживаются, как и растёт число
поддерживаемых беспроводных адаптеров в официальном ядре Linux, хотя для работы
многих из них требуется загрузка микропрограммы.

Если нужна микропрограмма, то программа установки предложит её загрузить. В
Раздел 6.4, «Загрузка отсутствующих микропрограмм» есть подробное описание о
том, как загрузить микропрограмму во время установки.

Беспроводные адаптеры, не поддерживаемые официальным ядром Linux, обычно, можно
заставить работать в Debian GNU/Linux, но это не поддерживается во время
установки.

If there is a problem with wireless and there is no other NIC you can use
during the installation, it is still possible to install Debian GNU/Linux using
a DVD image. Select the option to not configure a network and install using
only the packages available from the DVD. You can then install the driver and
firmware you need after the installation is completed (after the reboot) and
configure your network manually.

Иногда, нужный драйвер недоступен в виде пакета Debian. В этом случае вам
придётся поискать исходный код в интернете и собрать драйвер самостоятельно.
Это не описано в данном руководстве. Если драйвер под Linux недоступен, в
последнюю очередь можно использовать пакет ndiswrapper, который позволяет
использовать драйвер от Windows.

2.1.7. Дисплеи Брайля

Поддержка дисплеев Брайля обеспечивается программой brltty. С её помощью
работает большинство дисплеев, подключаемых к последовательному порту, USB или
bluetooth. Список поддерживаемых устройств можно найти на сайте brltty. В
Debian GNU/Linux 13 включена brltty версии 6.7.

2.1.8. Устройства речевого синтеза

Поддержка устройств речевого синтеза обеспечивается программой speakup. speakup
поддерживает только встраиваемые платы и внешние устройства, подключаемые к
последовательному порту (USB, PCI или serial-to-USB адаптеры не
поддерживаются). Список поддерживаемых устройств можно найти на сайте speakup.
В Debian GNU/Linux 13 включена speakup версии 3.1.6.

2.1.9. Периферия и другое оборудование

Linux поддерживает много разных устройств, таких как мыши, принтеры, сканеры,
PCMCIA/CardBus/ExpressCard и USB устройства. Однако, большинство этих устройств
не требуется для установки системы.

Устройства USB, в основном, работают нормально. На некоторых, очень старых ПК,
для некоторых USB-клавиатур может потребоваться дополнительная настройка
(смотрите Раздел 3.6.6, «Аппаратные проблемы, которых нужно остерегаться»). На
современных ПК, клавиатуры и мыши USB работают без специальных настроек.

2.2. Устройства, которым требуются микропрограммы

Besides the availability of a device driver, some hardware also requires
so-called firmware or microcode to be loaded into the device before it can
become operational. This is most common for network interface cards (especially
wireless NICs), but for example some USB devices and even some hard disk
controllers also require firmware.

With many graphics cards, basic functionality is available without additional
firmware, but the use of advanced features requires an appropriate firmware
file to be installed in the system.

Во многих старых устройствах, которым для работы требовалась микропрограмма,
данные файла микропрограммы постоянно хранились в EEPROM/чипе Flash на самом
устройстве. В настоящее время в новые устройства микропрограмма больше не
встраивается; её код загружается в устройство операционной системой при каждом
запуске.

In most cases firmware is non-free according to the criteria used by the Debian
GNU/Linux project and thus cannot be included in the main distribution. If the
device driver itself is included in the distribution and if Debian GNU/Linux
legally can distribute the firmware, it will often be available as a separate
package from the non-free-firmware section of the archive (prior to Debian GNU/
Linux 12.0: from the non-free section).

However, this does not mean that such hardware cannot be used during
installation. Starting with Debian GNU/Linux 12.0, following the 2022 General
Resolution about non-free firmware, official installation images can include
non-free firmware packages. By default, debian-installer will detect required
firmware (based on kernel logs and modalias information), and install the
relevant packages if they are found on an installation medium (e.g. on the
netinst). The package manager gets automatically configured with the matching
components so that those packages get security updates. This usually means that
the non-free-firmware component gets enabled, in addition to main.

Users who wish to disable firmware lookup entirely can do so by setting the
firmware=never boot parameter. It's an alias for the longer hw-detect/
firmware-lookup=never form.

Unless firmware lookup is disabled entirely, debian-installer still supports
loading firmware files or packages containing firmware from a removable medium,
such as a USB stick. See Раздел 6.4, «Загрузка отсутствующих микропрограмм» for
detailed information on how to load firmware files or packages during the
installation. Note that debian-installer is less likely to prompt for firmware
files now that non-free firmware packages can be included on installation
images.

Если debian-installer просит файл с микропрограммой, а у вас этого файла нет
или вы не хотите его устанавливать в систему из non-free, то вы можете
попробовать продолжить установку без загрузки микропрограммы. Иногда драйвер
просит дополнительную микропрограмму, так как она может ему понадобиться в
определённых ситуациях, но в большинстве систем устройство всё равно будет
работать без неё (например, это происходит с некоторыми сетевыми картами,
использующими драйвер tg3).

2.3. Покупка аппаратного обеспечения специально для GNU/Linux

Некоторые продавцы предлагают системы с уже установленным Debian или с другими
дистрибутивами GNU/Linux. Может быть, за это вам придётся заплатить чуть
больше, но это плата за душевный покой, так как в этом случае можно быть
уверенным в том, что данное аппаратное обеспечение хорошо поддерживается GNU/
Linux.

Если вы купили машину с установленным Windows, внимательно прочитайте лицензию,
которая поставляется с Windows; может быть, вы сможете не согласиться с
лицензией и получить скидку от продавца. Поиск в Интернет по ключевым словам «
windows refund» может дать полезную информацию об этом.

Покупаете ли вы машину с установленным Linux или нет, или даже подержанную
систему, всё равно, важно проверить, что аппаратное обеспечение поддерживается
ядром Linux. Убедитесь, что ваше аппаратное обеспечение находится в списках по
ссылке, приведённой выше. Скажите продавцу (если он есть), что вы покупаете
систему для Linux. Поддержите дружественных к Linux продавцов аппаратного
обеспечения.

2.3.1. Избегайте собственнического или закрытого аппаратного обеспечения

Некоторые производители аппаратного обеспечения просто не говорят нам как
писать драйверы для своего аппаратного обеспечения. Другие не дают нам доступ к
документации без соглашения о неразглашении, которое запрещает нам выпускать
исходный код, который является основой свободного ПО. Так как у нас нет доступа
рабочей документации на эти устройства, они просто не будут работать под Linux.

Во многих случаях есть стандарты (или, по крайней мере, некоторые стандарты
де-факто), описывающие как операционная система и её драйверы устройств
работают с определённым классом устройств. Все устройства, которые
соответствуют такому (де-факто)стандарту, можно использовать через единственный
универсальный драйвер устройства и никакие специальные драйверы для устройств
не требуются. Такие классы оборудования (например, USB «Human Interface Devices
», т.е. клавиатуры, мыши и т. д., и USB-устройства хранения, такие как флешки
USB и устройства чтения карт памяти) очень хорошо работают и практически каждое
устройство, продаваемое на рынке, соответствует стандартам.

В других категориях, среди них например, принтеры, это, к сожалению, не так. В
то время как есть много принтеров, с которыми можно работать через несколько
(де-факто) стандартных языков управления и поэтому их можно заставить работать
без проблем в любой операционной системе, есть довольно много моделей со своими
закрытыми командами управления, на которые нет документации. Такие принтеры
вообще не могут быть использованы в свободных операционных системах, или могут
использоваться только через закрытые драйверы без исходного кода,
предоставляемые производителями.

Даже если производитель предоставляет драйвер с закрытым исходным кодом для
оборудования при покупке устройства, срок эксплуатации устройства ограничен
доступностью драйвера. В настоящее время циклы поддержки продуктов стали
короткими, и весьма распространена ситуация, когда через короткий промежуток
времени после прекращения производства потребительского устройства, обновление
драйверов производитель также перестаёт выполнять. Если старый драйвер с
закрытым исходным кодом после обновления системы перестал работать, совершенно
рабочее устройство становится бесполезным хламом из-за отсутствия поддержки
драйвера, и в этом случае ничего нельзя сделать. Поэтому вы не должны покупать
закрытое оборудование, независимо от операционной системы, в которой будете его
использовать.

Вы можете помочь решить эту проблему, призвав производителей закрытого
оборудования выпускать документацию и другие ресурсы, необходимые для написания
свободных драйверов для их оборудования.

2.4. Установочные носители

Этот раздел поможет определить, какие типы носителей вы можете использовать для
установки Debian. Существует целая глава, целиком посвящённая выбору носителей
(Глава 4, Получение носителя с дистрибутивом), в которой перечислены
преимущества и недостатки каждого типа. Вы можете вернуться к этой странице,
когда прочитаете эту главу.

2.4.1. CD-ROM/DVD-ROM/BD-ROM

Installation from optical disc is supported for most architectures.

On PCs SATA, IDE/ATAPI, USB and SCSI optical drives are supported, as are
FireWire devices that are supported by the ohci1394 and sbp2 drivers.

2.4.2. Карта памяти USB

USB flash disks a.k.a. USB memory sticks have become a commonly used and cheap
storage device. Most modern computer systems also allow booting the
debian-installer from such a stick. Many modern computer systems, in particular
netbooks and thin laptops, do not have an optical drive anymore at all and
booting from USB media is the standard way of installing a new operating system
on them.

2.4.3. Сеть

Для получения требуемых для установки файлов может быть использована сеть.
Будет или нет задействована сеть зависит от выбранного метода и ваших ответов
на некоторые вопросы, которые будут заданы во время установки. Система
установки поддерживает большинство типов подключения к сети (включая PPPoE, но
не ISDN или PPP), и работает по HTTP или FTP. Настройку ISDN и PPP вы сможете
выполнить после завершения установки.

Также вы можете загрузить систему установки по сети, при этом не требуется
локальных носителей, таких как CD/DVD или флешки USB. Если у вас в сети уже
развёрнута инфраструктура netboot (т. е. запущены службы DHCP и TFTP), то с её
помощью можно легко и быстро развернуть установку на большое количество машин.
Создание необходимой инфраструктуры требует определённого уровня знаний,
поэтому такой способ не рекомендуется новичкам.

Ещё один вариант -- бездисковая установка с использованием загрузки по
локальной сети и монтированием всех локальных файловых систем через NFS.

2.4.4. Жёсткий диск

Загрузка системы установки непосредственно с жёсткого диска -- это ещё один
вариант, работающий на многих архитектурах. Он требует наличия какой-нибудь
другой операционной системы для загрузки программы установки на жёсткий диск.
Данный метод рекомендуется использовать только в особых случаях, если
недоступны остальные методы.

2.4.5. Система Un*x или GNU

Если вы работаете в другой Unix системе, то можете использовать её для
установки Debian GNU/Linux без использования debian-installer, описанного в
остальной части руководства. Этот тип установки может пригодиться пользователям
с каким-то неподдерживаемым оборудованием или на машинах, работу которых нельзя
прерывать. Если вы заинтересовались данным способом, перейдите в Раздел D.3,
«Установка Debian GNU/Linux из системы Unix/Linux». Данный метод установки
рекомендуется применять только опытным пользователям, если недоступны остальные
методы.

2.4.6. Поддерживаемые системы хранения

Программа установки Debian содержит ядро, при сборке которого главным было
увеличение количества систем, на которых бы оно запускалось.

Система установки Debian включает поддержку дисков IDE (также известных как
PATA), контроллеров/дисков SATA и SCSI, USB и FireWire. Поддерживаются файловые
системы FAT, Win-32 расширения FAT (VFAT) и NTFS.

IDE systems are also supported.

2.5. Требования к памяти и дисковому пространству

We recommend at least 512MB of memory and 4GB of hard disk space to perform an
installation. For more detailed values, see Раздел 3.4, «Минимальные требования
к аппаратному обеспечению».

Глава 3. Перед установкой Debian GNU/Linux

Содержание

3.1. Обзор процесса установки
3.2. Сохраните ваши данные в надёжном месте!
3.3. Информация, которая понадобится
    3.3.1. Документация
    3.3.2. Поиск источников технической информации
    3.3.3. Совместимость аппаратного обеспечения
    3.3.4. Настройки сети
3.4. Минимальные требования к аппаратному обеспечению
3.5. Переразметка для мульти-загрузочных систем
3.6. Настройка аппаратного обеспечения и операционной системы перед установкой
    3.6.1. Invoking the BIOS/UEFI Set-Up Menu
    3.6.2. Выбор загрузочного устройства
    3.6.3. Устройства с микропрограммой UEFI
    3.6.4. Secure boot
    3.6.5. Disabling the Windows «fast boot»/«fast startup» feature
    3.6.6. Аппаратные проблемы, которых нужно остерегаться

В этой главе рассказывается о том, что нужно сделать перед запуском программы
установки Debian: резервное копирование данных, сбор информации об оборудовании
и поиск необходимой информации.

3.1. Обзор процесса установки

Во-первых, немного о переустановках. Случаи, когда приходится полностью
переустанавливать Debian очень редки; наиболее часто это делается при
механической поломке жёсткого диска.

Для большинства операционных систем при критических сбоях или для обновления до
новой версии может требоваться выполнение полной установки. Даже если новая
установка не требуется, часто приходится переустанавливать некоторые программы,
чтобы они заработали в новой версии ОС.

В случае Debian GNU/Linux у вас намного больше шансов, что ОС будет
восстановлена без переустановки. При обновлении до новой версии установка
"всего" не требуется никогда; достаточно обновления только нужных частей. Все
программы почти всегда совместимы с новыми версиями операционной системы. Если
новая версия программы требует более нового программного обеспечения, система
управления пакетами Debian обеспечивает автоматическое обнаружение и установку
всего необходимого программного обеспечения. Много труда было вложено именно в
то, чтобы избежать переустановки, поэтому думайте об этом как о последней
причине вашего выбора. Программа установки не разрабатывалась для переустановки
поверх существующей системы.

Вот путь, который вам предстоит совершить.

 1. Сделать резервную копию существующих данных и документов жёсткого диска, на
    который вы планируете выполнить установку.

 2. Перед началом установки собрать информацию о компьютере и всю необходимую
    документацию.

 3. Найти и/или скачать программу установки и все нужные для вашей машины
    специальные драйверы или файлы микропрограмм.

 4. Создать загрузочный медианоситель, такой как CDs/DVDs/USB, или организовать
    инфраструктуру загрузки по сети, с помощью которой можно будет запустить
    программу установки.

 5. Загрузить систему установки.

 6. Выбрать язык установки.

 7. Активировать, если есть, подключение к сети ethernet.

 8. При необходимости, изменить размеры существующих разделов диска назначения
    для освобождения места под установку.

 9. Создать и смонтировать разделы, на которые будет установлен Debian.

10. Присматривать за автоматической загрузкой/установкой/настройкой базовой
    системы.

11. Выбрать и установить дополнительные программы.

12. Установить системный загрузчик, который сможет запускать Debian GNU/Linux и
    /или другую существующую систему.

13. Загрузить только что установленную систему в первый раз.

For 64-bit PC you have the option of using a graphical version of the
installation system. For more information about this graphical installer, see
Раздел 5.1.6, «Программа установки с графическим интерфейсом».

Если у вас возникли проблемы во время установки, хорошо иметь представление о
том, какими пакетами это могло быть вызвано и на каком шаге. Представляем
основных актёров от программного обеспечения в драме "установка":

Программа установки, debian-installer -- это главное, о чём писалось данное
руководство. Она обнаруживает аппаратное обеспечение и загружает
соответствующие драйверы, использует dhcp-client для настройки подключения к
сети, запускает debootstrap для установки пакетов базовой системы и запускает
tasksel для того, чтобы позволить вам выбрать установку дополнительного ПО.
Намного больше актёров играют меньшие роли в этом процессе, а debian-installer
завершает свою работу после первой загрузки операционной системы.

Для настройки системы под ваши нужды служит программа tasksel, которая
позволяет выбрать для установки различные готовые группы взаимосвязанных
программ под задачу, например, для веб сервера или настольного компьютера.

Одним из важных пунктов установки является выбор будет или нет установлено
графическое окружение рабочего стола, состоящее из X Window System и одного из
доступных графических окружений рабочего стола. Если вы не выберете задачу «
Окружение рабочего стола», то у вас получится относительно простая система,
управляемая из командной строки. Установка окружения рабочего стола является
необязательной задачей, так как, по сравнению с системой без графики, для неё
требуется относительно большое количество дискового пространства, и из-за того,
что многие системы Debian GNU/Linux являются серверами, которым не нужен
графический интерфейс пользователя для выполнения требуемых задач.

Оконная система X -- это полностью отдельная программа, никак не связанная с
debian-installer, и фактически, намного более сложная. Устранение проблем X
Window System не предмет рассмотрения данного руководства.

3.2. Сохраните ваши данные в надёжном месте!

Перед тем как начать, убедитесь, что вы сохранили каждый файл из вашей системы.
Если вы впервые устанавливаете на компьютер не родную операционную систему,
скорее всего вам придётся переразметить диск, чтобы выделить место для Debian
GNU/Linux. Всегда при разметке диска вы должны считать, что теряете всё на
диске, вне зависимости от используемого для этого инструмента. Программы,
используемые в установке Debian GNU/Linux, достаточно надёжны; с большинством
из них люди работают не первый год; но они достаточно мощны для того, чтобы
одно неосторожное движение дорого вам обошлось. Даже после сохранения данных
будьте осторожны и думайте над даваемыми ответами и действиями. Две минуты
раздумий могут спасти вас от нескольких часов ненужной работы.

Если вы создаёте мульти-загрузочную систему, убедитесь, что у вас под рукой
есть носители с дистрибутивами всех операционных систем, присутствующих на
диске. Иногда может возникнуть ситуация, когда вам потребуется переустановить
системный загрузчик операционной системы, чтобы система могла загружаться или,
в худшем случае, полностью переустановить операционную систему и восстановить
все файлы из резервных копий.

3.3. Информация, которая понадобится

3.3.1. Документация

3.3.1.1. Руководство по установке

Документ, который вы сейчас читаете, доступен в форматах ASCII, HTML или PDF.

  • install.ru.txt

  • install.ru.html

  • install.ru.pdf

3.3.1.2. Техническая документация

Часто содержит полезную информацию по настройке и использованию вашего
аппаратного обеспечения.

  • Вики-страница Debian по оборудованию

3.3.2. Поиск источников технической информации

В большинстве случаев программа установки способна определить используемое
оборудование автоматически. Но всё же мы рекомендуем вам перед установкой
самостоятельно ознакомиться с имеющимся оборудованием.

Информацию по аппаратному обеспечению можно найти:

  • В руководствах, которые были вместе с приобретённым аппаратным
    обеспечением.

  • The BIOS/UEFI setup screens of your computer. You can view these screens
    when you start your computer by pressing a combination of keys. Check your
    manual for the combination. Often, it is the Delete or the F2 key, but some
    manufacturers use other keys or key combinations. Usually upon starting the
    computer there will be a message stating which key to press to enter the
    setup screen.

  • На коробках и ящиках от аппаратного обеспечения.

  • Щёлкнув на значке "Система" в панели управления Windows.

  • С помощью системных команд и инструментов других операционных систем,
    включая файловый менеджер. Это особенно полезный источник информации об
    оперативной памяти и жёстких дисках.

  • Узнать у вашего системного администратора или провайдера услуг Интернет.
    Они могут рассказать вам о настройках почты и подключении к сети.

Таблица 3.1. Информация об оборудовании, полезная при установке

┌──────────────────┬─────────────────────────────────────────────────────┐
│   Оборудование   │       Информация, которая может потребоваться       │
├──────────────────┼─────────────────────────────────────────────────────┤
│                  │Количество дисков.                                   │
│                  ├─────────────────────────────────────────────────────┤
│                  │Их порядок в системе.                                │
│                  ├─────────────────────────────────────────────────────┤
│                  │IDE (тн. PATA), SATA или SCSI.                       │
│Жёсткие диски     ├─────────────────────────────────────────────────────┤
│                  │Доступное дисковое пространство.                     │
│                  ├─────────────────────────────────────────────────────┤
│                  │Разделы.                                             │
│                  ├─────────────────────────────────────────────────────┤
│                  │Разделы, на которых установлены операционные системы.│
├──────────────────┼─────────────────────────────────────────────────────┤
│Сетевые интерфейсы│Тип/модель доступных сетевых интерфейсов.            │
├──────────────────┼─────────────────────────────────────────────────────┤
│Принтер           │Модель и производитель.                              │
├──────────────────┼─────────────────────────────────────────────────────┤
│Видеокарта        │Тип/модель и производитель.                          │
└──────────────────┴─────────────────────────────────────────────────────┘


3.3.3. Совместимость аппаратного обеспечения

Многие устройства без проблем работают с Linux. Кроме того, поддержка
оборудования в Linux ежедневно улучшается. Однако, Linux всё равно пока не
может сравниться по количеству поддерживаемой аппаратуры с другими
операционными системами.

Драйверы в Linux, в большинстве случаев, пишутся не для определённого «продукта
» или «марки» какого-то производителя, а под определённое оборудование/набор
микросхем. Много кажущихся различными продуктов/марок основаны на одном
аппаратном проекте; часто бывает, что производитель микросхемы предоставляет
так называемый «типовой вариант дизайна» для продуктов, основанных на своих
микросхемах, который затем используется различными производителями устройств
для выпуска различных продуктов или марок.

Это имеет свои преимущества и недостатки. Преимущество состоит в том, что
драйвер для одной микросхемы работает для большого количества различных
продуктов от различных производителей, пока их продукт основывается на этой
микросхеме. Недостатком является то, что не всегда просто определить, какая
микросхема фактически используется в определённом продукте/марке. К сожалению,
иногда производители устройства изменяют аппаратную основу продукта, не изменяя
название или, по крайней мере, номер версии, поэтому иногда две модели одной
марки/продукта, купленных в разное время, могут основываться на различных
микросхемах, и поэтому нужно использовать два различных драйвера, или для
одного из них драйвер вообще может отсутствовать.

Чтобы выяснить на какой микросхеме основаны устройства USB и PCI/PCI-Express/
ExpressCard достаточно найти идентификатор устройства. Все устройства USB/PCI/
PCI-Express/ExpressCard имеют так называемый идентификатор «производителя» и «
продукта», и их комбинация, обычно, одинакова для продукта, основанного на
одной модели микросхемы.

On Linux systems, these IDs can be read with the lsusb command for USB devices
and with the lspci -nn command for PCI/PCI-Express/ExpressCard devices. The
vendor and product IDs are usually given in the form of two hexadecimal
numbers, separated by a colon, such as «1d6b:0001».

Пример вывода команды lsusb: «Bus 001 Device 001: ID 1d6b:0002 Linux Foundation
2.0 root hub», где 1d6b -- идентификатор производителя и 0002 -- идентификатор
продукта.

Пример вывода команды lspci -nn для карты Ethernet: «03:00.0 Ethernet
controller [0200]: Realtek Semiconductor Co., Ltd. RTL8111/8168B PCI Express
Gigabit Ethernet controller [10ec:8168] (rev 06)». Идентификаторы указаны
внутри последних квадратных скобок, т. е. здесь 10ec -- идентификатор
производителя и 8168 -- продукта.

Другой пример, графическая карта: «04:00.0 VGA compatible controller [0300]:
Advanced Micro Devices [AMD] nee ATI RV710 [Radeon HD 4350] [1002:954f]».

On Windows systems, the IDs for a device can be found in the Windows device
manager on the tab «details», where the vendor ID is prefixed with VEN_ and the
product ID is prefixed with DEV_. On newer Windows systems, you have to select
the property «Hardware IDs» in the device manager's details tab to actually see
the IDs, as they are not displayed by default.

Поиск в Интернет по идентификатору производителя/продукта, «Linux» и «driver»
часто даёт информацию о состоянии поддержки драйвером определённой микросхемы.
Если поиск идентификатору производителя/продукта не дал желаемых результатов,
то может помочь поиск по названию микросхемы, которое часто выдаётся lsusb и
lspci («RTL8111»/«RTL8168B» -- в примере с сетевой картой и «RV710» -- в
примере с графической картой).

3.3.3.1. Тестирование оборудования на совместимость с помощью Live-системы

Для некоторых архитектур Debian GNU/Linux доступен в виде так называемой «живой
системы». Живая система (live system) -- это настроенная, готовая к работе
система, предоставляемая в сжатом виде, которая может быть загружена и
использована с носителя, недоступного для записи, такого как CD или DVD. По
умолчанию при её работе на компьютер не вносится никаких постоянных изменений.
Вы можете менять настройки пользователя и устанавливать дополнительные
программы внутрь живой системы, но всё это выполняется только в оперативной
памяти, т. е. при выключении компьютера и загрузки живой системы снова все
изменения теряются. Если вы хотите проверить, поддерживается ли ваше
оборудование Debian GNU/Linux, то самым простым способом сделать это будет
попробовать запустить живую систему Debian.

Есть несколько ограничений при использовании живой системы. Прежде всего, так
как все изменения живой системы должны быть сохранены в RAM компьютера, она
работает только в системах с достаточным количеством RAM, и из-за ограничений
памяти нельзя установить дополнительные большие пакеты ПО. Другое ограничение
тестирования аппаратной совместимости -- живая система состоит только из
свободных компонентов, т. е. в ней отсутствуют несвободные файлы микропрограмм.
Конечно, эти несвободные пакеты можно установить вручную после запуска системы,
но какие именно -- это придётся выяснять пользователю, так как в живой системе
отсутствует автоматическое определение требуемых микропрограмм (в отличии от
debian-installer).

Информация о доступных вариантах живых образов Debian приведена на сайте живых
образов Debian.

3.3.4. Настройки сети

Если компьютер подключён к постоянной сети (т. е. к Ethernet или через
аналогичное подключение, но не коммутируемое/PPP соединение), которую
обслуживаете не вы, то вы должны попросить у вашего сетевого системного
администратора следующую информацию:

  • Имя вашей машины (возможно вы можете выбрать его самостоятельно).

  • Имя домена.

  • IP-адрес компьютера.

  • Маска сети.

  • IP-адрес шлюза по умолчанию, если в вашей сети есть такой шлюз.

  • Система в сети, которая используется как DNS (Domain Name Service) сервер.

Если в используемой сети для получения сетевых настроек используется DHCP
(Dynamic Host Configuration Protocol), то вам не нужна вся эта информация, так
как DHCP-сервер передаст её вашему компьютеру автоматически во время процесса
установки.

Если вы подключены к Интернету по DSL или кабельному модему (т. е. через
телевизионную кабельную сеть) и используете маршрутизатор (часто его
предоставляет уже настроенным телефонный или телевизионный оператор), который
осуществляет соединение с сетью, то, обычно, DHCP включён по умолчанию.

Как показывает опыт, если вы используете Windows в домашней сети и вручную не
изменяли сетевые настройки, чтобы попасть в Интернет, то сетевое подключение в
Debian GNU/Linux также будет настроено автоматически.

Если вы используете беспроводную сеть (WLAN/WiFi), то также нужно выяснить:

  • ESSID («имя сети») беспроводной сети.

  • Ключ безопасности WEP или WPA/WPA2 для доступа к сети (если применяется).

3.4. Минимальные требования к аппаратному обеспечению

После сбора всей информации о компонентах компьютера, проверьте, что ваше
аппаратное обеспечение соответствует требованиям желаемого типа установки.

В зависимости от потребностей, у вас может оказаться машина меньшей мощности,
чем рекомендовано в таблице ниже. Однако, большинство пользователей рискуют
оказаться расстроенными, если проигнорируют эти советы.

Минимальной рекомендуемой конфигурацией для настольной системы является машина
с процессором Pentium 4, 1 ГГц.

Таблица 3.2. Рекомендуемые минимальные требования к системе

┌─────────────────────────┬────────────────┬─────────────────────┬────────────┐
│      Тип установки      │Память (минимум)│       Память        │Жёсткий диск│
│                         │                │   (рекомендуется)   │            │
├─────────────────────────┼────────────────┼─────────────────────┼────────────┤
│Без настольных приложений│512MB           │1GB                  │4GB         │
├─────────────────────────┼────────────────┼─────────────────────┼────────────┤
│С настольными            │1GB             │2GB                  │10GB        │
│приложениями             │                │                     │            │
└─────────────────────────┴────────────────┴─────────────────────┴────────────┘


The minimum values assumes that swap will be enabled and a non-live image is
used. The «No desktop» value assumes that the text-based installer (not the
graphical one) is used.

The actual minimum memory requirements are a lot less than the numbers listed
in this table. With swap enabled, it is possible to install Debian with as
little as 350MB. The same goes for the disk space requirements, especially if
you pick and choose which applications to install; see Раздел D.2, «Дисковое
пространство, необходимое для задач» for additional information on disk space
requirements.

The installer normally automatically enables memory-saving tricks to be able to
run on such low-memory system, but on architectures that are less tested it may
miss doing so. It can however be enabled manually by appending the lowmem=1 or
even lowmem=2 boot parameter (see also Раздел 6.3.1.1, «Определение доступной
памяти / режим с малым потреблением памяти» and Раздел 5.3.2, «Параметры
программы установки Debian»).

Installation on systems with less memory^[2] or disk space available may be
possible but is only advised for experienced users.

Возможно запускать графическое окружение рабочего стола на старых или дешёвых
машинах, в этом случае рекомендуется установить менеджер окон, который
потребляет меньше ресурсов, чем окружения рабочего стола GNOME или KDE Plasma;
здесь стоит упомянуть xfce4, icewm и wmaker, но есть и другие.

Практически невозможно указать требования к диску и памяти для установки
серверной конфигурации, так как это в многом зависит от типа задач, выполняемых
сервером.

Не забудьте, что в данные размеры не включены размеры файлы, которые обычно
лежат на машине: файлы пользователя, почта и данные. Всегда нужно быть более
щедрым, когда подсчитываешь место для своих файлов и данных.

Дисковое пространство, необходимое для гладкой работы в Debian GNU/Linux уже
включено в рекомендуемые требования к системе. В частности, раздел /var
содержит много специфичной для Debian информации, а также обычные данные типа
журнальных файлов. Файлы dpkg (с информацией о всех установленных пакетах)
могут легко занять 40МБ. apt также помещает сюда скачанные файлы перед их
установкой. Обычно, требуется выделить по крайней мере 200МБ для /var и гораздо
больше, если вы планируете установку графического окружения рабочего стола.

3.5. Переразметка для мульти-загрузочных систем

Разметка диска -- это просто операция деления диска на секции. Каждая
выделенная секция не зависит от других. Это, грубо говоря, как построить стены
внутри дома; если вы добавите в одну комнату мебель, то это никак не повлияет
на другие комнаты.

If you already have an operating system on your system (Windows, OS/2, MacOS,
Solaris, FreeBSD, ...) which uses the whole disk and you want to stick Debian
on the same disk, you will need to repartition it. Debian requires its own hard
disk partitions. It cannot be installed on Windows or Mac OS X partitions. It
may be able to share some partitions with other Unix systems, but that's not
covered here. At the very least you will need a dedicated partition for the
Debian root filesystem.

You can find information about your current partition setup by using a
partitioning tool for your current operating system, such as the integrated
Disk Manager in Windows. Partitioning tools always provide a way to show
existing partitions without making changes.

Изменение раздела с уже имеющейся файловой системой уничтожит всю информацию на
нём. То есть вы всегда должны сделать резервную копию всей информации перед
переразметкой. Используя аналогию с домом, вы вероятно захотите вынести всю
мебель перед переносом стен или же вы рискуете попортить её.

Several modern operating systems offer the ability to move and resize certain
existing partitions without destroying their contents. This allows making space
for additional partitions without losing existing data. Even though this works
quite well in most cases, making changes to the partitioning of a disk is an
inherently dangerous action and should only be done after having made a full
backup of all data. For FAT/FAT32 and NTFS partitions as used by Windows
systems, the ability to move and resize them losslessly is provided both by
debian-installer as well as by the integrated Disk Manager of Windows.

Чтобы изменить размер существующего раздела FAT или NTFS без потерь данных из
debian-installer перейдите к шагу разметки, выберите вариант разметки вручную,
выберите изменяемый раздел и просто укажите его новый размер.

3.6. Настройка аппаратного обеспечения и операционной системы перед установкой

This section will walk you through pre-installation hardware setup, if any,
that you will need to do prior to installing Debian. Generally, this involves
checking and possibly changing BIOS/UEFI/system firmware settings for your
system. The «BIOS/UEFI» or «system firmware» is the core software used by the
hardware; it is most critically invoked during the bootstrap process (after
power-up).

3.6.1. Invoking the BIOS/UEFI Set-Up Menu

The BIOS/UEFI provides the basic functions needed to boot your machine and to
allow your operating system to access your hardware. Your system provides a
BIOS/UEFI setup menu, which is used to configure the BIOS/UEFI. To enter the
BIOS/UEFI setup menu you have to press a key or key combination after turning
on the computer. Often it is the Delete or the F2 key, but some manufacturers
use other keys. Usually upon starting the computer there will be a message
stating which key to press to enter the setup screen.

3.6.2. Выбор загрузочного устройства

Within the BIOS/UEFI setup menu, you can select which devices shall be checked
in which sequence for a bootable operating system. Possible choices usually
include the internal harddisks, the CD/DVD-ROM drive and USB mass storage
devices such as USB sticks or external USB harddisks. On modern systems there
is also often a possibility to enable network booting via PXE.

В зависимости от установочного носителя (CD/DVD ROM, карта памяти USB, загрузка
по сети) вы должны включить загрузку с соответствующих устройств, если это ещё
не сделано.

Most BIOS/UEFI versions allow you to call up a boot menu on system startup in
which you select from which device the computer should start for the current
session. If this option is available, the BIOS/UEFI usually displays a short
message like «press F12 for boot menu» on system startup. The actual key used
to select this menu varies from system to system; commonly used keys are F12, 
F11 and F8. Choosing a device from this menu does not change the default boot
order of the BIOS/UEFI, i.e. you can start once from a USB stick while having
configured the internal harddisk as the normal primary boot device.

If your BIOS/UEFI does not provide you with a boot menu to do ad-hoc choices of
the current boot device, you will have to change your BIOS/UEFI setup to make
the device from which the debian-installer shall be booted the primary boot
device.

Unfortunately some computers may contain buggy BIOS/UEFI versions. Booting
debian-installer from a USB stick might not work even if there is an
appropriate option in the BIOS/UEFI setup menu and the stick is selected as the
primary boot device. On some of these systems using a USB stick as boot medium
is impossible; others can be tricked into booting from the stick by changing
the device type in the BIOS/UEFI setup from the default «USB harddisk» or «USB
stick» to «USB ZIP» or «USB CDROM». In particular if you use an isohybrid
installation image on a USB stick (see Раздел 4.3.1, «Preparing a USB stick
using a hybrid CD/DVD image»), changing the device type to «USB CDROM» helps on
some BIOSes which will not boot from a USB stick in USB harddisk mode. You may
need to configure your BIOS/UEFI to enable «USB legacy support».

If you cannot manipulate the BIOS/UEFI to boot directly from a USB stick you
still have the option of using an ISO copied to the stick. Boot
debian-installer using Раздел 4.4, «Подготовка файлов для загрузки с жёсткого
диска» and, after scanning the hard drives for an installer ISO image, select
the USB device and choose an installation image.

3.6.3. Устройства с микропрограммой UEFI

UEFI («Единый Расширяемый Интерфейс Микропрограммы») -- новый вид системной
микропрограммы, который используется в современных устройствах и -- помимо
прочего -- предназначен для замеры классического BIOS ПК.

В настоящее время ПК с UEFI также содержат так называемый «Compatibility
Support Module» (CSM), который предоставляет тот же интерфейс, что и
классический BIOS ПК, поэтому ПО, написанное для BIOS ПК, может использоваться
без изменений.Тем не менее UEFI предназначен однажды полностью заменить старый
BIOS ПК без предоставления обратной совместимости и поэтому уже сейчас многие
системы с UEFI поставляются без CSM.

При установке ОС на устройства с UEFI нужно учесть несколько вещей. Способ,
которым микропрограмма загружает ОС кардинально отличается от классического
BIOS (или UEFI в режиме CSM). Основным отличием является способ размещения
разделов на жёстком диске. В классическом BIOS и UEFI в режиме CSM используется
таблица разделов DOS, а в UEFI используется другая схема разметки, называемая «
GUID Partition Table» (GPT). Имея один диск, можно использовать что-то одно, и
в случае мульти-загрузки различных ОС с одного диска, они все должны
использовать единый тип таблицы загрузки. Загрузка с диска с GPT возможна
только в родном режиме UEFI, но по мере роста объёмов дисков случаев
использования GPT становится всё больше, так как классическая таблица разделов
DOS не вмещает адреса дисков более 2 терабайт (а GPT позволяет использовать
гораздо большие диски). Другим существенным отличием BIOS (или UEFI в режиме
CSM) от UEFI является место, где хранится загрузочный код и его формат. Это
означает, что для каждой из систем необходим свой загрузчик.

The latter becomes important when booting debian-installer on a UEFI system
with CSM because debian-installer checks whether it was started on a BIOS- or
on a native UEFI system and installs the corresponding bootloader. Normally
this simply works but there can be a problem in multi-boot environments. On
some UEFI systems with CSM the default boot mode for removable devices can be
different from what is actually used when booting from hard disk, so when
booting the installer from a USB stick in a different mode from what is used
when booting another already installed operating system from the hard disk, the
wrong bootloader might be installed and the system might be unbootable after
finishing the installation. When choosing the boot device from a firmware boot
menu, some systems offer two separate choices for each device, so that the user
can select whether booting shall happen in CSM or in native UEFI mode.

3.6.4. Secure boot

Another UEFI-related topic is the so-called «secure boot» mechanism. Secure
boot means a function of UEFI implementations that allows the firmware to only
load and execute code that is cryptographically signed with certain keys and
thereby blocking any (potentially malicious) boot code that is unsigned or
signed with unknown keys. In practice the only key accepted by default on most
UEFI systems with secure boot is a key from Microsoft used for signing the
Windows bootloader. Debian includes a «shim» bootloader signed by Microsoft, so
should work correctly on systems with secure boot enabled.

3.6.5. Disabling the Windows «fast boot»/«fast startup» feature

Windows offers a feature (called «fast boot» in Windows 8, «fast startup» in
Windows 10) to cut down system startup time. Technically, when this feature is
enabled, Windows does not do a real shutdown and a real cold boot afterwards
when ordered to shut down, but instead does something resembling a partial
suspend to disk to reduce the «boot» time. As long as Windows is the only
operating system on the machine, this is unproblematic, but it can result in
problems and data loss, when you have a dual boot setup, in which another
operating system accesses the same filesystems as Windows does. In that case
the real state of the filesystem can be different from what Windows believes it
to be after the «boot» and this could cause filesystem corruption upon further
write accesses to the filesystem. Therefore in a dual boot setup, to avoid
filesystem corruption the «fast boot»/«fast startup» feature has to be disabled
within Windows.

Furthermore, the Windows Update mechanism has (sometimes) been known to
automatically re-enable this feature, after it has been previously disabled by
the user. It is suggested to re-check this setting periodically.

Также может потребоваться отключить «fast boot» даже для получения доступа к
настройке UEFI, чтобы выбрать для запуска другую операционную систему или
debian-installer. В некоторых системах с UEFI микропрограмма сокращает время «
загрузки» не инициализируя контроллер клавиатуры или аппаратуру USB; в таких
случаях необходимо загрузиться в Windows и выключить это свойство позволяя, тем
самым, изменить порядок загрузки.

3.6.6. Аппаратные проблемы, которых нужно остерегаться

Поддержка USB в BIOS и клавиатуры. Если ваша клавиатура имеет разъём не PS/2, а
USB, то чтобы использовать её в загрузочном меню на некоторых очень старых
компьютерах вам может потребоваться включить эмуляцию устаревших (legacy)
клавиатур в настройках BIOS (этой проблемы нет у современных ПК). Если
клавиатура не работает в загрузочном меню посмотрите руководство к материнской
плате и найдите параметры в BIOS «Legacy keyboard emulation» или «USB keyboard
support».


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[2] Installation images that support the graphical installer require more
memory than images that support only the text-based installer and should not be
used on systems with less than 780MB of memory. If there is a choice between
booting the text-based and the graphical installer, the former should be
selected on such systems.

Глава 4. Получение носителя с дистрибутивом

Содержание

4.1. Official Debian GNU/Linux installation images
4.2. Скачивание файлов с серверов-зеркал Debian
    4.2.1. Where to Find Installation Files
4.3. Подготовка файлов для загрузки с карты памяти USB
    4.3.1. Preparing a USB stick using a hybrid CD/DVD image
4.4. Подготовка файлов для загрузки с жёсткого диска
    4.4.1. Hard disk installer booting from Linux using GRUB
4.5. Подготовка файлов для загрузки по TFTP
    4.5.1. Настройка DHCP сервера
    4.5.2. Настройка BOOTP сервера
    4.5.3. Включение TFTP сервера
    4.5.4. Копирование TFTP образов в каталог TFTP сервера
4.6. Автоматическая установка
    4.6.1. Автоматическая установка с помощью программы установки Debian
4.7. Verifying the integrity of installation files

4.1. Official Debian GNU/Linux installation images

By far the easiest way to install Debian GNU/Linux is from a set of official
Debian installation images. You can buy a set of CDs/DVDs or an USB stick from
a vendor (see the CD vendors page). You may also download the installation
images from a Debian mirror and make your own set, if you have a fast network
connection and a CD/DVD burner. Or the modern way: write such image to an USB
stick (see the Debian CD/DVD page and Debian CD FAQ for detailed instructions).
If you have such installation media, and they are bootable on your machine,
which is the case on all modern PCs, you can skip right to Глава 5, Загрузка
системы установки. Much effort has been expended to ensure the most-used files
are on the first DVD image, so that a basic desktop installation can be done
with only the first DVD.

Also, keep in mind: if the installation media you are using don't contain some
packages you need, you can always install those packages afterwards from your
running new Debian system (after the installation has finished). If you need to
know on which installation image to find a specific package, visit https://
cdimage-search.debian.org/.

If your machine doesn't support booting from optical media (only relevant on
very old PC systems), but you do have a set of DVD, you can use an alternative
strategy such as hard disk, usb stick, net boot, or manually loading the kernel
from the disc to initially boot the system installer. The files you need for
booting by another means are also on the disc; the Debian network archive and
folder organization on the disc are identical. So when archive file paths are
given below for particular files you need for booting, look for those files in
the same directories and subdirectories on your installation media.

Once the installer is booted, it will be able to obtain all the other files it
needs from the disc.

If you don't have an installation media set, then you will need to download the
installer system files and place them on the hard disk or usb stick or a
connected computer so they can be used to boot the installer.

4.2. Скачивание файлов с серверов-зеркал Debian

Ближайший (и поэтому, вероятно, самый быстрый) к вам сервер-зеркало можно найти
в списке серверов-зеркал Debian.

4.2.1. Where to Find Installation Files

Various installation files can be found on each Debian mirror in the directory
debian/dists/trixie/main/installer-amd64/current/images/ -- the MANIFEST lists
each image and its purpose.

4.3. Подготовка файлов для загрузки с карты памяти USB

To prepare the USB stick, we recommend to use a system where GNU/Linux is
already running and where USB is supported. With current GNU/Linux systems the
USB stick should be automatically recognized when you insert it. If it is not
you should check that the usb-storage kernel module is loaded. When the USB
stick is inserted, it will be mapped to a device named /dev/sdX, where the «X»
is a letter in the range a-z. You should be able to see to which device the USB
stick was mapped by running the command lsblk before and after inserting it.
(The output of dmesg (as root) is another possible method for that.) To write
to your stick, you may have to turn off its write protection switch.

Предупреждение

The procedures described in this section will destroy anything already on the
device! Make very sure that you use the correct device name for your USB stick.
If you use the wrong device the result could be that all information on, for
example, a hard disk is lost.

4.3.1. Preparing a USB stick using a hybrid CD/DVD image

Debian installation images for this architecture are created using the 
isohybrid technology; that means they can be written directly to a USB stick,
which is a very easy way to make an installation media. Simply choose an image
(such as the netinst or DVD-1) that will fit on your USB stick. See Раздел 4.1,
«Official Debian GNU/Linux installation images» to get an installation image.

The installation image you choose should be written directly to the USB stick,
overwriting its current contents. For example, when using an existing GNU/Linux
system, the image file can be written to a USB stick as follows, after having
made sure that the stick is unmounted:

# cp debian.iso /dev/sdX
# sync

Simply writing the installation image to USB like this should work fine for
most users. For special needs there is this wiki page.

Information about how to do this on other operating systems can be found in the
Debian CD FAQ.

Важно

Образ должен быть записан на устройство, представляющее весь диск, а не
отдельный раздел, например /dev/sdb, а не /dev/sdb1. Не используйте программы
типа unetbootin, которые изменяют образ.

4.4. Подготовка файлов для загрузки с жёсткого диска

The installer may be booted using boot files placed on an existing hard drive
partition, either launched from another operating system or by invoking a boot
loader directly from the BIOS. On modern UEFI systems, the kernel may be booted
directly from the UEFI partition without the need of a boot loader.

A full, «pure network» installation can be achieved using this technique. This
avoids all hassles of removable media, like finding and burning CD/DVD images.

4.4.1. Hard disk installer booting from Linux using GRUB

This section explains how to add to or even replace an existing linux
installation using GRUB.

At boot time, GRUB supports loading in memory not only the kernel, but also a
disk image. This RAM disk can be used as the root file-system by the kernel.

Copy the following files from the Debian archives to a convenient location on
your hard drive, for instance to /boot/newinstall/.

  • vmlinuz (файл ядра)

  • initrd.gz (образ ramdisk)

Если вы намереваетесь использовать жёсткий диск только для загрузки, а затем
выполнять установку по сети, то вы должны скачать файл netboot/debian-installer
/amd64/initrd.gz и соответствующее ему ядро netboot/debian-installer/amd64/
linux. Это позволит вам переразметить жёсткий диск с которого вы загрузились,
хотя вы должны делать это осторожно.

Alternatively, if you intend to keep an existing partition on the hard drive
unchanged during the install, you can download the hd-media/initrd.gz file and
its kernel hd-media/vmlinuz, as well as copy an installation image to the hard
drive (make sure the file is named ending in .iso). The installer can then boot
from the hard drive and install from the installation image, without needing
the network.

Настройте системный загрузчик следуя указаниям Раздел 5.1.3, «Booting from
Linux using GRUB».

4.5. Подготовка файлов для загрузки по TFTP

Если ваша машина подключена к локальной сети, то вы можете загрузить её по сети
с другой машины через TFTP. Для этого на удалённую машину в определённое место
вам нужно поместить загрузочные файлы и настроить поддержку загрузки вашей
машины.

Вам нужно настроить TFTP сервер, а если машин много, то DHCP сервер .

BOOTP -- это IP протокол, который информирует компьютер о его IP-адресе и где в
сети получить загрузочный образ. DHCP (Dynamic Host Configuration Protocol)
более гибок и обратно совместим с BOOTP. Некоторые системы могут быть настроены
только через DHCP.

Trivial File Transfer Protocol (TFTP) используется для загрузки загрузочного
образа на клиентскую машину. Теоретически, можно использовать любой сервер на
любой платформе, которая реализует эти протоколы. В примерах этого раздела мы
используем команды из SunOS 4.x, SunOS 5.x (так называемый Solaris) и GNU/
Linux.

Примечание

Для сервера Debian GNU/Linux мы рекомендуем tftpd-hpa. Он написан автором
системного загрузчика syslinux и поэтому, скорее всего, не вызовет проблем.
Также неплох atftpd.

4.5.1. Настройка DHCP сервера

Одним из свободных DHCP серверов является ISC dhcpd. В Debian GNU/Linux он
доступен из пакета isc-dhcp-server. Вот пример его конфигурационного файла
(обычно /etc/dhcp/dhcpd.conf):

option domain-name "example.com";
option domain-name-servers ns1.example.com;
option subnet-mask 255.255.255.0;
default-lease-time 600;
max-lease-time 7200;
server-name "servername";

subnet 192.168.1.0 netmask 255.255.255.0 {
  range 192.168.1.200 192.168.1.253;
  option routers 192.168.1.1;
}

host clientname {
  filename "/tftpboot.img";
  server-name "servername";
  next-server servername;
  hardware ethernet 01:23:45:67:89:AB;
  fixed-address 192.168.1.90;
}

В этом примере определён единственный сервер servername, который работает в
качестве DHCP, TFTP серверов и шлюза сети. Вам почти наверняка нужно изменить
опцию domain-name, а также имя сервера и аппаратный адрес клиента. Опция
filename должна содержать имя файла, который нужно получить по TFTP.

После редактирования конфигурационного файла для dhcpd, перезагрузите сервер
командой /etc/init.d/isc-dhcp-server restart.

4.5.1.1. Включение загрузки PXE в конфигурацию DHCP

Вот другой пример dhcp.conf, который можно использовать, если включён метод
предстартового выполнения среды (PXE) по TFTP.

option domain-name "example.com";

default-lease-time 600;
max-lease-time 7200;

allow booting;
allow bootp;

# нужно изменить согласно вашим настройкам
subnet 192.168.1.0 netmask 255.255.255.0 {
  range 192.168.1.200 192.168.1.253;
  option broadcast-address 192.168.1.255;
# адрес шлюза, который может быть другим
# (для доступа в интернет, например)
  option routers 192.168.1.1;
# используемый dns
  option domain-name-servers 192.168.1.3;
}

group {
 next-server 192.168.1.3;
 host tftpclient {
# аппаратный адрес клиента tftp
  hardware ethernet  00:10:DC:27:6C:15;
  filename "pxelinux.0";
 }
}

Заметим, что для PXE загрузки в filename клиента pxelinux.0 записан системный
загрузчик, а не образ ядра (смотрите ниже Раздел 4.5.4, «Копирование TFTP
образов в каталог TFTP сервера»).

If your machine uses UEFI to boot, you will have to specify a boot loader
appropriate for UEFI machines, for example

group {
  next-server 192.168.1.3;
  host tftpclient {
# tftp client hardware address
  hardware ethernet  00:10:DC:27:6C:15;
  filename "debian-installer/amd64/bootnetx64.efi";
 }
}

4.5.2. Настройка BOOTP сервера

Для GNU/Linux есть два BOOTP сервера. Первый -- CMU bootpd. Второй, на самом
деле являющийся сервером DHCP -- ISC dhcpd. В Debian GNU/Linux они находятся в
пакетах bootp и isc-dhcp-server соответственно.

To use CMU bootpd, you must first uncomment (or add) the relevant line in /etc/
inetd.conf. On Debian GNU/Linux, you can run update-inetd --enable bootps, then
/etc/init.d/inetd reload to do so. Just in case your BOOTP server does not run
Debian, the line in question should look like:

bootps  dgram  udp  wait  root  /usr/sbin/bootpd  bootpd -i -t 120

Now, you must create an /etc/bootptab file. This has the same sort of familiar
and cryptic format as the good old BSD printcap, termcap, and disktab files.
See the bootptab manual page for more information. For CMU bootpd, you will
need to know the hardware (MAC) address of the client. Here is an example /etc/
bootptab:

client:\
  hd=/tftpboot:\
  bf=tftpboot.img:\
  ip=192.168.1.90:\
  sm=255.255.255.0:\
  sa=192.168.1.1:\
  ha=0123456789AB:

You will need to change at least the «ha» option, which specifies the hardware
address of the client. The «bf» option specifies the file a client should
retrieve via TFTP; see Раздел 4.5.4, «Копирование TFTP образов в каталог TFTP
сервера» for more details.

Напротив, настройка BOOTP в ISC dhcpd очень проста, так как здесь клиенты BOOTP
считаются одним из вариантов клиентов DHCP. Некоторые архитектуры требуют
сложной настройки для загрузки клиентов по BOOTP. Если у вас один из таких
случаев, прочитайте раздел Раздел 4.5.1, «Настройка DHCP сервера». Если нет, то
достаточно просто добавить директиву allow bootp в блок настройки подсети,
содержащей клиента, в /etc/dhcp/dhcpd.confи перезапустить dhcpd командой /etc/
init.d/isc-dhcp-server restart.

4.5.3. Включение TFTP сервера

Чтобы сервер TFTP заработал, во-первых нужно проверить что включена tftpd.

Программа tftpd-hpa может быть запущена двумя способами. Она может запускаться
по требованию службой inetd, или может быть настроена для работы как
независимая служба. Выбор метода происходит при при установке пакета, и его
можно изменить через перенастройку пакета.

Примечание

Исторически, TFTP-серверы используют каталог /tftpboot для хранения образов.
Однако, пакеты Debian GNU/Linux могут использовать другие каталоги, чтобы
соответствовать Filesystem Hierarchy Standard. Например, tftpd-hpa по умолчанию
использует /srv/tftp. Вам может потребоваться изменить примеры конфигурации для
соответствия.

По умолчанию, все альтернативные программы in.tftpd, доступные в Debian,
протоколируют запросы TFTP в системный журнал. Некоторые из них имеют параметр
-v, позволяющий включить более подробный протокол. Рекомендуется проверить эти
сообщения в журнале в случае возникновения проблем с загрузкой; это хорошая
отправная точка при поиске причин ошибок.

4.5.4. Копирование TFTP образов в каталог TFTP сервера

Далее, поместите нужный загрузочный образ TFTP из Раздел 4.2.1, «Where to Find
Installation Files» в каталог загрузочных образов tftpd. Вы можете сделать
ссылку на этот файл для файла, который tftpd будет передавать для загрузки
определённому клиенту. К сожалению, имя файла зависит от клиента TFTP и никак
не стандартизовано.

For PXE booting, everything you should need is set up in the netboot/
netboot.tar.gz tarball. Simply extract this tarball into the tftpd boot image
directory. Make sure your dhcp server is configured to pass pxelinux.0 to tftpd
as the filename to boot. For UEFI machines, you will need to pass an
appropriate EFI boot image name (such as /debian-installer/amd64/
bootnetx64.efi).

4.6. Автоматическая установка

For installing on multiple computers it's possible to do fully automatic
installations. Debian packages intended for this include fai-quickstart, which
can use an install server (have a look at the FAI home page for detailed
information) and the Debian Installer itself.

The FAI project also provides a web service for creating customized unattended
installation ISO images with only a few clicks. You can choose the desktop
environment, the language, the release, set the password and add your own list
of additional packages. After a few minutes your can download and boot the
image, that will do the fully automatic installation without any interaction
needed. Some more advanced settings are available for Linux experts.

4.6.1. Автоматическая установка с помощью программы установки Debian

Программа установки Debian поддерживает автоматическую установку через файлы
автоматической установки. Файл автоматической установки может быть загружен по
сети или со сменного носителя, и используется для ответов на вопросы,
задаваемые во время процесса установки.

Полную документацию по автоматической установке и рабочий пример, который вы
можете отредактировать, находится в Приложение B, Автоматическая установка с
помощью списка ответов.

4.7. Verifying the integrity of installation files

You can verify the integrity of downloaded files against checksums provided in
SHA256SUMS or SHA512SUMS files on Debian mirrors. You can find them in the same
places as the installation images itself. Visit the following locations:

  • checksum files for CD images,

  • checksum files for DVD images,

  • checksum files for BD images,

  • checksum files for other installation files.

To compute the checksum of a downloaded installation file, use

sha256sum filename.iso

respective

sha512sum filename.iso

and then compare the shown checksum against the corresponding one in the
SHA256SUMS respective SHA512SUMS file.

The Debian CD FAQ has more useful information on this topic (such as the script
check_debian_iso, to semi-automate above procedure), as well as instructions,
how to verify the integrity of the above checksum files themselves.

Глава 5. Загрузка системы установки

Содержание

5.1. Запуск программы установки на 64-bit PC
    5.1.1. Загрузка с карты памяти USB
    5.1.2. Booting from optical disc (CD/DVD)
    5.1.3. Booting from Linux using GRUB
    5.1.4. Загрузка по TFTP
    5.1.5. Экран запуска
    5.1.6. Программа установки с графическим интерфейсом
5.2. Лёгкость управления
    5.2.1. Пользовательский интерфейс программы установки
    5.2.2. USB-дисплеи Брайля
    5.2.3. Дисплеи Брайля, подключаемые к последовательному порту
    5.2.4. ПО речевого синтеза
    5.2.5. Устройства речевого синтеза
    5.2.6. Встраиваемые устройства
    5.2.7. Тема с высокой контрастностью
    5.2.8. Увеличение
    5.2.9. Экспертная установка, режим восстановления и автоматизированная
    установка
    5.2.10. Специальные возможности установленной системы
5.3. Параметры загрузки
    5.3.1. Boot serial console
    5.3.2. Параметры программы установки Debian
    5.3.3. Использование параметров загрузки для ответов на вопросы
    5.3.4. Передача параметров модулям ядра
    5.3.5. Внесение модулей ядра в чёрный список
5.4. Диагностика проблем процесса установки
    5.4.1. Reliability of optical media
    5.4.2. Настройка загрузки
    5.4.3. ПО речевого синтеза
    5.4.4. Распространённые проблемы установки на 64-bit PC
    5.4.5. Интерпретация загрузочных сообщений ядра
    5.4.6. Сообщение о проблемах при установке
    5.4.7. Отправка отчётов об ошибках установки

5.1. Запуск программы установки на 64-bit PC

Предупреждение

Если у вас уже установлены другие операционные системы и их нужно сохранить
(настроить двойную загрузку), перед тем как загружать программу установки
убедитесь, что они были полностью выключены. Установка операционной системы в
то время как другая операционная система находится в режиме "спячки" (была
выполнена приостановка с сохранением состояния на диск) может привести к потере
или повреждению состояния приостановленной системы, вследствие чего могут
возникнуть проблемы при её перезагрузке.

Примечание

О том, как запустить программу установки с графическим интерфейсом смотрите
Раздел 5.1.6, «Программа установки с графическим интерфейсом».

5.1.1. Загрузка с карты памяти USB

Если ваш компьютер будет загружаться с USB, то это, вероятно, самый простой
путь установки. Предполагая, что вы уже приготовили всё как написано в 
Раздел 3.6.2, «Выбор загрузочного устройства» и Раздел 4.3, «Подготовка файлов
для загрузки с карты памяти USB», просто вставьте карту памяти USB в свободное
гнездо USB и перезагрузите компьютер. Система должна загрузиться и, если вы не
использовали гибкий способ создания карты и не включили этого, то должны
увидеть графическое меню загрузки (если это поддерживается аппаратурой). Здесь
вы можете ввести необязательные параметры загрузки или просто нажать Enter.

5.1.2. Booting from optical disc (CD/DVD)

If you have a set of optical discs, and your machine supports booting directly
off those, great! Simply configure your system for booting off an optical disc
as described in Раздел 3.6.2, «Выбор загрузочного устройства», insert the disc,
reboot, and proceed to the next chapter.

Note that certain optical drives may require special drivers, and thus be
inaccessible in the early installation stages. If it turns out the standard way
of booting off an optical disc doesn't work for your hardware, revisit this
chapter and read about alternate kernels and installation methods which may
work for you.

Even if you cannot boot from optical disc, you can probably install the Debian
system components and any packages you want from such disc. Simply boot using a
different medium and when it's time to install the operating system, base
system, and any additional packages, point the installation system at the
optical drive.

При возникновении проблем с загрузкой смотрите Раздел 5.4, «Диагностика проблем
процесса установки».

5.1.3. Booting from Linux using GRUB

Для загрузки программы установки с жёсткого диска у вас уже должны быть
полностью полученные и размещённые на диске необходимые файлы (смотрите
Раздел 4.4, «Подготовка файлов для загрузки с жёсткого диска»).

For GRUB2, you will need to configure two essential things in /boot/grub/
grub.cfg:

  • to load the initrd.gz installer at boot time;

  • have the vmlinuz kernel use a RAM disk as its root partition.

An entry for the installer would be for example:

menuentry 'New Install' {
insmod part_msdos
insmod ext2
set root='(hd0,msdos1)'
linux /boot/newinstall/vmlinuz
initrd /boot/newinstall/initrd.gz
}

5.1.4. Загрузка по TFTP

Загрузка по сети требует наличия сетевого подключения и сетевого загрузочного
сервера TFTP (и, вероятно, также серверов DHCP, RARP или BOOTP для
автоматической настройки по сети).

Настройка сервера для обеспечения загрузки из сети описана в Раздел 4.5,
«Подготовка файлов для загрузки по TFTP».

Есть несколько возможностей выполнить загрузку по TFTP на i386.

5.1.4.1. Сетевая карта или материнская плата с поддержкой PXE

It could be that your Network Interface Card or Motherboard provides PXE boot
functionality. This is a Intel (tm) re-implementation of TFTP boot. If so, you
may be able to configure your BIOS/UEFI to boot from the network.

5.1.4.2. Сетевая карта с сетевым BootROM

Возможно, что сетевая карта (NIC) предоставляет возможность загрузки по TFTP.

5.1.4.3. Etherboot

Проект etherboot предоставляет загрузочные дискеты и даже прошивки (bootrom)
для TFTPboot.

5.1.5. Экран запуска

После загрузки программы установки экран должен переключиться в графический
режим и отобразить логотип Debian и меню:

Debian GNU/Linux installer boot menu

Graphical install
Install
Advanced options                            >
Accessible dark contrast installer menu     >
Help
Install with speech synthesis

Примечание

Этот список может немного отличаться, в зависимости от того, как загружался
компьютер (BIOS или UEFI), но пункты будут такими же.

В зависимости от используемого метода установки пункт «Graphical install» может
быть недоступен. Двуархитектурные образы также имеют 64-битный вариант для
каждого пункта установки, что почти удваивает количество пунктов.

Для обычной установки выберите «Graphical Install» или « Install» с помощью
клавиш со стрелками на клавиатуре или нажав первую (выделенную) букву и нажмите
Enter для запуска программы установки. Элемент «Graphical Install» уже выбран
настройкой по умолчанию.

Пункт «Advanced options» выводит второе меню, которое позволяет запускать
программу установки в экспертном режиме, в режиме восстановления и для
автоматизации установки.

If you wish or need to add any boot parameters for either the installer or the
kernel, press Tab (BIOS boot), or e then down arrow three times then end, to
edit the «linux» line of the boot entry (UEFI boot). This will bring the boot
command for the selected menu entry and allow you to edit it to suit your
needs. Note that the keyboard layout at this point is still QWERTY. The help
screens (see below) list some common possible options. Press Enter (BIOS boot)
or F10 (UEFI boot) to boot the installer with your options; pressing Esc will
return you to the boot menu and undo any changes you made.

Выбрав пункт «Help», можно увидеть первый справочный экран, на котором дано
краткое описание всех доступных справочных экранов. Чтобы вернуться в
загрузочное меню из справочных экранов, введите «menu» в приглашении к загрузке
и нажмите Enter. Все справочные экраны имеют приглашение к загрузке, в котором
можно набрать команду загрузки:

Press F1 for the help index, or ENTER to boot:

В приглашении к загрузке, вы можете просто нажать Enter для запуска программы
установки с параметрами по умолчанию, или ввести специальную команду загрузки и
параметры к ней. Различные загрузочные параметры можно найти на справочных
экранах. Если вы добавляете какой-то параметр в командную строку загрузки,
убедитесь, что сперва указан метод загрузки (по умолчанию install), и есть
пробел перед первым параметром (например, install nomodeset).

Примечание

По умолчанию предполагается, что используется клавиатура с раскладкой
американского английского. Это означает, что если клавиатура имеет другую
(языковую) раскладку, то при вводе параметров на экране могут появляться не те
символы, которых вы ожидаете. В Wikipedia есть картинка американской раскладки
клавиатуры, которую можно использовать для поиска нужных клавиш.

Примечание

Если вы используете компьютер, в котором из BIOS настроена работа через
последовательную консоль, то вы можете не увидеть начальную графическую
заставку на экране при запуске программы установки; вы даже можете не увидеть
загрузочное меню. Это же может случиться, если вы устанавливаете систему через
удалённое устройство управления, которое предоставляет текстовый интерфейс на
VGA консоли. К таким устройствам относятся текстовые консоли Compaq «integrated
Lights Out» (iLO) и HP «Integrated Remote Assistant» (IRA).

Чтобы пропустить графическую заставку загрузки вы можете вслепую нажать Esc и
получить текстовое приглашение к загрузке, или (также вслепую) нажать «H» и 
Enter для выбора пункта «Help», описанного ранее. После этого, вы должны видеть
то, что набираете. Чтобы программа установки не использовала фрейм-буфер для
дальнейшей установки, также вам нужно добавить в приглашение к загрузке
параметр vga=normal nomodeset, который описан в справке.

5.1.6. Программа установки с графическим интерфейсом

Графическая версия программы установки доступна только для ограниченного числа
архитектур, включая 64-bit PC. Функциональность графической версии программы
установки практически такая же, что и у текстовой программы установки, так как
внутри используются одинаковые программы, отличия только в интерфейсе.

Хотя функциональность и одинакова, графическая версия программы установки
обладает рядом значительных новшеств. Основное преимущество -- поддержка
большего числа языков, а именно тех, в которых нельзя отобразить все символы
через текстовый интерфейс «newt». Также, ей более удобно пользоваться, управляя
с помощью мыши, и иногда некоторые вопросы целиком влезают на один экран.

The graphical installer is available with all CD/DVD images and with the
hd-media installation method. To boot the graphical installer simply select the
relevant option from the boot menu. Expert and rescue mode for the graphical
installer can be selected from the «Advanced options» menu. The previously used
boot methods installgui, expertgui and rescuegui can still be used from the
boot prompt which is shown after selecting the «Help» option in the boot menu.

Как и для текстовой программы установки можно добавлять параметры загрузки при
запуске её графической версии.

Примечание

Для графической версии программы установки требуется гораздо больше памяти для
запуска, чем для текстовой программы установки: 810MB. Если памяти
недостаточно, то автоматически будет осуществлён переход на текстовый интерфейс
«newt».

Если количество установленной памяти в системе меньше 780MB, то графическая
программа установки может совсем не запуститься, в то время как загрузка
текстовой программы установки будет работать. При малом количестве памяти в
системе рекомендуется использовать текстовую программу установки с консольным
интерфейсом.

5.2. Лёгкость управления

Some users may need specific support because of e.g. some visual impairment. 
USB braille displays are detected automatically (not serial displays connected
via a serial-to-USB converter), but most other accessibility features have to
be enabled manually. On machines that support it, the boot menu emits beeps
when it is ready to receive keystrokes. It beeps once on BIOS systems, and
beeps twice on UEFI systems. Some boot parameters can then be appended to
enable accessibility features (see also Раздел 5.1.5, «Экран запуска»). Note
that on most architectures the boot loader interprets your keyboard as a QWERTY
keyboard.

5.2.1. Пользовательский интерфейс программы установки

Программа установки Debian поддерживает несколько пользовательских интерфейсов
для задания вопросов с различной степенью удобства управления: в частности, в
text используется простой текст, в newt используется текстовые
псевдографические окна. Выбор можно сделать в приглашении к загрузке, смотрите
документацию на DEBIAN_FRONTEND в Раздел 5.3.2, «Параметры программы установки
Debian».

With the newt front-end (used mostly with braille), one mostly just selects
answers with arrow keys and presses Enter to validate the choice. Pressing Tab
or Shift - Tab allows to switch between dialog elements, and notably to access
the Go Back button, which brings back again to previous questions. Some dialogs
contain check boxes, which can be ticked on and off by pressing Space.

With the text front-end (used mostly with speech), one mostly selects answers
either by typing their number followed by pressing Enter, or by selecting an
answer with arrow keys, and pressing Enter to validate the choice. One can also
not type anything and just press Enter to simply accept the default value.
Typing < and pressing Enter brings back again to previous questions. When a
selection of choices has to be made (e.g. during task selection), one can type
! to express an empty selection.

5.2.2. USB-дисплеи Брайля

USB-дисплеи Брайля должны определяться автоматически. Будет выбрана программа
установки с текстовым интерфейсом, а в устанавливаемую систему будет
автоматически добавлена поддержка дисплея Брайля. Вы можете просто нажать Enter
в загрузочном меню. После того, как запустится brltty, вы сможете выбрать
таблицу Брайля в меню параметров. Список клавиатурных комбинаций для устройств
Брайля доступен на веб-сайте brltty.

5.2.3. Дисплеи Брайля, подключаемые к последовательному порту

Дисплеи Брайля, подключаемые к последовательному порту, невозможно определить
автоматически (так как это может привести к их поломке). Поэтому вам нужно
добавить параметр загрузки brltty=драйвер,порт, чтобы указать brltty, какой
драйвер и порт нужно использовать. Часть драйвер нужно заменить на
двух-буквенный код вашего терминала (см. в руководстве по BRLTTY). Часть порт
нужно заменить на имя устройства последовательного порта, к которому подключён
дисплей, по умолчанию используется ttyS0, а при использовании конвертера
serial-to-USB обычно указывается ttyUSB0. Можно указать третий параметр -- для
выбора имени используемой таблицы Брайля (смотрите в руководстве по BRLTTY); по
умолчанию используется английская таблица. Заметим, что таблицу можно изменить
позже в меню параметров. Также есть четвёртый параметр, использующийся для
передачи параметров драйверу Брайля,например, protocol=foo; это нужно очень
немногим моделям. Список клавиатурных комбинаций для устройств Брайля доступен
на веб-сайте brltty.

5.2.4. ПО речевого синтеза

Support for software speech synthesis is available on all installer images
which have the graphical installer, i.e. all netinst and DVD images, and the
netboot gtk variant. It can be activated by selecting it in the boot menu by
typing s Enter. The textual version of the installer will then be automatically
selected, and support for software speech synthesis will be automatically
installed on the target system.

If several sound cards are detected, you will be prompted to press Enter when
you hear speech from the desired sound card.

Первый вопрос (о языке) произносится на английском, а весь остальной процесс
установки озвучивается на выбранном языке (если он доступен в espeak).

По умолчанию скорость произношения относительно медленна. Чтобы было быстрее,
нажмите CapsLock+6. Для замедления нажмите CapsLock+5. По умолчанию выбирается
средняя громкость. Чтобы сделать громче, нажмите CapsLock+2. Чтобы сделать
тише, нажмите CapsLock+1. Подробней о клавиатурных комбинациях читайте в
руководстве по использованию речи. Чтобы воспользоваться ответом по умолчанию
просто нажмите в приглашении Enter. Чтобы указать пустой ответ на вопрос,
введите в приглашении !. Чтобы вернуться в предыдущему вопросу введите в
приглашении <.

5.2.5. Устройства речевого синтеза

Support for hardware speech synthesis devices is available on all installer
images which have the graphical installer, i.e. all netinst and DVD images, and
the netboot gtk variant. You thus need to select a «Graphical install» entry in
the boot menu.

Устройства речевого синтеза не определяются автоматически. Вам нужно добавить
параметр загрузки speakup.synth=драйвер, чтобы указать speakup, какой драйвер
нужно использовать. Часть драйвер нужно заменить на код драйвера вашего
устройства (см. в список драйверов). После его указания будет автоматически
выбран текстовый интерфейс программы установки, а в устанавливаемую систему
будет автоматически добавлена поддержка устройств речевого синтеза.

5.2.6. Встраиваемые устройства

Некоторые устройства облегчения управления представляют собой платы, которые
устанавливаются внутрь компьютера и читают текст напрямую из видеопамяти. Чтобы
они смогли работать, нужно выключить использование фрейм-буфера с помощью
загрузочного параметраvga=normal nomodeset. Однако, это сократит количество
доступных языков установки.

Если желательно активировать текстовую версию системного загрузчика до
добавления загрузочного параметра, то введите h Enter.

5.2.7. Тема с высокой контрастностью

For users with low vision, the installer can use a high-contrast color theme
that makes it more readable. To enable it, you can use the «Accessible high
contrast» entry from the boot screen with the d shortcut, or append the theme=
dark boot parameter.

5.2.8. Увеличение

Для пользователей с плохим зрением графическая программа установки частично
поддерживает увеличение: комбинациями Control++ и Control+- увеличивается и
уменьшается размер шрифта.

5.2.9. Экспертная установка, режим восстановления и автоматизированная
установка

При выборе экспертной установки, режима восстановления и автоматизированной
установкитакже доступны специальные возможности. Чтобы получить к ним доступ,
сначала войдите в подменю «Advanced options» из загрузочного меню нажав a. Если
используется система с BIOS (загрузочное меню подаёт один звуковой сигнал),
после этого нужно нажать Enter ; для систем с UEFI (загрузочное меню подаёт два
звуковых сигнала) этого делать не нужно. Затем, чтобы включить речевой синтез
можно нажать s (после чего опять нужен Enter для систем с BIOS, и не нужен в
системах с UEFI). Здесь можно использовать следующие короткие команды: x --
экспертная установка, r -- режим восстановления, a -- автоматизированная
установка. После каждой команды нужен Enter, если система использует BIOS.

Выбор автоматизированной установки позволяет установить Debian полностью
автоматически с помощью списка ответов, источник которых можно быть задан после
включения специальных возможностей. Сама автоматизация описана в Приложение B, 
Автоматическая установка с помощью списка ответов.

5.2.10. Специальные возможности установленной системы

Документация по специальным возможностям установленной системы доступна на
вики-странице специальных возможностей Debian.

5.3. Параметры загрузки

Параметры загрузки -- это параметры ядра Linux, которые обычно используются для
того, чтобы указать присутствующие периферийные устройства. В большинстве
случаев ядро может определить периферийные устройства автоматически. Однако,
иногда вы должны немного помочь ядру.

Если вы в первый раз загружаете систему, попробуйте параметры загрузки по
умолчанию (то есть не пытайтесь их изменять) и посмотрите, корректно ли всё
работает. Скорее всего, так оно и будет. Если нет, вы сможете позже
перезагрузиться и поискать специальные параметры, которые помогут системе
определить аппаратуру вашего компьютера.

Информацию о многих параметрах загрузки можно найти в Linux BootPrompt HOWTO,
где можно найти советы советы и по нераспознанному оборудованию. В этом разделе
содержатся только краткие сведения о наиболее важных параметрах. Некоторые
распространённые ошибки включены ниже в Раздел 5.4, «Диагностика проблем
процесса установки».

5.3.1. Boot serial console

If you are booting with a serial console, generally the kernel will autodetect
this. If you have a videocard (framebuffer) and a keyboard also attached to the
computer which you wish to boot via serial console, you may have to pass the
console=device argument to the kernel, where device is a serial device of the
target, which is usually something like ttyS0.

Вам может потребоваться указать параметры последовательного порта, такие как
скорость и чётность, например console=ttyS0,9600n8; другие возможные скорости:
57600 или 115200. Проверьте, что указали этот параметр после «---», так как он
копируется в настройку системного загрузчика (bootloader) устанавливаемой
системы (если это поддерживается программой установки для системного
загрузчика).

Чтобы тип терминала точно совпал с типом эмулятора терминала, запускаемого
программой установки, можно добавить параметр TERM=тип. Заметим, что программа
установки поддерживает только следующие типы терминалов: linux, bterm, ansi,
vt102 и dumb. По умолчанию для последовательного порта в debian-installer
используется vt102. Если вы используете консоль IPMI или виртуальную среду,
например QEMU/KVM, которая сама не производит преобразование между типами
терминалов, то можете запустить её внутри сеанса screen. При этом выполняется
преобразование в тип терминала screen, который очень похож на vt102.

5.3.2. Параметры программы установки Debian

Система установки анализирует некоторые дополнительные параметры загрузки^[3],
что может быть полезно.

Некоторые параметры имеют «сокращённую форму записи», что помогает избежать
ограничений параметров командной строки ядра и облегчает ввод параметров. Если
у параметра есть сокращённая форма, то она даётся в скобках после (обычной)
длинной формы. В примерах руководства также используется сокращённая форма.

debconf/priority (priority)

    Этот параметр задаёт низший приоритет отображаемых сообщений.

    Значение по умолчанию равно priority=high. Это означает, что будут показаны
    сообщения с высоким и с критическим приоритетами, а сообщения со средним и
    низким приоритетами будут пропущены. В случае возникновения проблем,
    программа установки подстраивает значение приоритета.

    Если вы добавите priority=medium в качестве параметра загрузки, то увидите
    меню программы установки и получите больший контроль над установкой. При
    использовании priority=low показываются все сообщения (эквивалентно методу
    загрузки expert). Если указать priority=critical, то система установки
    будет показывать только критические сообщения и попробует всё сделать
    правильно самостоятельно.

DEBIAN_FRONTEND

    Этот параметр загрузки контролирует тип пользовательского интерфейса,
    используемого программой установки. Возможные на текущий момент значения
    параметра:

      ☆ DEBIAN_FRONTEND=noninteractive

      ☆ DEBIAN_FRONTEND=text

      ☆ DEBIAN_FRONTEND=newt

      ☆ DEBIAN_FRONTEND=gtk

    По умолчанию выбран тип DEBIAN_FRONTEND=newt. Для установки через консоль
    на последовательном порту наиболее предпочтителен DEBIAN_FRONTEND=text.
    Некоторые специализированные установочные носители могут предлагать
    ограниченный список интерфейсов, но newt и text доступны в большинстве из
    них. На архитектурах, для которых есть поддержка, используется графический
    интерфейс программы установки gtk.

BOOT_DEBUG

    Присвоение этому загрузочному параметру значения 2 приводит к более
    подробному протоколированию процесса загрузки программы установки. Значение
    3 приводит к запуску интерпретатора командной строки в наиболее важных
    точках процесса загрузки. (Завершение работы с интерпретатором приводит к
    продолжению процесса загрузки.)

    BOOT_DEBUG=0

        Значение по умолчанию.

    BOOT_DEBUG=1

        Подробней чем обычно.

    BOOT_DEBUG=2

        Много отладочной информации.

    BOOT_DEBUG=3

        В различных точках процесса загрузки будет вызван интерпретатор
        командной строки, чтобы разрешить детальную отладку. При выходе из
        интерпретатора загрузка продолжится.

log_host, log_port

    Используется для указания программе установки отправлять сообщения
    протокола кроме локального файла ещё и удалённой службе syslog на указанный
    узел и порт. Если не задано, то портом по умолчанию является стандартный
    514-й порт syslog.

lowmem

    Используется для указания программе установки выставить для lowmem больший
    уровень, чем это рассчитывается по умолчанию исходя из количества доступной
    памяти. Возможные значения 1 и 2. Смотрите также Раздел 6.3.1.1,
    «Определение доступной памяти / режим с малым потреблением памяти».

noshell

    Указывает программе установки не запускать интерактивную оболочку на tty2 и
    tty3. Полезно при автоматизированной установке, где ограничена физическая
    безопасность.

debian-installer/framebuffer (fb)

    Чтобы предложить установку на нескольких языках на некоторых архитектурах
    используется фрейм-буфер ядра. Если работа через фрейм-буфер вызывает
    проблемы на вашей системе, можно выключить его параметром vga=normal
    nomodeset. Симптомы проблемы -- сообщения об ошибках bterm или bogl, пустой
    экран или замирание на несколько минут в начале установки.

debian-installer/theme (theme)

    A theme determines how the user interface of the installer looks (colors,
    icons, etc.). Which themes are available may differ per frontend. Currently
    both the newt and gtk frontend have (apart from the default look) only one
    additional theme named «dark» theme, which was designed for visually
    impaired users. Set this theme by booting with theme=dark (there is also
    the keyboard shortcut d for this in the boot menu).

netcfg/disable_autoconfig

    По умолчанию, debian-installer автоматически пытается настроить сеть через
    IPv6 autoconfiguration и DHCP. Если получение адреса прошло успешно, у вас
    не будет шанса пересмотреть и изменить полученные настройки. Вы сможете
    настроить сеть вручную только в случае ошибок при получении параметров
    автоматически.

    Если в вашей локальной сети есть маршрутизатор IPv6 или DHCP сервер, но вы
    не хотите их использовать, потому что они, например, даёт неправильные
    ответы, то можете указать параметр netcfg/disable_autoconfig=true, чтобы
    отключить настройку сети (v4 и v6) и ввести информацию вручную.

hw-detect/start_pcmcia

    Установите в false, чтобы избежать запуска служб PCMCIA, если это вызывает
    проблемы. Особенно полезно для некоторых ноутбуков.

preseed/url (url)

    Задайте url для загрузки файла с настройками и использования автоматической
    установки. Смотрите Раздел 4.6, «Автоматическая установка».

preseed/file (file)

    Укажите путь к файлу для загрузки настроек автоматической установки.
    Смотрите Раздел 4.6, «Автоматическая установка».

preseed/interactive

    Установка в true включает отображение всех вопросов, даже для которых есть
    автоматизированный ответ. Может оказаться полезным при отладке или
    тестировании файла ответов. Заметим, что это не действует на параметры,
    указанные в приглашении к загрузке, для работы с ними используется
    специальный синтаксис. Смотрите Раздел B.5.2, «Использование автоматической
    установки для изменения значений по умолчанию».

auto-install/enable (auto)

    Отложить вопросы, которые обычно задаются перед автоматической установкой,
    которые можно задать после настройки сети. Подробней об автоматизации
    установки смотрите в Раздел B.2.3, «Автоматический режим».

finish-install/keep-consoles

    При установке с консоли на последовательном порту обычные виртуальные
    консоли (VT1-VT6) выключаются в /etc/inittab. Если установить в значение
    true, то этого не случится.

cdrom-detect/eject

    By default, before rebooting, debian-installer automatically ejects the
    optical media used during the installation. This can be unnecessary if the
    system does not automatically boot off such media. In some cases it may
    even be undesirable, for example if the optical drive cannot reinsert the
    media itself and the user is not there to do it manually. Many slot
    loading, slim-line, and caddy style drives cannot reload media
    automatically.

    Чтобы запретить автоматическое извлечение задайте значение false, но
    проверьте, что система не загружается автоматически с компакт-диска после
    начальной установки.

base-installer/install-recommends (recommends)

    Если назначить данному параметру значение false, то это отключит в системе
    управления пакетами установку «Рекомендуемых» пакетов, как во время
    установки так и в установленной системе.

    Заметим, что этот параметр позволяет получить более отточенную систему, но
    это также может привести к отсутствию некоторых возможностей, которые вы
    рассчитывали получить. Для получения дополнительных возможностей вы можете
    установить некоторые рекомендуемые пакеты вручную. Поэтому этот параметр
    должен использоваться только очень опытными пользователями.

debian-installer/allow_unauthenticated

    По умолчанию программа установки требует, чтобы репозитории
    аутентифицировались с помощью известного ключа gpg. Установка в true
    выключает данную аутентификацию. Предупреждение: это небезопасно,
    рекомендуется не делать этого.

rescue/enable

    Установка в true активирует режим восстановления, вместо обычного режима
    установки. Смотрите Раздел 8.6, «Восстановление неработающей системы».

5.3.3. Использование параметров загрузки для ответов на вопросы

За некоторым исключением, в приглашении к загрузке можно задать любые значения
ответов на вопросы установки, хотя это полезно только в специфических случаях.
Описание как это делать можно найти в Раздел B.2.2, «Использование параметров
загрузки для автоматизации». Некоторые специальные примеры даны ниже.

debian-installer/language (language), debian-installer/country (country), 
debian-installer/locale (locale)

    Есть два способа указать язык, страну и локаль, используемую при установки
    и в установленной системе.

    Первый и самый простой -- передать только параметр locale. Для языка и
    страны будет использовано вычисленное значение. Например, вы можете
    использовать locale=de_CH.UTF-8 для выбора немецкого языка и Швейцарии в
    качестве страны (в установленной системе по умолчанию будет использована
    локаль de_CH.UTF-8 ). Этот способ имеет ограничения по комбинациям языка,
    страны и локали.

    Второй, более гибкий способ -- отдельно указать язык и страну. В этом
    случае locale можно задать дополнительно для выбора специфичной локали по
    умолчанию для установленной системы. Пример: language=en country=DE locale=
    en_GB.UTF-8.

anna/choose_modules (modules)

    Может использоваться для автоматической загрузки компонент программы
    установки, которые не загружаются по умолчанию. В качестве примеров
    дополнительных полезных компонент, можно привести openssh-client-udeb (для
    того, чтобы во время установки можно было использовать команду scp) и
    ppp-udeb (на настройки PPPoE).

netcfg/disable_autoconfig

    Установите в true, если хотите выключить IPv6 autoconfiguration и DHCP и
    задать настройки сети статически.

mirror/protocol (protocol)

    По умолчанию, программа установки использует протокол http для загрузки
    файлов с серверов-зеркал Debian, и изменить его на ftp невозможно при
    установке с обычным приоритетом. Установив этот параметр равным ftp, вы
    можете заставить программу установки использовать этот протокол. Заметим,
    что вы не сможете выбрать сервер-зеркало ftp из списка, вам придётся
    вводить имя вручную.

tasksel:tasksel/first (tasks)

    Может быть использована для выбора задач, которых нет в списке выбора в
    программе установки, например задача kde-desktop. Подробней смотрите в
    Раздел 6.3.6.2, «Выбор и установка программного обеспечения».

5.3.4. Передача параметров модулям ядра

Если драйверы встроены в ядро, вы можете передать им параметры как это описано
в документации к ядру. Если же драйверы собраны как модули и так как модули
ядра загружаются немного по-другому чем при загрузке установленной системы,
невозможно передать параметры модулям обычным способом. Вместо этого вам нужно
использовать специальный синтаксис, распознаваемый программой установки,
которая сохраняет эти параметры в нужные конфигурационные файлы, для того чтобы
использовать их при загрузке модуля. Параметры также будут автоматически
включены в конфигурацию установленной системы.

Заметим, что теперь редко требуется указывать параметры модулям. В большинстве
случаев ядро способно само определить имеющееся оборудование в системе и
настроить его правильно. Однако иногда всё ещё может потребоваться установка
параметров вручную.

Синтаксис установки параметров модулей:

имя_модуля.имя_параметра=значение

Если требуется передать несколько параметров одному или разным модулям, то
выражение повторяют. Например, чтобы указать старым сетевым картам 3Com
использовать BNC (коаксиальный) разъём и IRQ 10, вы должны написать:

3c509.xcvr=3 3c509.irq=10

5.3.5. Внесение модулей ядра в чёрный список

Иногда бывает необходимо внести модуль в чёрный список, чтобы предотвратить его
автоматическую загрузку ядром и udev. Одной из причин для этого может быть то,
что этот модуль неправильно работает с вашим оборудованием. Также, иногда ядро
имеет два разных драйвера для одного устройства. Это может приводить к
неправильной работе устройства при конфликте драйверов, или если сперва
загружается неправильный драйвер.

Чтобы внести модуль в чёрный список используйте следующий синтаксис:
module_name.blacklist=yes. Это поместит модуль в чёрный список в файле /etc/
modprobe.d/blacklist.local на время установки и в установленной системе.

Заметим, что модуль всё ещё может загружаться самой системой установки. Чтобы
этого избежать, запустите установку в экспертном режиме и снимите выделение с
модуля в списке модулей, отображаемого во время шага обнаружения оборудования.

5.4. Диагностика проблем процесса установки

5.4.1. Reliability of optical media

Sometimes, especially with older drives, the installer may fail to boot from an
optical disc. The installer may also -- even after booting successfully from
such disc -- fail to recognize the disc or return errors while reading from it
during the installation.

Такие проблемы могут возникать по разным причинам. Мы можем описать только
общие из них и предложить общие решения. Остальное зависит от вас.

Есть несколько простых вещей, которые вы можете попробовать сделать в первую
очередь.

  • If the disc does not boot, check that it was inserted correctly and that it
    is not dirty.

  • If the installer fails to recognize the disc, try just running the option 
    Detect and mount installation media a second time. Some DMA related issues
    with very old CD-ROM drives are known to be resolved in this way.

If this does not work, then try the suggestions in the subsections below. Most,
but not all, suggestions discussed there are valid for CD-ROM and DVD.

If you cannot get the installation working from optical disc, try one of the
other installation methods that are available.

5.4.1.1. Общие причины

  • Некоторые старые приводы CD-ROM не поддерживают чтение с дисков, которые
    были записаны на высоких скоростях в современных устройствах записи CD.

  • Некоторые очень старые приводы CD-ROM работают неправильно, если включён «
    прямой доступ к памяти» (DMA).

5.4.1.2. Как изучать и может быть решить проблему

If the optical disc fails to boot, try the suggestions listed below.

  • Check that your BIOS/UEFI actually supports booting from optical disc (only
    an issue for very old systems) and that booting from such media is enabled
    in the BIOS/UEFI.

  • If you downloaded an iso image, check that the md5sum of that image matches
    the one listed for the image in the MD5SUMS file that should be present in
    the same location as where you downloaded the image from.

    $ md5sum debian-testing-i386-netinst.iso
    a20391b12f7ff22ef705cee4059c6b92  debian-testing-i386-netinst.iso

    Next, check that the md5sum of the burned disc matches as well. The
    following command should work. It uses the size of the image to read the
    correct number of bytes from the disc.

    $ dd if=/dev/cdrom | \
    > head -c `stat --format=%s debian-testing-i386-netinst.iso` | \
    > md5sum
    a20391b12f7ff22ef705cee4059c6b92  -
    262668+0 records in
    262668+0 records out
    134486016 bytes (134 MB) copied, 97.474 seconds, 1.4 MB/s

If, after the installer has been booted successfully, the disc is not detected,
sometimes simply trying again may solve the problem. If you have more than one
optical drive, try changing the disc to the other drive. If that does not work
or if the disc is recognized but there are errors when reading from it, try the
suggestions listed below. Some basic knowledge of Linux is required for this.
To execute any of the commands, you should first switch to the second virtual
console (VT2) and activate the shell there.

  • Переключитесь в VT4 или посмотрите файл /var/log/syslog (в качестве
    редактора используется nano), чтобы найти сообщения о специфических
    ошибках. После этого также проверьте вывод команды dmesg.

  • Check in the output of dmesg if your optical drive was recognized. You
    should see something like (the lines do not necessarily have to be
    consecutive):

    ata1.00: ATAPI: MATSHITADVD-RAM UJ-822S, 1.61, max UDMA/33
    ata1.00: configured for UDMA/33
    scsi 0:0:0:0: CD-ROM            MATSHITA DVD-RAM UJ-822S  1.61 PQ: 0 ANSI: 5
    sr0: scsi3-mmc drive: 24x/24x writer dvd-ram cd/rw xa/form2 cdda tray
    cdrom: Uniform CD-ROM driver Revision: 3.20

    If you don't see something like that, chances are the controller your drive
    is connected to was not recognized or may be not supported at all. If you
    know what driver is needed for the controller, you can try loading it
    manually using modprobe.

  • Check that there is a device node for your optical drive under /dev/. In
    the example above, this would be /dev/sr0. There should also be a /dev/
    cdrom.

  • Use the mount command to check if the optical disc is already mounted; if
    not, try mounting it manually:

    $ mount /dev/hdc /cdrom

    Check if there are any error messages after that command.

  • Check if DMA is currently enabled:

    $ cd /proc/ide/hdc
    $ grep using_dma settings
    using_dma      1       0       1       rw

    A «1» in the first column after using_dma means it is enabled. If it is,
    try disabling it:

    $ echo -n "using_dma:0" >settings

    Make sure that you are in the directory for the device that corresponds to
    your optical drive.

  • If there are any problems during the installation, try checking the
    integrity of the installation media using the option near the bottom of the
    installer's main menu. This option can also be used as a general test if
    the disc can be read reliably.

5.4.2. Настройка загрузки

Если у вас возникли проблемы и ядро падает во время загрузки, не распознает
имеющуюся периферию или неправильно распознаются диски, сперва проверьте
параметры загрузки, как это обсуждается в Раздел 5.3, «Параметры загрузки».

В некоторых случаях, неисправность может быть вызвана отсутствием
микропрограммы устройства (смотрите Раздел 2.2, «Устройства, которым требуются
микропрограммы» и Раздел 6.4, «Загрузка отсутствующих микропрограмм»).

5.4.3. ПО речевого синтеза

Если ПО речевого синтеза не работает, то, вероятно, есть проблемы со звуковой
картой -- обычно из-за того, что в программе установки отсутствует нужный
драйвер, или в нём используется необычные названия регулировок громкости,
которые по умолчанию выключают звук. Вам нужно отправить сообщение об ошибке,
добавив результат вывода следующих команд, запущенных на этой машине из системы
Linux, в которой точно работает звук (например, загрузившись с live-CD).

  • dmesg

  • lspci

  • lsmod

  • amixer

5.4.4. Распространённые проблемы установки на 64-bit PC

Есть некоторое количество распространённых проблем установки, которые можно
решить или избежать с помощью передачи параметров загрузки программе установки.

Если во время загрузки ядра экран выглядит странно, например, он полностью
белый, чёрный или замусорен разными цветами, то ваша система, вероятно, имеет
проблемную видеокарту, которая неправильно переключается в режим фрейм-буфера.
В этом случае, вы можете попробовать указать параметр загрузки vga=normal
nomodeset, чтобы выключить фрейм-буфер на консоли. Из-за ограничений консоли
установка будет доступна только на нескольких языках. Подробней см. Раздел 5.3,
«Параметры загрузки».

5.4.4.1. Система подвисает во время настройки PCMCIA

Про некоторые очень старые модели ноутбуков Dell известно, что они виснут когда
при определении PCMCIA устройства производится попытка доступа по некоторым
аппаратным адресам. Похожие проблемы могут иметь и другие ноутбуки. Если у вас
возникла такая проблема и вам не нужна поддержка PCMCIA во время установки, то
вы можете выключить PCMCIA с помощью параметра загрузки hw-detect/start_pcmcia=
false. После установки вы сможете настроить PCMCIA, исключив диапазон ресурсов,
с которым возникают проблемы.

Другой вариант: вы можете загрузить программу установки в экспертном режиме.
Вас попросят указать диапазон ресурсов, который используется аппаратным
обеспечением. Например, если у вас один из ноутбуков Dell, упомянутых выше, то
вы должны ввести exclude port 0x800-0x8ff. Также, есть список распространённых
диапазонов ресурсов в System resource settings section of the PCMCIA HOWTO.
Заметим, что при вводе значений в программу установки вы не должны указывать
запятых, если они есть.

5.4.5. Интерпретация загрузочных сообщений ядра

Во время загрузки вы можете увидеть много сообщений вида can't find что-то или
что-то not present, can't initialize что-то или даже this driver release
depends on чего-то . Большинство этих сообщений безвредны. Вы видите их потому
что устанавливаемое ядро собрано так, чтобы запускаться на компьютерах с самыми
различными периферийными устройствами. Очевидно, ни один компьютер не может
содержать все доступные устройства, так что операционная система может немного
пожаловаться во время поиска периферии, которой у вас нет. Также, вы можете
заметить, что система иногда замирает. Это случается из-за ожидания ответа от
устройства, которого нет в вашей системе. Если вы посчитаете, что загрузка
системы занимает недопустимо долгое время, вы можете позже создать собственное
ядро (смотрите Раздел 8.5, «Сборка нового ядра»).

5.4.6. Сообщение о проблемах при установке

If you get through the initial boot phase but cannot complete the install, the
menu option Save debug logs may be helpful. It lets you store system error logs
and configuration information from the installer on a storage medium, or
download them using a web browser. This information may provide clues as to
what went wrong and how to fix it. If you are submitting a bug report, you may
want to attach this information to the bug report.

Другие сообщения, имеющие отношение к установке, можно найти в /var/log/ во
время установки, и в /var/log/installer/ после того, как компьютер загрузит
установленную систему.

5.4.7. Отправка отчётов об ошибках установки

If you still have problems, please submit an installation report (in English
please, whenever possible). We also encourage installation reports to be sent
even if the installation is successful, so that we can get as much information
as possible on the largest number of hardware configurations.

Заметим, что отчёт об установке будет опубликован в системе отслеживания ошибок
Debian (BTS) и переслан в открытый список рассылки. Проверьте, что вы
используете адрес электронной почты, который не жалко опубликовывать.

Если система Debian заработала, самый простой путь отправки отчёта об установке
-- установить пакеты installation-report и reportbug (apt install
installation-report reportbug), настроить reportbug, как это описывается в
Раздел 8.4.2, «Отправка почты из системы» и запустить команду reportbug
installation-reports.

Alternatively you can use this template when filling out installation reports,
and file the report as a bug report against the installation-reports pseudo
package, by sending it to <submit@bugs.debian.org>.

Package: installation-reports

Boot method: <How did you boot the installer? CD/DVD? USB stick? Network?>
Image version: <Full URL to image you downloaded is best>
Date: <Date and time of the install>

Machine: <Description of machine (eg, IBM Thinkpad R32)>
Processor:
Memory:
Partitions: <df -Tl will do; the raw partition table is preferred>

Output of lspci -knn (or lspci -nn):

Base System Installation Checklist:
[O] = OK, [E] = Error (please elaborate below), [ ] = didn't try it

Initial boot:           [ ]
Detect network card:    [ ]
Configure network:      [ ]
Detect media:           [ ]
Load installer modules: [ ]
Detect hard drives:     [ ]
Partition hard drives:  [ ]
Install base system:    [ ]
Clock/timezone setup:   [ ]
User/password setup:    [ ]
Install tasks:          [ ]
Install boot loader:    [ ]
Overall install:        [ ]

Comments/Problems:

<Description of the install, in prose, and any thoughts, comments
      and ideas you had during the initial install.>

Please make sure that any installation logs that you think would
be useful are attached to this report. (You can find them in the installer
system in /var/log/ and later on the installed system under
/var/log/installer.) Please compress large files using gzip.


In the bug report, describe what the problem is, including the last visible
kernel messages in the event of a kernel hang. Describe the steps that you did
which brought the system into the problem state.


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[3] Текущие ядра (2.6.9 и новее) позволяют использовать 32 параметра в
командной строке и 32 переменные среды. Если это количество превышено, то ядро
попадает в режим паники. Также есть ограничение на 255 символов на всю длину
командной строки, всё что свыше просто обрезается.

Глава 6. Использование программы установки Debian

Содержание

6.1. Как работает программа установки
    6.1.1. Использование программы установки с графическим интерфейсом
6.2. Описание компонент
6.3. Применение отдельных компонент
    6.3.1. Настройка программы установки Debian и оборудования
    6.3.2. Добавление пользователей и паролей
    6.3.3. Настройка времени и часового пояса
    6.3.4. Разметка разделов и выбор точек монтирования
    6.3.5. Установка базовой системы
    6.3.6. Установка дополнительного программного обеспечения
    6.3.7. Установка и настройка системного загрузчика
    6.3.8. Завершение установки
    6.3.9. Устранение проблем
    6.3.10. Installation over network-console
6.4. Загрузка отсутствующих микропрограмм
    6.4.1. Подготовка носителя
    6.4.2. Микропрограмма в установленной системе
    6.4.3. Completing the Installed System
6.5. Customization
    6.5.1. Installing an alternative init system

6.1. Как работает программа установки

For this architecture the debian-installer supports two different user
interfaces: a graphical one and a text-based one. The graphical interface is
used by default unless you select an «Install» option in the boot menu. For
more information about booting the graphical installer, please refer to
Раздел 5.1.6, «Программа установки с графическим интерфейсом».

Программа установки Debian состоит из нескольких специализированных компонент,
предназначенных для выполнения определённых задач установки. Каждая компонента
выполняет свою задачу, задавая пользователю вопросы, если это необходимо для
выполнения работы. Каждому вопросу назначен приоритет, и можно задать приоритет
задаваемых вопросов при старте программы установки.

Когда выполняется установка по умолчанию, задаются только самые важные
(высокоприоритетные) вопросы. Результатом будет полностью автоматизированный
процесс установки с небольшим вмешательством пользователя. Компоненты
автоматически запускаются в определённой последовательности; какая компонента
будет запущена, зависит, в основном, от выбранного метода установки и от
имеющегося оборудования. Программа установки будет использовать значения по
умолчанию для вопросов, которые не задавались.

При возникновении проблемы, пользователь увидит экран с ошибкой и, возможно,
меню программы установки предложит выбрать какое-нибудь альтернативное
действие. Если же проблем нет, пользователь никогда не увидит меню программы
установки, а просто будет отвечать на вопросы каждой компоненты. Извещениям о
серьёзных ошибках установлен приоритет «критический», так что пользователь
всегда будет оповещён.

Некоторые параметры по умолчанию, используемые программой установки, можно
изменить передав как значения параметров загрузки при старте debian-installer.
Если, например, вы хотите настраивать сеть вручную (по умолчанию используется
IPv6 autoconfiguration и DHCP, если получится), то можете добавить параметр
загрузки netcfg/disable_autoconfig=true. Возможные параметры можно посмотреть в
Раздел 5.3.2, «Параметры программы установки Debian».

Опытным пользователям, возможно, будет более удобен интерфейс управления через
меню, где каждый шаг контролируется пользователем, а не выполняется
автоматически программой установки. Для использования программы установки в
ручном режиме управляемом через меню, добавьте параметр загрузки priority=
medium.

Если ваше оборудование требует передачи параметров модулям ядра при их
установке, нужно запустить программу установки в режиме «эксперта». Это можно
сделать либо введя команду expert для запуска программы установки, либо передав
параметр загрузки priority=low. Режим эксперта дает вам полный контроль над
debian-installer.

In the text-based environment the use of a mouse is not supported. Here are the
keys you can use to navigate within the various dialogs. The Tab or right arrow
keys move «forward», and the Shift+Tab or left arrow keys move «backward»
between displayed buttons and selections. The up and down arrow select
different items within a scrollable list, and also scroll the list itself. In
addition, in long lists, you can type a letter to cause the list to scroll
directly to the section with items starting with the letter you typed and use 
Pg-Up and Pg-Down to scroll the list in sections. The space bar selects an item
such as a checkbox. Use Enter to activate choices.

По некоторым окнам есть дополнительная справочная информация.Если она доступна,
то об этом будет сообщено в нижней строке экрана надписью, что справочная
информация доступна по нажатию клавиши F1.

Сообщения об ошибках и протокол выполнения выводятся на четвёртой консоли. Вы
можете получить доступ к этой консоли, нажав Левый Alt+F4 (удерживайте клавишу 
Alt нажатой во время нажатия функциональной клавиши F4); чтобы вернуться к
основному процессу установки нажмите Левый Alt+F1.

Также эти сообщения можно найти в файле /var/log/syslog. После установки этот
файл копируется в файл /var/log/installer/syslog на новой системе. Остальные
сообщения об установке можно найти в каталоге /var/log/ во время установки и в
/var/log/installer/ после того, как компьютер перезагрузится в установленную
систему.

6.1.1. Использование программы установки с графическим интерфейсом

Графическая версия программы установки работает практически также как и
текстовая, и поэтому это руководство можно использовать для выполнения процесса
установки.

Если вы предпочитаете использовать клавиатуру вместо мыши, есть две вещи,
которые необходимо знать. Чтобы раскрыть свёрнутый список (например, выбор
стран и континентов), вы можете использовать клавиши + и -. Если в вопросе
можно выбрать более одного значения (например, выбор задач), во-первых, вам
нужно перейти на кнопку Continue после окончания выбора; нажимая enter для
переключения выбора, не активировать Continue.

Если есть дополнительная справочная информация, то появляется кнопка Справка.
Справочная информация доступна по нажатию кнопки или клавиши F1.

Чтобы перейти на другую консоль, вам также нужно использовать клавишу Ctrl, как
и в X Window System. Например, чтобы перейти на VT2 (первая оболочка командной
строки для отладки), воспользуйтесь: Ctrl+левый Alt+F2. Сама программа
установки с графическим интерфейсом работает на VT5, так что вы можете
использовать левый Alt+F5 для обратного переключения.

6.2. Описание компонент

Ниже представлен список компонент программы установки с кратким описанием
назначения каждой компоненты. Детали об использовании каждой компоненты можно
найти в Раздел 6.3, «Применение отдельных компонент».

main-menu

    Показывает список компонент пользователю во время работы программы
    установки и запускает компоненту, когда она выбрана. Вопросам main-menu
    установлен средний (medium) приоритет, так что если вы изменили приоритет
    на высокий или критический(по умолчанию высокий), вы не увидите меню. С
    другой стороны, если возникает ошибка, которая требует вмешательства
    пользователя, приоритет вопросов может быть временно понижен, чтобы
    позволить решить проблему, и в этом случае меню может появиться.

    Вы можете добраться до главного меню, многократно нажав кнопку Go Back,
    чтобы пройти весь путь обратно от выполняемой в данный момент компоненты.

localechooser

    Позволяет пользователю указать параметры локализации процесса установки и
    устанавливаемой системы: язык, страну и локали. Программа установки будет
    отображать сообщения на выбранном языке, если есть перевод на этот язык.
    Если перевода сообщения нет, то будет показано сообщение на английском
    языке.

console-setup

    Shows a list of keyboard (layouts), from which the user chooses the one
    which matches his own model.

hw-detect

    Автоматически определяет большую часть аппаратуры системы, включая сетевые
    карты, приводы дисков и PCMCIA.

cdrom-detect

    Looks for and mounts a Debian installation media.

netcfg

    Настраивает сетевые подключения компьютера, чтобы он мог получить доступ к
    Интернет.

iso-scan

    Ищет ISO-образы (файлы .iso files) на жёстких дисках.

choose-mirror

    Предоставляет список серверов-зеркал Debian. Пользователь может выбрать
    источник, из которого будут устанавливаться пакеты.

cdrom-checker

    Checks integrity of installation media. This way, the user may assure him/
    herself that the installation image was not corrupted.

lowmem

    Пытается распознать системы с малым объёмом памяти и затем выполняет
    различные действия, чтобы удалить ненужные части debian-installer из памяти
    (ценой потери некоторых возможностей).

anna

    Anna's Not Nearly APT. Installs packages which have been retrieved from the
    chosen mirror or installation media.

user-setup

    Настраивает пароль суперпользователя и добавляет обычного пользователя.

clock-setup

    Обновляет системные часы и определяет установлены часы по Гринвичу (UTC)
    или нет.

tzsetup

    Выбирает часовой пояс, основываясь на местоположении указанном ранее.

partman

    Позволяет пользователю разметить подключённые к системе диски, создать
    файловые системы на выбранных разделах и назначить им точки монтирования.
    Также обладает интересными возможностями, например, может работать в
    полностью автоматическом режиме и поддерживает LVM. Это предпочтительная
    утилита для работы с разделами в Debian.

partman-lvm

    Помогает пользователю с настройкой LVM (менеджера логических томов).

partman-md

    Позволяет пользователю установить программный RAID (Redundant Array of
    Inexpensive Disks). Программный RAID обычно лучше, чем дешёвые IDE
    (псевдо-аппаратные) RAID-контроллеры в новых материнских платах.

base-installer

    Устанавливает самый минимальный набор пакетов, который позволит компьютеру
    работать под Debian GNU/Linux после перезагрузки.

apt-setup

    Настраивает apt, по большей части автоматически, основываясь на том, с
    какого носителя была запущена программа установки.

pkgsel

    Использует tasksel для выбора и установки дополнительного ПО.

os-prober

    Определяет уже установленные на компьютере операционные системы и передаёт
    эту информацию в bootloader-installer, который может предложить вам
    добавить найденные операционные системы в стартовое меню системного
    загрузчика. Таким образом пользователь может легко выбрать операционную
    систему для запуска в момент загрузки.

bootloader-installer

    The various bootloader installers each install a boot loader program on the
    hard disk, which is necessary for the computer to start up using Linux
    without using a USB stick or CD-ROM. Many boot loaders allow the user to
    choose an alternate operating system each time the computer boots.

shell

    Позволяет пользователю вызвать интерпретатор командной строки из меню или
    на второй консоли.

save-logs

    Provides a way for the user to record information on a USB stick, network,
    hard disk, or other media when trouble is encountered, in order to
    accurately report installer software problems to Debian developers later.

6.3. Применение отдельных компонент

В этом разделе мы подробно опишем каждую компоненту программы установки.
Компоненты собраны в понятные пользователю группы и расположены в порядке
использования во время установки. Обратите внимание, что в зависимости от
метода установки и вашей аппаратуры некоторые модули могут не использоваться.

6.3.1. Настройка программы установки Debian и оборудования

Давайте представим, что программа установки Debian загрузилась и вы видите её
первый экран. В этот момент возможности debian-installer всё ещё немного
ограничены. Она многого не знает о вашем оборудовании, предпочитаемом языке или
даже о задачах, которые она должна выполнить. Не беспокойтесь. Поскольку
debian-installer немножко умная, она может автоматически определить ваше
оборудование, найти свои остальные компоненты и обновить себя до очень умелой
системы установки. Однако, вы должны помочь debian-installer некоторой
информацией, которую она не сможет определить автоматически (например, выбрать
предпочитаемый вами язык, раскладку клавиатуры или необходимый сетевой
сервер-зеркало).

Заметим, что debian-installer выполняет определение оборудования несколько раз
во время установки. На первом этапе определяется оборудование, необходимое для
загрузки компонент программы установки (т.е. ваш CD-ROM или сетевая карта).
Поскольку не все драйверы могут быть доступны во время этого первого запуска,
определение оборудования надо будет повторить позже по ходу установки.

Во время определения оборудования debian-installer проверяет необходимость
загрузки микропрограмм в драйверы устройств. Если микропрограмма требуется, но
недоступна, выводится диалоговое окно, которое позволяет загрузить
отсутствующую микропрограмму со сменного носителя. Подробней см. Раздел 6.4,
«Загрузка отсутствующих микропрограмм».

6.3.1.1. Определение доступной памяти / режим с малым потреблением памяти

Одну из первых вещей, которую делает debian-installer, это проверка размера
доступной памяти. Если размер ограничен, то эта компонента делает некоторые
изменения процесса установки, которые, будем надеяться, позволят установить
Debian GNU/Linux на вашу машину.

Первое, что делается для уменьшения потребления памяти программой установки --
это выключение переводов в интерфейсе, то есть установка будет производится на
английском языке. Конечно, вы сможете выполнить локализацию системы после
завершения установки.

Если этого окажется недостаточно, программа установки дальше станет уменьшать
потребление памяти загружая только компоненты, которые необходимы для
выполнения базовой установки. Это уменьшает функциональность системы установки.
Вам будет предоставлена возможность загрузить дополнительные компоненты
вручную, но вы должны понимать, что каждая выбранная вами компонента использует
память, и это может привести к неудачному завершению установки.

If the installer runs in low memory mode, it is recommended to create a
relatively large swap partition (1-2GB). The swap partition will be used as
virtual memory and thus increases the amount of memory available to the system.
The installer will activate the swap partition as early as possible in the
installation process. Note that heavy use of swap will reduce performance of
your system and may lead to high disk activity.

Несмотря на все старания, система всё равно может повиснуть, могут произойти
неожиданные ошибки или процессы могут быть завершены ядром из-за нехватки
памяти в системе (вы увидите сообщения «Out of memory» на VT4 и в syslog).

Например, были отчёты об установке, что не удавалось создать большую файловую
систему в режиме с малым потреблением памяти, если было недостаточно
пространства подкачки. Если увеличение размера подкачки не помогает, попробуйте
вместо неё создать файловую систему ext2 (которая является обязательной
компонентой программы установки). После установки возможно изменить раздел ext2
на ext3.

Возможно заставить программу установки использовать более высокий уровень для
lowmem чем значение, рассчитываемое из количества доступной оперативной памяти,
с помощью загрузочного параметра «lowmem» как это описано в Раздел 5.3.2,
«Параметры программы установки Debian».

6.3.1.2. Выбор параметров локализации

В большинстве случаев сначала вас попросят указать параметры локализации,
которые будут использованы в программе установки и в устанавливаемой системе. В
параметры локализации входят язык, расположение и локали.

Выбранный язык будет использован в процессе установки, предлагая переводы
различных диалогов если возможно. Если перевод для выбранного языка недоступен,
по умолчанию используется английский язык.

Указанное значение географического расположения (в большинстве случаев --
страны) будет использовано позднее в процессе установки для выбора правильного
часового пояса и подходящего для страны сервера-зеркала Debian. Значения страны
и языка будут использованы вместе для настройки локали вашей системы и выборе
правильной раскладки клавиатуры.

Сначала вас попросят выбрать предпочитаемый язык. Названия языков написаны на
английском(слева) и на самом языке (справа); названия справа также показаны в
правильном написании для этого языка. Список отсортирован по английским
названиям. Вверху списка есть дополнительный пункт, который вместо языка
позволяет выбрать «C» локаль. При выборе «C» локали установка будет
производиться на английском; установленная система не будет иметь поддержку
локализации, так как пакет locales в данном случае установлен не будет.

Далее вас попросят указать географическое расположение. Если вы выбрали язык,
на котором говорят более чем в одной стране^[4], вам будет показан список
только этих стран. Чтобы указать страну не из списка, выберите другая
(последний пункт). Далее вам будет предложен список континентов; при выборе
определённого континента будет показан список стран, которые на нём
расположены.

If the language has only one country associated with it, a list of countries
will be displayed for the continent or region the country belongs to, with that
country selected as the default. Use the Go Back option to select countries on
a different continent.

Примечание

Очень важно выбрать страну вашего проживания или нахождения, так как по ней
определяется часовой пояс, который будет настроен в установленной системе.

Если вы выберете комбинацию языка и страны, для которой нет локали и есть
несколько локалей для этого языка, то программа установки предложит вам выбрать
желаемую локаль по умолчанию для устанавливаемой системы^[5].Во всех других
случаях локаль по умолчанию будет выбрана на основе языка и страны.

В любой выбранной локали по умолчанию, как описано в предыдущем параграфе,
будет использована кодировка символов UTF-8.

Если вы производите установку с низким приоритетом, то вас попросят выбрать
дополнительные локали, включая так называемые «старые» локали^[6] для их
генерации в установленной системе; если вы что-то выберете, то вас попросят
выбрать локаль по умолчанию для устанавливаемой системы.

6.3.1.3. Выбор клавиатуры

Клавиатуры часто приспосабливают к алфавиту определённого языка. Выберите
раскладку, которая подходит к вашей клавиатуре, или выберите наиболее
подходящую, если таковой не имеется. После завершения установки вы сможете
выбрать раскладку из большего количества вариантов (запустите kbd-config с
правами суперпользователя после завершения установки).

Выберите нужную клавиатуру и нажмите Enter. Для перемещения используйте клавиши
стрелок -- они находятся в одном и том же месте во всех национальных
клавиатурных раскладках, поэтому не зависят от конфигурации клавиатуры.

6.3.1.4. Поиск образа ISO программы установки Debian

Если установка производится с помощью метода hd-media, настанет момент, когда
вам нужно будет найти и смонтировать ISO-образ программы установки Debian,
чтобы получить оставшиеся файлы установки. Для этого существует компонента 
iso-scan.

Сначала iso-scan автоматически смонтирует все блочные устройства (например,
разделы и логические тома), на которых есть распознанная файловая система, и
последовательно будет искать на них файлы с именами, оканчивающимися на .iso
(или .ISO, это важно). Обратите внимание, ищутся файлы только в корневом
каталоге и подкаталогах первого уровня (то есть найдутся файлы /имя.iso, /data/
имя.iso, но не /data/tmp/имя.iso). После нахождения iso-образа, iso-scan
проверит его содержимое чтобы выяснить, является ли образ правильным
iso-образом Debian или нет. В первом случае поиск завершается, в последнем 
iso-scan будет искать другой образ.

Если найти ISO-образ с программой установки не удалось, iso-scan спросит,
хотите ли вы чтобы был выполнен более тщательный поиск. В этом случае будет
произведён поиск по всей файловой системе.

Если iso-scan не нашла ISO образ программы установки, перезагрузитесь в
первоначальную операционную систему и проверьте правильность имени (должно
оканчиваться на .iso), если файл находится на распознаваемой debian-installer
файловой системе, и что образ не повреждён (проверьте контрольную сумму).
Опытные пользователи Unix могут это сделать со второй консоли без перезагрузки.

Заметим, что раздел (или диск), хранящий под образ ISO, не может быть
использован во время процесса установки, так как занят программой установки.
Чтобы это обойти, и если у вас есть достаточно системной памяти, то программа
установки может скопировать образ ISO в RAM перед монтированием. Этим управляет
вопрос debconf низкого уровня iso-scan/copy_iso_to_ram (он задаётся, только
если имеется требуемое количество памяти).

6.3.1.5. Настройка сети

Если в начале этого шага система обнаруживает, что имеется более одного
сетевого устройства, то вас попросят указать, какое устройство будет первичным
сетевым интерфейсом, то есть какое устройство будет использовано для установки
системы. Другие интерфейсы останутся ненастроенными. Вы сможете настроить
дополнительные интерфейсы после завершения установки; смотрите страницу
руководства interfaces(5).

6.3.1.5.1. Автоматическая настройка сети

По умолчанию, debian-installer пытается настроить сетевой интерфейс вашего
компьютера автоматически. Если это сделать не удаётся, то это могло произойти
по многим причинам, начиная от не подключённого сетевого кабеля и кончая
неправильной настройкой инфраструктуры автоматической настройки. Для выяснения
причины посмотрите сообщения об ошибках на четвёртой консоли. В любом случае
вас спросят, не хотите ли вы попробовать ещё раз, или хотите выполнить
настройку вручную. Иногда сетевые службы автоматической настройки очень
медленно отвечают, поэтому если вы уверены, что всё в порядке, попробуйте ещё
раз. Если автоматическая настройка завершается с ошибкой постоянно, то вместо
неё выберите настройку сети вручную.

6.3.1.5.2. Настройка сети вручную

При ручной настройке сети вам зададут несколько вопросов о вашей сети, а именно
про IP-адрес, маску сети, шлюз, адреса серверов определения имён и имени
машины. Кроме того, если используется интерфейс беспроводной сети, то вас
попросят ввести личный Wireless ESSID и ключ WEP или ключевую фразу WPA/WPA2.
Введите ответы из Раздел 3.3, «Информация, которая понадобится».

Примечание

Некоторые настройки иногда легко, но не всегда, определить вручную: программа
предполагает, что IP-адрес сети вычисляется с помощью операции побитового И над
IP-адресом системы и маской сети. Широковещательный адрес по умолчанию
вычисляется с помощью операции побитового ИЛИ над IP-адресом системы и
инверсной маской сети. Также угадывается шлюз. Если вы не можете найти
какой-нибудь ответ, используйте предлагаемые системой -- если нужно, вы можете
изменить их сразу после установки системы, отредактировав /etc/network/
interfaces.

6.3.1.5.3. IPv4 и IPv6

Начиная с Debian GNU/Linux 7.0 («Wheezy»), debian-installer также поддерживает
IPv6 (помимо «классического» IPv4). Поддерживаются все комбинации IPv4 и IPv6
(только IPv4, только IPv6 и обе адресации одновременно).

Автоматическая настройка IPv4 выполняется с помощью DHCP (протокола
динамической настройки узла). Автоматическая настройка IPv6 поддерживает
настройку без сохранения состояния (stateless) с помощью NDP (протокол
обнаружения соседей, включающий назначение рекурсивного сервера DNS (RDNSS)),
настройку с сохранением состояния с помощью DHCPv6 и смешанную автоматическую
настройку без сохранения/с сохранением состояния (настройка адреса с помощью
NDP, дополнительные параметры с помощью DHCPv6).

6.3.2. Добавление пользователей и паролей

Перед настройкой часов, программа установки предложит вам настроить учётную
запись «root» и/или учётную запись для первого пользователя. Дополнительные
учётные записи можно будет создать после завершения установки.

6.3.2.1. Установка пароля суперпользователя (root)

Учётная запись root также называемая суперпользовательской -- это учётная
запись, для которой нет никаких преград в вашей системе. Учётная запись root
должна использоваться только для администрирования системы и как можно меньшее
время.

Любой создаваемый вами пароль должен состоять как минимум из 6 символов и
содержать заглавные и строчные буквы, а также знаки препинания. Уделите
побольше внимания при установке пароля root, поскольку эта самая мощная учётная
запись. Избегайте слов из словаря или использования любой персональной
информации, которую можно угадать.

Если кто-то говорит вам, что ему нужен ваш пароль root, будьте очень осторожны.
Обычно нет необходимости давать свой пароль root кому-либо, если только вы не
администрируете машину вместе с другими системными администраторами.

Если здесь вы не зададите пароль пользователю «root», то эта учётная запись
блокируется, но при этом позднее будет установлен пакет sudo, позволяющий
выполнять задачи администрирования в новой системе. По умолчанию, первому
созданному пользователю в системе будет разрешено использовать команду sudo для
получения прав root.

6.3.2.2. Создание учётной записи обычного пользователя

Система спросит вас, желаете ли вы сейчас создать учётную запись для обычного
пользователя. Эта учётная запись должна использоваться в качестве вашей
основной рабочей учётной записи. Вы не должны использовать учётную запись root
в повседневной работе или в качестве персональной учётной записи.

Почему не должны? Одна из причин, по которой следует избегать использования
привилегий root это то, что в качестве root можно очень легко сделать
необратимые повреждения. Другая причина: вас могут обманом заставить запустить
программу троянского коня -- это программа, которая воспользуется
преимуществами ваших возможностей суперпользователя, чтобы скомпрометировать
систему. В любой хорошей книге по системному администрированию Unix эта тема
рассматривается подробно -- прочтите одну из них, если это для вас в новинку.

Сначала вас попросят ввести полное имя пользователя. Затем спросят имя
пользовательской учётной записи; в общем случае, ваше имя или что-то похожее
вполне подойдёт. И, наконец, вас попросят ввести пароль учётной записи.

Если в любой момент после установки вы захотите создать ещё одну учётную
запись, воспользуйтесь командой adduser.

6.3.3. Настройка времени и часового пояса

Сначала программа установки попытается подключиться к серверу времени в
Интернете (по протоколу NTP), чтобы выставить правильное системное время. Если
это не удаётся, то программа установки будет считать правильными время и дату,
полученные с системных часов при загрузке программы установки. В процессе
установки невозможно выставить системное время вручную.

В зависимости от места, выбранного ранее в процессе установки, вам может быть
показан список часовых поясов, возможных в вашей географической точке. Если в
вашей местности только один часовой пояс и вы выполняете установку по
умолчанию, то вопрос задан не будет и система выберет этот часовой пояс.

В экспертном режиме или при установке со средним приоритетом вам будет
предложено выбрать «Универсальное координированное время » (UTC) в качестве
часового пояса.

Если по какой-то причине вы хотите установить часовой пояс для устанавливаемой
системы, который не является правильным в выбранном местонахождении, то есть
два способа сделать это.

 1. Простой способ: выберите другой часовой пояс после завершения установки и
    загрузки в новую систему. Это можно сделать с помощью следующей команды:

    # dpkg-reconfigure tzdata

 2. Второй способ: часовой пояс может быть задан при загрузке программы
    установки с помощью параметра time/zone=значение. Значение должно быть
    правильным часовым поясом, например Europe/London или UTC.

Для автоматизации установки часовой пояс может быть задан в файле ответов.

6.3.4. Разметка разделов и выбор точек монтирования

После того как определение оборудования было выполнено в последний раз,
debian-installer должен быть во всей своей красе, подстроенный под нужды
пользователя и готовый к выполнению кое-какой настоящей работы. Как написано в
заголовке раздела, основной задачей нескольких следующих компонент будет
разметка дисков, создание файловых систем, назначение точек монтирования и,
возможно, настройка RAID, LVM или шифрованных устройств.

Если вы плохо знакомы с процедурой разметки, или просто хотите знать детали
процесса, смотрите Приложение C, Разметка дисков в Debian.

Сначала вам предложат автоматическую разметку или всего диска или только
имеющего на нём свободного места. Это так называемая «направляющая» разметка.
Если вы не хотите использовать авторазметку, выберите в меню Вручную.

6.3.4.1. Поддерживаемые параметры разметки

Программа разметки debian-installer довольно универсальна. Она позволяет
создать много различных схем разметки используя различные таблицы разделов,
файловые системы и расширенные блочные устройства.

Список доступных параметров зависит, в основном, от архитектуры, но есть и
другие факторы. Например, на системах с ограниченной внутренней памятью
доступны не все параметры. Параметры по умолчанию также могут различаться. Тип
таблицы разделов, используемый по умолчанию, может, например, отличаться на
дисках большого объёма по сравнению с дисками малого объёма. Некоторые
параметры можно изменять только при установке со средним или низким приоритетом
debconf; чем выше приоритет, тем более целесообразные настройки по умолчанию
будут использоваться.

Программа установки поддерживает различные виды расширенных настроек и
использование устройств хранения, которые во многих случаях можно использовать
совместно.

  • Управление логическими томами (LVM)

  • Программный RAID

    Поддерживается RAID 0, 1, 4, 5, 6 и 10 уровня.

  • Шифрование

  • Многолучевое устройство (экспериментальная поддержка)

    Смотрите описание в вики. Поддержка многолучевых устройств доступна только
    если её включить при запуске программы установки.

Поддерживаются следующие файловые системы.

  • ext2, ext3, ext4

    В большинстве случаев файловой системой по умолчанию выбирается ext4.

  • jfs (недоступна на всех архитектурах)

  • xfs (недоступна на всех архитектурах)

  • reiserfs (по выбору; недоступна на всех архитектурах)

    Поддержка файловой системы Reiser по умолчанию более недоступна. При
    запуске программы установки со средним или низким приоритетом debconf, её
    можно включить выбрав компонент partman-reiserfs. Поддерживается файловая
    система только третьей версии.

  • qnx4

    Существующие разделы будут распознаны и их можно смонтировать. Создание
    новых разделов с qnx4 не поддерживается.

  • FAT16, FAT32

  • NTFS (только на чтение)

    Существующие разделы NTFS будут распознаны и их можно смонтировать.
    Создание новых разделов с NTFS не поддерживается.

The partitioner accepts units as power-of-ten (1 MB = 1000 kB = 1000000 B), as
well as power-of-two (1 MiB = 1024 kiB = 1048576 B). Unit prefixes are
supported until EB/EiB (exabyte/exbibyte).

6.3.4.2. Направляющая разметка

Если вы выбрали направляющую разметку, то есть два пути: создавать разделы
непосредственно на жёстком диске (классический метод), создавать их с помощью
управления логическими томами (LVM) или создавать, используя LVM с шифрованием^
[7].

Примечание

LVM или LVM с шифрованием может быть недоступно на некоторых архитектурах.

При использовании LVM или LVM c шифрованием, программа установки создаст
большинство разделов внутри одного большого раздела; преимущество этого метода
в том, что у разделов внутри этого большого раздела можно легко изменить
размеры позже. При использовании LVM с шифрованием большой раздел будет
недоступен без специальной ключевой фразы, предоставляя тем самым
дополнительную безопасность вашим (личным) данным.

При использовании шифрованных LVM, программа установки также автоматически
стирает диск, записывая на него произвольные данные. Это способствует усилению
безопасности (так как это делает невозможным определить какие части диска
используются и этим также стираются предыдущие следы установок), но это
занимает некоторое время в зависимости от размера диска.

Примечание

При использовании направляющей разметки с LVM или LVM c шифрованием, перед тем
как приступить к настройке LVM, нужно произвести запись на выбранный диск. Эти
изменения сотрут все имеющиеся данные на выбранном жёстком диске и их больше
нельзя будет восстановить. Однако программа установки перед записью на диск
попросит вас подтвердить выполнение этих изменений.

Если вы выбрали направляющую разметку (или классическую, или использующую LVM
(с шифрованием)) всего диска, то сначала вас попросят выбрать диск, который
нужно использовать. Убедитесь, что предложены все имеющиеся диски, и если их
несколько, правильно укажите нужный. Порядок в списке предлагаемых дисков может
быть отличным от того, какой вы использовали ранее. Идентифицировать диски вам
поможет их показанный размер.

Любые данные на выбранном диске впоследствии будут уничтожены, но перед любой
операцией записи на диск у вас попросят подтверждения. Если выбран классический
метод разметки, то вы можете отменить любые изменения даже в самом конце; при
использовании LVM (с шифрованием) это невозможно.

Next, you will be able to choose from the schemes listed in the table below.
All schemes have their pros and cons, some of which are discussed in
Приложение C, Разметка дисков в Debian. If you are unsure, choose the first
one. Bear in mind that guided partitioning needs a certain minimal amount of
free space to operate with. If you don't give it at least about 3GB of space
(depends on chosen scheme), guided partitioning will fail. Also, on small disks
you will probably not see all of the schemes mentioned below.

┌───────────────────────────────────────────┬───────────────┬─────────────────┐
│              Схема разметки               │  Минимальное  │   Создаваемые   │
│                                           │ пространство  │     разделы     │
├───────────────────────────────────────────┼───────────────┼─────────────────┤
│Все файлы на одном разделе                 │8GB            │/, swap          │
├───────────────────────────────────────────┼───────────────┼─────────────────┤
│Отдельный раздел /home                     │9GB            │/, /home, swap   │
├───────────────────────────────────────────┼───────────────┼─────────────────┤
│Отдельные разделы /home, /var и /tmp       │12GB           │/, /home, /var, /│
│                                           │               │tmp, swap        │
├───────────────────────────────────────────┼───────────────┼─────────────────┤
│Separate /srv and /var partitions; swap    │8GB            │/, /srv, /var,   │
│limited to 1GB (for server)                │               │swap             │
├───────────────────────────────────────────┼───────────────┼─────────────────┤
│Scheme especially for small disks          │3GB            │/, swap          │
└───────────────────────────────────────────┴───────────────┴─────────────────┘

Если вы выбрали направляющую разметку с использованием LVM (с шифрованием), то
программа установки также создаст отдельный раздел /boot. Остальные разделы,
включая раздел подкачки, будут созданы внутри раздела LVM.

Если вы загрузились в режиме EFI, то в направляющей разметке будет создан
дополнительный раздел, отформатированный как загружаемая файловая система
FAT32, под системный загрузчик EFI. Этот раздел называется EFI System Partition
(ESP). Также, в меню форматирования есть дополнительный пункт для ручной
настройки раздела в качестве ESP.

После выбора схемы, следующий экран покажет только что созданную таблицу
разделов, включая информацию будут ли и как форматироваться разделы и куда они
будут смонтированы.

Список разделов может выглядеть так:

  SCSI1 (0,0,0) (sda) - 6.4 GB WDC AC36400L
        #1 primary   16.4 MB  B f ext2       /boot
        #2 primary  551.0 MB      swap       swap
        #3 primary    5.8 GB      ntfs
           pri/log    8.2 MB      FREE SPACE

  SCSI2 (1,0,0) (sdb) - 80.0 GB ST380021A
        #1 primary   15.9 MB      ext3
        #2 primary  996.0 MB      fat16
        #3 primary    3.9 GB      xfs        /home
        #5 logical    6.0 GB    f ext4       /
        #6 logical    1.0 GB    f ext3       /var
        #7 logical  498.8 MB      ext3

Здесь показаны два жёстких диска, разделённые на несколько разделов; на первом
диске осталось немного свободного места. Каждая строка раздела содержит номер
раздела, тип, размер, необязательные флаги, файловую систему и точку
монтирования (если есть). Замечание: такая настройка не может быть создана с
помощью направляющей разметки, это просто пример, созданный с помощью разметки
вручную.

На этом направляющая разметка завершена. Если вам нравится сгенерированная
таблица разделов, то вы можете выбрать Закончить разметку и записать изменения
на диск из меню для создания новой таблицы разделов (как описано в конце этого
раздела). Если результат вам не нравится, то можно выбрать Отменить изменение
разделов и запустить направляющую разметку снова или изменить предложенные
изменения вручную, как описано ниже.

6.3.4.3. Разметка вручную

При ручной разметке появляется похожий экран, за исключением того, что
отображается существующая таблица разделов и нет точек монтирования. Далее
описано как вручную редактировать таблицу разделов и как использовать эти
разделы в Debian.

Если вы выбрали чистый диск, на котором нет ни разделов ни свободного места, то
вам предложат создать новую таблицу разделов (это необходимо для создания новых
разделов). После этого, на выбранном диске должна появиться новая строка «
СВОБОДНОЕ МЕСТО».

Если вы выберете свободное пространство, вам предложат создать новый раздел. Вы
должны ответить на несколько коротких вопросов о размере, типе (первичный или
логический) и местоположении (в начале или конце свободного пространства).
После этого, вам покажут предлагаемые параметры нового раздела. Основным
параметром является Использовать как:, который определяет, будет ли на разделе
файловая система или он будет использован как раздел подкачки, программный
RAID, LVM, будет содержать шифрованную файловую систему или не будет
использован вовсе.Другие настройки задают точку и параметры монтирования, флаг
загрузки; список показываемых параметров зависит от того, как будет
использоваться раздел. Если вам не нравятся значения по умолчанию, измените их
как хотите. Например, в параметре Использовать как:, вы можете выбрать другую
файловую систему, поменять параметры для раздела подкачки, программного RAID,
LVM или совсем его не использовать. Когда вы настроите новый раздел, выберите 
Закончить с разделом и вы вернётесь обратно в главное меню partman.

Если вы решили, что хотите что-то изменить в разделе, просто выберите раздел и
попадёте обратно в меню настройки раздела. Так как это тоже самое меню что и
для создания раздела, вы можете изменить тот же набор параметров. Одна вещь,
которая может показаться, на первый взгляд, не очевидной: вы можете изменить
размер раздела, выбрав элемент, отображающий размер раздела. Это работает, как
минимум, на файловых системах fat16, fat32, ext2, ext3 и с разделом подкачки.
Также, из этого меню можно удалить раздел.

Убедитесь, что создали, по крайнем мере, два раздела: один для корневой
файловой системы (который должен быть смонтирован как /) и один раздел подкачки
. Если вы забыли указать точку монтирования корневой файловой системы, partman
не разрешит вам продолжить, пока вы не исправите ошибку.

Если вы загрузились в режиме EFI, но забыли выбрать и отформатировать системный
раздел EFI, partman обнаружит это и не разрешит вам продолжить, пока вы не
создадите такой раздел.

Возможности partman могут быть расширены модулями программы установки, но это
зависит от архитектуры компьютера. Поэтому, если вы не найдёте всех обещанных
свойств, проверьте, загрузили ли вы все требуемые модули (например,
partman-ext3, partman-xfs или partman-lvm).

Для завершения работы по разметке, выберите Закончить разметку и записать
изменения на диск из меню разметки. Вам покажут отчёт об изменениях, которые
будут произведены на диске и попросят подтвердить, что все представленные
файловые системы должны быть созданы.

6.3.4.4. Настройка устройств Multidisk (программный RAID)

Если у вас более одного жёсткого диска^[8] в компьютере, то можно
воспользоваться программой partman-md для увеличения производительности дисков
и/или повышения надёжности хранения данных. В результате получается так
называемое устройство Multidisk (или другое, более известное название,
программный RAID).

Основу MD составляют группы разделов, расположенные на различных дисках и
объединённые вместе в логическое устройство. Затем это устройство можно
использовать как обычный раздел (то есть в partman вы можете отформатировать
его, назначить ему точку монтирования и т.д.).

Получаемые преимущества зависят от типа создаваемого MD устройства. В данный
момент поддерживаются:

RAID0

    Применяется где нужна производительность. RAID0 разбивает все входящие
    данные на полосы и равномерно распределяет их по дискам в массиве. Это
    может увеличить скорость операций чтения/записи, но если один из дисков
    сломается, вы потеряете всё (часть информации всё ещё на исправных дисках
    (е), другая часть хранилась на сломавшемся диске).

    Обычно, разделы RAID0 используют при редактировании видео.

RAID1

    Используется там, где надёжность превыше всего. Он состоит из нескольких
    (обычно двух) одинаковых по размеру разделов, и на каждом разделе хранятся
    одинаковые данные. В сущности, это означает три вещи. Первое: если один из
    дисков сломается, вы не теряете данные, так как они продублированы на
    оставшихся дисках. Второе: вам доступна только часть имеющегося объёма
    (более точно, размер самого маленького раздела в RAID). Третье: нагрузка
    при чтении файла сбалансированно распределяется по всем дискам, что может
    повысить производительность, например, файлового сервера, на котором
    операций чтения больше чем операций записи.

    Также, вы можете иметь в массиве запасной диск, который включится в работу
    в случае неисправности одного из дисков.

RAID5

    Хороший компромисс между скоростью, надёжностью и избыточностью. RAID5
    разделяет все входящие данные на полосы и распределяет их пропорционально
    на все диски кроме одного (как и RAID0). В отличие от RAID0, RAID5
    вычисляет контрольную сумму, которую записывает на оставшийся диск. Диск с
    контрольной суммой не статичен (тогда это был бы RAID4), а периодически
    изменяется, так что контрольная сумма распределяется по всем дискам. Когда
    один из дисков ломается, потерянную часть информации можно вычислить из
    оставшихся данных и её контрольной суммы. RAID5 должен состоять, как
    минимум из трёх активных разделов. Также, вы можете иметь в массиве
    запасной диск, который включится в работу в случае неисправности одного из
    дисков.

    Как видите, RAID5 имеет немного надёжности от RAID1, но это достигается с
    меньшей избыточностью. С другой стороны, он немного медленнее на операциях
    записи, чем RAID0 из-за вычислений контрольной суммы.

RAID6

    Подобен RAID5, но контрольная сумма хранится на двух дисках, а не на одном.

    Массив RAID6 останется рабочим даже после выхода из строя сразу двух
    дисков.

RAID10

    В RAID10 используется чередование (как в RAID0) и зеркалирование (как в
    RAID1). В нём создаётся n копий входящих данных, которые распределяются
    между разделами так, что все копии одинаковых данных хранятся на разных
    устройствах. По умолчанию n равно 2, но в режиме эксперта это можно
    изменить. Число задействованных разделов должно быть как минимум n. В
    RAID10 есть различные схемы распределения копий. По умолчанию используется
    схема близкого (near) распределения. При этом все одинаковые копии
    располагаются на дисках по одинаковому смещению. Далёкие (far) копии имеют
    разные смещения на дисках. Смещение копий относится ко всей полосе, а не к
    отдельной копии.

    RAID10 может использоваться для достижения надёжности и избыточности без
    трат на подсчёты контрольных сумм.

Итог:

┌──────┬─────────┬─────────────┬──────────────┬───────────────────────────────┐
│      │ Минимум │  Запасное   │Сохранятся ли │                               │
│ Тип  │устройств│ устройство  │  данные при  │    Доступное пространство     │
│      │         │             │отказе диска? │                               │
├──────┼─────────┼─────────────┼──────────────┼───────────────────────────────┤
│      │         │             │              │Размер самого маленького       │
│RAID0 │2        │нет          │нет           │раздела умноженный на число    │
│      │         │             │              │устройств в RAID               │
├──────┼─────────┼─────────────┼──────────────┼───────────────────────────────┤
│RAID1 │2        │необязательно│да            │Размер самого маленького       │
│      │         │             │              │раздела в RAID                 │
├──────┼─────────┼─────────────┼──────────────┼───────────────────────────────┤
│      │         │             │              │Размер самого маленького       │
│RAID5 │3        │необязательно│да            │раздела умноженный на (число   │
│      │         │             │              │устройств в RAID минус один)   │
├──────┼─────────┼─────────────┼──────────────┼───────────────────────────────┤
│      │         │             │              │Размер самого маленького       │
│RAID6 │4        │необязательно│да            │раздела умноженный на (число   │
│      │         │             │              │устройств в RAID минус два)    │
├──────┼─────────┼─────────────┼──────────────┼───────────────────────────────┤
│      │         │             │              │Общее количество всех разделов,│
│RAID10│2        │необязательно│да            │поделённое на число полос копий│
│      │         │             │              │(по умолчанию два)             │
└──────┴─────────┴─────────────┴──────────────┴───────────────────────────────┘

Если вы хотите узнать больше о программном RAID, смотрите Software RAID HOWTO.

Для создания MD устройства нужно пометить желаемые разделы как используемые в
RAID. (Это делается в partman из меню Настройки раздела, где вы должны выбрать 
Использовать как: → Использовать раздел как устройство RAID.)

Примечание

Make sure that the system can be booted with the partitioning scheme you are
planning. In general it will be necessary to create a separate file system for
/boot when using RAID for the root (/) file system. Most boot loaders 
(including grub) do support mirrored (not striped!) RAID1, so using for example
RAID5 for / and RAID1 for /boot can be an option.

Далее, вы должны выбрать Настройка программного RAID из главного меню partman.
(Меню появится только после того как вы отметите хотя бы один раздел
используемый как физический том для RAID.)На первом экране partman-md просто
выберите Создать MD устройство. Вам будет предложен список поддерживаемых типов
MD устройств, из которого вы должны выбрать один (например, RAID1). Дальнейшие
действия зависят от типа выбранного MD.

  • RAID0 очень прост -- вам предложат список доступных разделов RAID, а вашей
    задачей будет выбор разделов, из которых вы хотите сформировать MD.

  • С RAID1 немного сложнее. Во-первых, вас попросят ввести количество активных
    устройств и количество запасных устройств, из которых будет формироваться
    MD. Далее, вам потребуется выбрать из списка доступных разделов RAID те,
    которые будут активными и затем, те которые будут запасными. Число
    выбранных разделов должно быть равно числу, введённому несколькими
    секундами ранее. Не волнуйтесь. Если вы ошибётесь и выберете неверное число
    разделов, debian-installer не позволит вам продолжить, пока вы не исправите
    ошибку.

  • Создание RAID5 напоминает процедуру RAID1 за исключением того, что вам
    нужно использовать как минимум три активных раздела.

  • Создание RAID6 напоминает процедуру RAID1 за исключением того, что вам
    нужно использовать как минимум четыре активных раздела.

  • Создание RAID10 также похоже на процедуру создания RAID1, если это
    происходит не в режиме эксперта. В экспертном режиме debian-installer
    попросит указать схему распределения. В схеме задаётся два параметра.
    Первый -- это тип схемы. Его значение может быть n (для близких копий), f
    (для далёких копий), или o (смещение копий). Вторым параметром задаётся
    число копий с данными. Оно должно быть равно, как минимум, числу активных
    дисков, чтобы было возможно распределить все копии по разным дискам.

Можно иметь несколько типов MD одновременно. Например, если вы имеете три
жёстких диска по 200 ГБ выделенных под MD, каждый из которых разбит на два 100
ГБ раздела, можно объединить первые разделы трёх дисков в RAID0 (быстрый 300 ГБ
раздел для редактирования видео) и использовать оставшиеся три раздела (2
активных и 1 запасной) для RAID1 (вполне надёжный 100 ГБ раздел для /home).

После настройки MD устройств в соответствии с вашими желаниями, вы можете
выбрать Закончить partman-md и вернуться в partman, чтобы создать файловые
системы на новых MD устройствах и назначить им обычные атрибуты типа точек
монтирования.

6.3.4.5. Настройка менеджера логических томов (LVM)

Если вы работаете с компьютером на уровне системного администратора или «
продвинутого» пользователя, то, определённо, попадали в ситуацию, когда на
дисковом разделе (обычно на самом важном) заканчивалось место, а соседний
раздел был почти пуст и вы выбирались из этой ситуации переносом данных с
одного раздела на другой, созданием символических ссылок и т.д.

Чтобы избежать описанной ситуации вы можете воспользоваться менеджером
логических томов (LVM). Проще говоря, с помощью LVM вы можете объединить
разделы (физические тома в терминах LVM) в виртуальный диск (так называемую
группу томов), который затем можно поделить на виртуальные разделы (логические
тома). Выгода в том, что логические тома (и, конечно, содержащие их группы
томов) можно распределить по нескольким физическим дискам.

Теперь, когда вы поняли, что вам нужно ещё место на имеющемся 160ГБ /home
разделе, вы можете просто добавить новый 300ГБ диск в компьютер, объединить его
с существующей группой томов и затем изменить размер логического тома, который
содержит файловую систему с /home и вуаля, ваши пользователи имеют
дополнительное место на новом 460ГБ разделе. Этот пример, конечно, сильно
упрощён. Дополнительную информацию вы найдёте в LVM HOWTO.

Настройка LVM в debian-installer очень проста и полностью поддерживается 
partman Во-первых, отметьте раздел(ы), которые будут использоваться в качестве
физических томов LVM. Это делается с в меню Настройки раздела, где вы должны
выбрать Использовать как: → физический том для LVM.

Предупреждение

Внимание: настройка нового LVM уничтожит все данные на всех разделах,
помеченных кодом с типом LVM. Поэтому, если у вас уже есть LVM на каких-то
дисках, и вы хотите дополнительно установить Debian на эту машину, то старый
(существующий) LVM будет стёрт! Это же относится и к разделам, которые (по
какой-то причине) обманчиво помечены кодом с типом LVM, но содержат что-то
другое (например, зашифрованный том). Вам необходимо удалить такие диски
из-системы до выполнения новой настройки нового LVM!

После того как вы вернётесь в главное меню partman, вы увидите новый пункт 
Настройка менеджера логических томов (LVM). Выбрав его, сначала вас попросят
подтвердить сделанные изменения (если есть) в таблице разделов, а затем будет
показано меню настройки LVM. Сверху меню кратно показана настройка LVM. Сам
состав меню зависит от выбранных настроек и содержит только допустимые
действия. Возможные действия:

  • Показать настройку подробней: показывает структуру LVM устройства, имена и
    размеры логических томов и т.д.

  • Создать группу томов

  • Создание логических томов

  • Удалить группу томов

  • Удаление логических томов

  • Расширить группу томов

  • Уменьшить группу томов

  • Закончить: вернуться в главное меню partman

С помощью этого меню сначала создайте логическую группу, а затем внутри неё
логические тома.

После возвращения в главное меню partman, вы должны увидеть все созданные
логические тома, как обычные разделы (и настраиваются они одинаково).

6.3.4.6. Настройка шифрованных томов

debian-installer позволяет настраивать шифрованные разделы. Каждый файл,
записываемый на такой раздел, немедленно сохраняется на устройстве в
шифрованном виде. Доступ к шифрованным данным разрешается только после ввода
ключевой фразы, которая задаётся при создании шифрованного раздела. Эта
возможность полезна для защиты конфиденциальных данных на ноутбуке или жёстком
диске при краже. Вор может получить физический доступ к жёсткому диску, но не
зная правильной ключевой фразы, данные на диске выглядят как случайный набор
символов.

The two most important partitions to encrypt are: the home partition, where
your private data resides, and the swap partition, where sensitive data might
be stored temporarily during operation. Of course, nothing prevents you from
encrypting any other partitions that might be of interest. For example /var
where database servers, mail servers or print servers store their data, or /tmp
which is used by various programs to store potentially interesting temporary
files. Some people may even want to encrypt their whole system. Generally the
only exception here is the /boot partition which must remain unencrypted,
because historically there was no way to load the kernel from an encrypted
partition. (GRUB is now able to do that, but debian-installer currently lacks
native support for encrypted /boot. The setup is therefore covered in a
separate document.)

Примечание

Заметим, что производительность шифрованных разделов будет меньше чем не
шифрованных, так как при каждом чтении и записи данных происходит шифрование и
дешифрование. Производительность зависит от быстродействия процессора,
выбранного алгоритма шифрования и длины ключа.

Для использования шифрования создайте новый раздел выделив свободное
пространство в главном меню разметки. Также можно выбрать уже существующий
раздел (например, обычный раздел, логический том LVM или том RAID). В меню 
Настройки раздела для Использовать как: нужно выбрать физический том для
шифрования. После этого в меню для раздела появятся несколько параметров
шифрования.

Поддерживаемый debian-installer метод шифрования: dm-crypt (включён в новых
ядрах Linux, доступен для физических томов LVM узла).

Давайте рассмотрим возможные параметры, если в качестве метода шифрования
выбран Device-mapper (dm-crypt). Как и всегда: если не знаете, используйте
значения по умолчанию, так как они вдумчиво выбирались исходя из соображений
безопасности.

Шифрование: aes

    Этот параметр позволяет выбрать алгоритм шифрования (шифр), который будет
    использоваться для шифрования данных раздела. debian-installer поддерживает
    следующие блочные шифры: aes, blowfish, serpent и twofish. Здесь не будет
    обсуждаться стойкость этих алгоритмов, однако, при выборе вам наверно будет
    небезынтересно узнать, что в 2000 году AES был выбран Национальным
    Институтом Стандартизации США в качестве стандартного алгоритма шифрования
    для защиты конфиденциальной информации в 21-ом веке.

Размер ключа: 256

    Здесь вы можете указать длину ключа шифрования. С увеличением размера ключа
    стойкость шифрования обычно усиливается. С другой стороны, увеличение длины
    ключа обычно негативно сказывается на производительности. Допустимые
    размеры ключа зависят от шифра.

IV алгоритм: xts-plain64

    Вектор инициализации или IV алгоритм используется в криптографии для того,
    чтобы при шифровании одного и того же обычного текста одинаковым ключом
    всегда получался уникальный шифрованный текст. Это было введено для того,
    чтобы при взломе шифра предотвратить нахождение повторяющихся участков в
    шифрованных данных.

    Из предлагаемых возможностей, значение по умолчанию xts-plain64 является на
    сегодняшний момент наименее уязвимым к известным атакам. Используйте
    альтернативы только когда это нужно для совместимости с раннее
    установленной системой, в которой невозможно задействовать новые алгоритмы.

Ключ шифрования: ключевая фраза

    Здесь можно ввести тип ключа шифрования для этого раздела.

    Ключевая фраза

        Ключ шифрования будет создан^[9] на основе ключевой фразы, которую вы
        сможете ввести позже.

    Произвольный ключ

        Новый ключ шифрования будет генерироваться из произвольных данных
        всякий раз при монтировании раздела. Другими словами: при каждом
        выключении машины содержимое раздела теряется, так как ключ удаляется
        из памяти. (Естественно, вы можете попробовать найти ключ перебором
        всех вариантов, но если в алгоритме шифрования нет неизвестных
        уязвимостей, это недостижимо за нашу продолжительность жизни.)

        Произвольные ключи полезны для разделов подкачки, так как вам не нужно
        запоминать ключевую фразу из вычищать конфиденциальную информацию из
        раздела подкачки перед выключением компьютера. Однако, это также
        означает, что вы не сможете использовать функцию «suspend-to-disk» из
        новых ядер Linux, так как невозможно (во время последующей загрузки)
        восстановить приостановленные данные записанные в раздел подкачки.

Стереть данные: да

    Задаёт, нужно ли перезаписать содержимое раздела произвольными данными
    перед настройкой шифрования. Это рекомендуется делать, так как иначе это
    может позволить злоумышленнику разгадать какие части раздела используются,
    а какие нет. Также, это усложнит процесс восстановления любых оставшихся от
    предыдущей установки данных^[10].

После выбора желаемых параметров для шифруемых разделов, вернитесь обратно в
главное меню разметки. Там должен появиться новый пункт Настроить шифрование
для томов. После того как вы его выберете, вас попросят подтвердить удаление
данных на разделах, помеченных на стирании и возможно, другие действия, типа
записи новой таблицы разделов. Для огромных разделов это может занять некоторое
время.

Затем вас попросят ввести ключевую фразу для разделов, настроенные на её
использование. Хорошие ключевые фразы должны быть больше 8 знаков, должны
содержать вперемешку буквы, числа и другие символы и не должны содержать
общеупотребительных словарных слов или информации, которая как-то относится к
вам лично (например, дни рождения, хобби, имена домашних животных, имена
родственников и тому подобное).

Предупреждение

Перед вводом ключевых фраз вы должны убедиться, что клавиатура настроена
правильно и генерирует ожидаемые символы. Если вы не уверены, можно
переключиться на вторую виртуальную консоль и попробовать ввести текст. Это
застрахует вас от неожиданностей в последствии, например, если вы вводите
ключевую фразу на клавиатуре с раскладкой qwerty, а во время установки вы
использовали раскладку azerty. Такая ситуация может случиться по нескольким
причинам. Вы могли переключиться на другую раскладку клавиатуры во время
установки, или выбранная раскладка ещё не активирована ко времени ввода
ключевой фразы для корневой файловой системы.

Если для создания ключей шифрования вы выбрали использование методов без
ключевой фразы, то они будут сгенерированы. Так как ядро могло не собрать
достаточное количество энтропии на данной ранней стадии установки, процесс
может занять продолжительное время. Вы можете ускорить процесс генерации
энтропии: например, нажимая произвольные клавиши, или переключиться в оболочку
командной строки на второй виртуальной консоли и создать некоторый обмен
данными по сети или с диском (загрузив какие-то файлы, скопировать большие
файлы в /dev/null и т.д.). Это нужно сделать для каждого шифруемого раздела.

После возвращения в главное меню разметки, вы увидите все шифрованные тома как
дополнительные разделы, которые можно настраивать как обычные разделы. В
следующем примере показан том, зашифрованный с помощью dm-crypt

Encrypted volume (sda2_crypt) - 115.1 GB Linux device-mapper
     #1 115.1 GB  F ext3

Теперь можно назначить точки монтирования и изменить тип файловых систем, если
значения по умолчанию чем-то не устраивают.

Запишите где-нибудь информацию о соответствии идентификаторов в скобках (
sda2_crypt в данном случае) и точках монтирования, которые вы назначили
шифрованным томам. Эти данные вам потребуются позже при загрузки новой системы.
Различия между обычным процессом загрузки и загрузки с шифрованием описаны
далее в Раздел 7.2, «Монтирование шифрованных томов».

После того как вас полностью устроит схема разметки, продолжайте установку.

6.3.5. Установка базовой системы

Хотя эта стадия наименее проблематична, она занимает наибольшую часть времени
установки, потому что загружается, проверяется и распаковывается вся базовая
система. Если у вас медленный компьютер или сетевое соединение, это может
занять определённое время.

Во время установки базовой системы сообщения о распаковке и настройке пакетов
переправляются на tty4. Вы можете перейти на этот терминал, нажав левый Alt+F4;
чтобы вернуться обратно в основной процесс установки нажмите левый Alt+F1.

Сообщения распаковки/настройки во время этого этапа сохраняются в файле /var/
log/syslog. Вы можете посмотреть их, если установка выполняется через консоль
на последовательном порту.

В одной из частей установки выполняется установка ядра Linux. С приоритетом по
умолчанию программа установки выберет ядро наиболее подходящее для вашего
оборудования. В режимах с низким приоритетом, это предложат сделать вам из
списка доступных ядер.

При установке пакетов с помощью системы управления пакетами по умолчанию также
производится установка пакетов, рекомендуемых устанавливаемыми пакетами.
Рекомендуемые пакеты не требуются для работоспособности основных возможностей
выбранного ПО, но они добавляют новые возможности этому ПО и должны, по мнению
сопровождающих, обычно устанавливаться вместе с этим ПО.

Примечание

По техническим причинам, пакеты, устанавливаемые во время установки базовой
системы, устанавливаются без их «Рекомендуемых» пакетов. Правило, описанное
выше, действует только после данного этапа процесса установки.

6.3.6. Установка дополнительного программного обеспечения

На этом этапе уже есть рабочая, но ограниченная по возможностям система.
Большинство пользователей хотело бы добавить дополнительное программное
обеспечение в систему, чтобы решать свои задачи, и программа установки
позволяет это сделать. Этот этап может продлиться дольше чем установка базовой
системы, если у вас медленный компьютер или соединение с сетью.

6.3.6.1. Настройка apt

One of the tools used to install packages on a Debian GNU/Linux system is the
program apt, from the apt package^[11]. Other front-ends for package
management, like aptitude and synaptic, are also in use. These front-ends are
recommended for new users, since they integrate some additional features
(package searching and status checks) in a nice user interface.

Пакету apt нужно указать откуда получать пакеты. Результат настройки
сохраняется в файле /etc/apt/sources.list. Вы можете проверить и изменить его
по желаю после завершения установки.

Если вы выполняете установку с приоритетом по умолчанию, то программа установки
выполнит большую часть настройки автоматически, основываясь на используемом
методе установки и, возможно, на ответах, указанных вами ранее. В большинстве
случаев программа установки автоматически добавит зеркало безопасности и, если
вы используете стабильный дистрибутив, зеркало сервиса «stable-updates».

If you are installing at a lower priority (e.g. in expert mode), you will be
able to make more decisions yourself. You can choose whether or not to use the
security and/or stable-updates services, and you can choose to add packages
from the «contrib», «non-free», and «non-free-firmware» sections of the
archive.

6.3.6.1.1. Installing from more than one DVD image

If you are installing from a DVD image that is part of a larger set, the
installer will ask if you want to scan additional installation media. If you
have such additional media available, you probably want to do this so the
installer can use the packages included on them.

If you do not have any additional media, that is no problem: using them is not
required. If you also do not use a network mirror (as explained in the next
section), it can mean that not all packages belonging to the tasks you select
in the next step of the installation can be installed.

Примечание

Packages are included on DVD images in the order of their popularity. This
means that for most uses only the first image of a set is needed and that only
very few people actually use any of the packages included on the last images of
a set.

It also means that buying or downloading and burning a full DVD set is just a
waste of money as you'll never use most of them. In most cases you are better
off getting only the first 1 to 2 DVDs and installing any additional packages
you may need from the Internet by using a mirror.

If you do scan multiple installation media, the installer will prompt you to
exchange them when it needs packages from one that isn't currently in the
drive. Note that only discs that belong to the same set should be scanned. The
order in which they are scanned does not really matter, but scanning them in
ascending order will reduce the chance of mistakes.

6.3.6.1.2. Использование сетевого сервера-зеркала пакетов

Один из часто задаваемых вопросов: использовать или нет сетевой сервер-зеркало
в качестве источника пакетов. В большинстве случаев значение ответа по
умолчанию вполне приемлемо, но не всегда.

If you are not installing from a DVD image, you really should use a network
mirror as otherwise you will end up with only a very minimal system. However,
if you have a limited Internet connection it is best not to select the desktop
task in the next step of the installation.

If you are installing from DVD, any packages needed during the installation
should be present on the first DVD image. Use of a network mirror is optional.

One advantage of adding a network mirror is that updates, that have occurred
since the DVD images were created and have been included in a point release,
will become available for installation, thus extending the life of your DVD set
without compromising the security or stability of the installed system.

In summary: selecting a network mirror is generally a good idea, except if you
do not have a good Internet connection. If the current version of a package is
available from installation media, the installer will always use that. The
amount of data that will be downloaded if you do select a mirror thus depends
on

 1. задач, которые вы выберете на следующем этапе установки,

 2. пакетов, которые необходимы для этих задач,

 3. which of those packages are present on the installation media you have
    scanned, and

 4. whether any updated versions of packages included on the installation media
    are available from a mirror (either a regular package mirror, or a mirror
    for security or stable-updates).

Заметим, что даже если вы выберете не использовать сетевое зеркало, некоторые
пакеты могут всё равно быть скачаны из Интернет, если для них есть, согласно
сервису безопасности или stable-updates, новые версии, и если эти были сервисы
настроены.

6.3.6.1.3. Выбор сетевого сервера-зеркала пакетов

Unless you chose not to use a network mirror, you will be presented with a list
of network mirrors based upon your country selection earlier in the
installation process. Choosing the offered default is usually fine.

The offered default is deb.debian.org, which is not a mirror itself but will
redirect to a mirror that should be up-to-date and fast. These mirrors support
TLS (https protocol) and IPv6. This service is maintained by the Debian System
Administration (DSA) team.

A mirror can also be specified by hand by choosing «enter information manually»
. You can then specify a mirror host name and an optional port number. This
actually has to be a URL base, i.e. when specifying an IPv6 address, one has to
add square brackets around it, for instance «[2001:db8::1]».

Если ваш компьютер имеет только адрес IPv6 (что, вероятно, не так, для
подавляющего большинства пользователей), указанное по умолчанию зеркало для
вашей страны может не работать. Все зеркала из списка доступны по адресам IPv4,
и только некоторые из них имеют адреса IPv6. Доступность отдельных зеркал может
с течением времени меняться, эта информация недоступна программе установки.
Если для вашей страны зеркало по умолчанию недоступно через IPv6, то вы можете
попробовать другое зеркало или «ввести информацию вручную». При этом в качестве
имени зеркала вы можете указать «ftp.ipv6.debian.org», которое является
псевдонимом зеркала, доступного по IPv6, хотя оно не будет таким быстрым.

6.3.6.2. Выбор и установка программного обеспечения

Во время процесса установки вам будет предложено выбрать дополнительное
программное обеспечение для установки. Вместо выбора каждой программы из 102687
доступных пакетов, этот этап позволяет сосредоточиться на выборе и установке
заранее подготовленных наборов ПО, чтобы быстро настроить компьютер на
выполнение определённых задач.

These tasks loosely represent a number of different jobs or things you want to
do with your computer, such as «Desktop environment», «Web server», or «SSH
server»^[12]. Раздел D.2, «Дисковое пространство, необходимое для задач» lists
the space requirements for the available tasks.

Некоторые задачи могут быть уже выбраны в зависимости от характеристик
компьютера на который производится установка. Если вы не согласны с таким
выбором, то можете отменить лишние задачи. Вы даже можете вообще ничего не
устанавливать с помощью задач.

Подсказка

В стандартном пользовательском интерфейсе программы установки для выбора/отмены
задач используется клавиша пробел.

Примечание

По задаче «Окружение рабочего стола» будет установлено графическое окружение
рабочего стола.

По умолчанию debian-installer устанавливает окружение рабочего стола Gnome . Во
время установки возможно выбрать другое окружение рабочего стола. Также
возможно установить несколько окружений, но некоторые комбинации не могут быть
установлены одновременно.

Note that this will only work if the packages needed for the desired desktop
environment are actually available. Installing any of the available desktop
environments this way should work fine if you are using a DVD image or any
other installation method with a network mirror.

The various server tasks will install software roughly as follows. Web server:
apache2; SSH server: openssh.

The «Standard system utilities» task will install any package that has a
priority «standard». This includes a lot of common utilities that are normally
available on any Linux or Unix system. You should leave this task selected
unless you know what you are doing and want a really minimal system.

Если в следствии выбора языка локаль по умолчанию стала отличаться от локали «C
», то tasksel проверит, определены ли какие-либо задачи локализации для этой
локали, и автоматически попытается установить подходящие пакеты локализации.
Например, к таким пакетам относятся пакеты со словарями или специальными
шрифтами для вашего языка. Если выбрана установка окружения рабочего стола, то
также будут установлены соответствующие пакеты локализации (если есть).

Примечание

Starting with Debian Trixie, debian-installer allows to install Debian Pure
Blends directly. There is an entry «Choose a Debian Blend for installation» at
the bottom of the tasks list, which enables an additional choices dialog to
appear, after tasksel has finished.

In that dialog (blendsel), you can choose which blend to install, similar to
this tasks selection.

See the Debian website for more information about Debian Pure Blends.

После выбора задач нажмите Continue. Теперь apt начнёт установку пакетов,
которые являются частью указанных задач. Если какой-то программе нужна
дополнительная информация от пользователя, то она задаст её во время данного
процесса.

You should be aware that especially the Desktop task is very large. Especially
when installing from a netinst CD image in combination with a mirror for
packages not on the netinst, the installer may want to retrieve a lot of
packages over the network. If you have a relatively slow Internet connection,
this can take a long time. There is no option to cancel the installation of
packages once it has started.

Even when packages are included on the installation image, the installer may
still retrieve them from the mirror if the version available on the mirror is
more recent than the one included on the image. If you are installing the
stable distribution, this can happen after a point release (an update of the
original stable release); if you are installing the testing distribution this
will happen if you are using an older image.

6.3.7. Установка и настройка системного загрузчика

If you are installing a diskless workstation, obviously, booting off the local
disk isn't a meaningful option, and this step will be skipped.

6.3.7.1. Обнаружение операционных систем

Перед установкой системного загрузчика программа установки попытается
обнаружить другие операционные системы, установленные на машине. Если она
обнаружит поддерживаемую операционную систему, то это будет отражено на этапе
установки системного загрузчика, и компьютер сможет загружать эту операционную
систему в дополнении к Debian.

Надо заметить, что загрузка множества операционных систем на одной машине всё
ещё напоминает чёрную магию. Автоматическая поддержка обнаружения и настройки
системных загрузчиков на загрузку различных операционных систем различается на
разных архитектурах и даже субархитектурах. Более подробную информацию можно
найти в документации по менеджеру загрузки.

6.3.7.2. Install the Grub Boot Loader on the drive

The amd64 boot loader is called «grub». Grub is a flexible and robust boot
loader and a good default choice for new users and old hands alike.

By default, grub will be installed on the UEFI partition/the Boot Record of the
primary drive, where it will take over complete control of the boot process. If
you prefer, you can install it elsewhere. See the grub manual for complete
information.

Если вы не хотите устанавливать grub, нажмите кнопку Go Back, чтобы перейти в
главное меню, и там выберите системный загрузчик, который вы хотите
использовать.

6.3.7.3. Продолжение без системного загрузчика

Эта опция может быть использована для завершения установки без установки
системного загрузчика, если для этой архитектуры/субархитектуры его не
существует или потому что, он вам не нужен (например, чтобы использовать
существующий системный загрузчик).

Если вы планируете настройку системного загрузчика вручную, то должны узнать
имя файла устанавливаемого ядра, которое лежит в каталоге /target/boot. Также,
проверьте существование каталога initrd; если он есть, то вероятно нужно
указать это в системном загрузчике, чтобы он использовал его. Ещё вам
потребуется знать диск и раздел, который выбран в качестве / файловой системы
и, если вы выбрали установку с отдельным разделом /boot, то также и раздел
файловой системы с /boot.

6.3.8. Завершение установки

Это последний этап установки Debian в процессе которого программа установки
выполнит ещё пару действий. В основном, это уборка за debian-installer.

6.3.8.1. Настройка системного времени

Программа установки может спросить вас показывают ли часы компьютера время по
Гринвичу (UTC). Обычно этот вопрос, если возможно, не задаётся и программа
установки решает, что часы показывают время по Гринвичу, если на машине не
установлено других операционных систем.

In expert mode you will always be able to choose whether or not the clock is
set to UTC. Systems that (also) run Windows are normally set to local time. If
you want to dual-boot, select local time instead of UTC.

На этом этапе debian-installer попытается сохранить текущее время в аппаратных
часах системы. Оно будет выставлено в UTC или местном времени, в зависимости от
выбора, который вы недавно делали.

6.3.8.2. Перезагрузка системы

You will be prompted to remove the boot media (CD, USB stick, etc) that you
used to boot the installer. After that the system will be rebooted into your
new Debian system.

6.3.9. Устранение проблем

Перечисленные в этом разделе компоненты обычно не используются в процессе
установки, но они готовы прийти на помощь пользователю в случае, если что-то
пойдёт не так.

6.3.9.1. Сохранение протокола установки

Если установка прошла успешно, файлы протокола установки, созданные во время
процесса установки, будут автоматически записаны в /var/log/installer/ в новой
системе Debian.

Choosing Save debug logs from the main menu allows you to save the log files to
a USB stick, network, hard disk, or other media. This can be useful if you
encounter fatal problems during the installation and wish to study the logs on
another system or attach them to an installation report.

6.3.9.2. Использование командной строки и просмотр журнальных файлов

Есть несколько способов перейти в оболочку командной строки во время выполнения
установки. На большинстве систем, и если вы не производите установку с консоли
на последовательном порту, самый простой метод -- это переключиться на вторую 
виртуальную консоль нажав левый Alt+F2^[13] (на клавиатуре Mac: Option+F2).
Чтобы вернуться обратно в программу установки используйте левый Alt+F1.

Описание программы установки с графическим интерфейсом смотрите в Раздел 6.1.1,
«Использование программы установки с графическим интерфейсом».

Если вы не можете переключаться между консолями, также есть пункт в меню Запуск
оболочки, который запускает оболочку. Чтобы из большинства диалогов попасть
обратно в главное меню нажмите кнопку Go Back один или несколько раз. Чтобы
вернуться обратно в программу установки, введите exit для завершения оболочки.

В данный момент вы загрузились с RAM диска и имеете ограниченный набор Unix
утилит. Вы можете выяснить какие утилиты доступны с помощью команды ls /bin /
sbin /usr/bin /usr/sbin или набрав help. Клон Bourne оболочки командной строки
называется ash и имеет некоторые полезные свойства,такие как автодополнение и
история команд.

Для редактирования и просмотра файлов имеется текстовый редактор nano.
Журнальные файлы системы установки можно найти в каталоге /var/log.

Примечание

Хотя вы и можете делать в оболочке в помощью команд всё что угодно, не
забывайте, что оболочка, прежде всего, предназначалась для отладки и если
что-то заработает неправильно.

Выполнение команд в оболочке может повлиять на процесс установки и привести к
ошибкам или неполной установке. В частности, вы всегда должны позволить
программе установки активировать раздел подкачки и не выполнять это
самостоятельно из оболочки командной строки.

6.3.10. Installation over network-console

Одной из наиболее интересных компонент является network-console. Она позволяет
выполнить огромную часть процесса установки через сеть по протоколу SSH. Чтобы
использовать сеть, вам нужно выполнить первые шаги установки из консоли, по
крайней мере настройку сети. (Хотя вы можете автоматизировать и эту часть с
помощью Раздел 4.6, «Автоматическая установка».)

This component is not loaded into the main installation menu by default, so you
have to explicitly ask for it. If you are installing from optical media, you
need to boot with medium priority or otherwise invoke the main installation
menu and choose Load installer components from installation media and from the
list of additional components select network-console: Continue installation
remotely using SSH. Successful load is indicated by a new menu entry called 
Continue installation remotely using SSH.

Далее после выбора данного пункта попросят ввести новый пароль и его
подтверждение для подключения к устанавливаемой системе. Это всё. Теперь вы
должны увидеть инструкции по удалённому подключению в качестве пользователя 
installer с только что введённым паролем. Также здесь будет показан отпечаток
(fingerprint) системы. Вам нужно передать этот отпечаток безопасным образом
человеку, который будет продолжать установку удалённо.

Если вы решите продолжить установку локально, то всегда можете нажать клавишу 
Enter и вернуться обратно в меню чтобы выбрать другую компоненту.

Теперь давайте перейдём на другую сторону соединения. Здесь вам потребуется
настроить терминал для работы с кодировкой UTF-8, потому что её использует
устанавливаемая система. Если вы не можете этого сделать, удалённая установка
всё ещё возможна, но в этом случае вы будете наблюдать на экране странные
закорючки вместо границ окон и не-ascii символов. Чтобы установить соединение с
удалённой системой просто наберите:

$ ssh -l installer install_host

где install_host это имя или IP-адрес компьютера с запущенной программой
установки. Перед приглашением в систему будет показан идентификатор машины
(fingerprint), чтобы вы смогли убедиться, что это именно тот компьютер.

Примечание

Сервер ssh из программы установки использует настройки по умолчанию, то есть не
отправляет пакеты keep-alive. В принципе, соединение с системой, будучи
установленным, должно сохраняться открытым бесконечно. Однако, в некоторых
ситуациях -- в зависимости настроек вашей локальной сети -- соединение может
быть потеряно после некоторого периода неактивности. Одним из случаев когда это
случается -- использование одной из форм трансляции сетевых адресов (NAT)
где-то между клиентом и устанавливаемой системой. В зависимости от этапа
установки, при котором было разорвано соединение, вы не всегда сможете
продолжить установку после переподключения.

Чтобы избежать потери подключения, добавьте параметр -o ServerAliveInterval=
значение при запуске соединения ssh, или добавьте этот параметр в свой файл
настройки ssh. Заметим однако, что в некоторых случаях добавление этого
параметра вообще может приводить к потере соединения (например, если пакеты
keep-alive посылались во время краткосрочных проблем в сети, хотя без параметра
ssh сам бы восстановился), поэтому используйте это только когда очень нужно.

Примечание

Если вы производите установку на несколько компьютеров последовательно и так
получилось, что они имеют одинаковый IP-адрес или имя, то ssh не будет
подключаться к таким машинам. Причина в том, что они имеют разные отпечатки,
что обычно указывает на атаку подмены. Если вы уверены, что это не так, то вам
нужно удалить соответствующую строку из ~/.ssh/known_hosts^[14] и попробовать
подключиться ещё раз.

После регистрации на удалённой системе вам предложат два варианта:Start menu и 
Start shell. Выбрав первый, вы попадёте в главное меню программы установки,
откуда можно продолжить установку как обычно. Во втором варианте запускается
оболочка командной строки, из которой можно проверить и возможно, что-то
исправить на удалённой системе. Разрешается запускать только одну сессию SSH
для установочного меню и несколько для оболочки командной строки.

Предупреждение

После запуска установки через SSH, вы не должны возвращаться к установке с
консоли, так как это может привести к порче базы данных, которая содержит
настройки новой системы. Это, в свою очередь, может привести к неудачному
завершению установки или проблемам в установленной системой.

6.4. Загрузка отсутствующих микропрограмм

Как описывалось в Раздел 2.2, «Устройства, которым требуются микропрограммы», в
некоторые устройства требуется загрузить микропрограмму. В большинстве случаев,
устройство вообще не будет работать при отсутствии микропрограммы; иногда в
устройстве всё-же работают базовые функции, а микропрограмма нужна только для
предоставления дополнительных возможностей.

Starting with Debian GNU/Linux 12.0, following the 2022 General Resolution
about non-free firmware, official installation images (like netinst) can
include non-free firmware packages. Even with those firmware packages
available, some firmware files might still be missing. Or one might be using
netboot files, which don't include firmware packages.

Если драйвер устройства запрашивает микропрограмму, а она недоступна, то
debian-installer выведет окно диалога, предлагающее загрузить отсутствующую
микропрограмму. Если ответить утвердительно, то debian-installer просканирует
доступные устройства в поисках файлов или пакетов с нужной микропрограммой.
Если файлы найдены, то микропрограмма будет скопирована в нужное место (/lib/
firmware) и будет предпринята попытка перезагрузки модуля с драйвером.

Примечание

Which devices are scanned and which file systems are supported depends on the
architecture, the installation method and the stage of the installation.
Especially during the early stages of the installation, loading the firmware is
most likely to succeed from a FAT-formatted USB stick. On i386 and amd64
firmware can also be loaded from an MMC or SD card.

Заметим, что можно пропустить загрузку микропрограммы, если вы уверены, что
устройство будет работать и без неё, или если устройство не требуется во время
установки.

6.4.1. Подготовка носителя

The most common method to load such firmware is from some removable medium such
as a USB stick. To prepare a USB stick (or other medium like a hard drive
partition), the firmware files or packages must be placed in either the root
directory or a directory named /firmware of the file system on the medium. The
recommended file system to use is FAT as that is most certain to be supported
during the early stages of the installation.

Tarballs and zip files containing current packages for the most common
firmware, and the associated metadata to ensure a proper detection by the
installer (dep11 directory), are available from:

  • https://cdimage.debian.org/cdimage/firmware/trixie/

Just download the tarball or zip file for the correct release and unpack it to
the file system on the medium.

Также, можно копировать на носитель отдельные файлы микропрограммы. Такие
микропрограммы можно получить, например, из уже установленной системы или от
поставщика оборудования.

6.4.2. Микропрограмма в установленной системе

Any firmware loaded during the installation will be copied automatically to the
installed system. In most cases this will ensure that the device that requires
the firmware will also work correctly after the system is rebooted into the
installed system. However, if the installed system runs a different kernel
version than the installer, there is a slight chance that the firmware cannot
be loaded due to version skew.

If the firmware was loaded from a firmware package, debian-installer will also
install this package for the installed system and will automatically add the
non-free-firmware section of the package archive in APT's sources.list. This
has the advantage that the firmware should be updated automatically if a new
version becomes available.

Если загрузка микропрограммы была пропущена во время установки, то
соответствующее устройство, вероятно, не заработает в установленной системе
пока микропрограмма (пакет) не будет установлена вручную.

Примечание

Если микропрограмма была загружена из отдельных файлов, то скопированная в
установленную систему микропрограмма не будет автоматически обновляться, пока
не не будет установлен соответствующий пакет с микропрограммой (если есть)
после завершения установки.

6.4.3. Completing the Installed System

Depending on how the installation was performed, it might be that the need for
some firmware was not detected during installation, that the relevant firmware
was not available, or that one chose not to install some firmware at that time.
In some cases, a successful installation can still end up in a black screen or
a garbled display when rebooting into the installed system. When that happens,
the following workarounds can be tried:

  • Pass the nomodeset option on the kernel command line. This might help boot
    into a «fallback graphics» mode.

  • Use the Ctrl+Alt+F2 key combination to switch to VT2, which might offer a
    functional login prompt.

6.5. Customization

Using the shell (see Раздел 6.3.9.2, «Использование командной строки и просмотр
журнальных файлов»), the installation process can be carefully customized, to
fit exceptional use cases:

6.5.1. Installing an alternative init system

Debian uses systemd as its default init system. However, other init systems
(such as sysvinit and OpenRC) are supported, and the easiest time to select an
alternative init system is during the installation process. For detailed
instructions on how to do so, please see the Init page on the Debian wiki.


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[4] Технически говоря: когда для языка существует несколько локалей с
различными кодами стран.

^[5] Установив средний или низкий приоритет, вы всегда можете выбрать
предпочитаемую локаль из тех, что доступны для выбранного языка (если есть
больше одной).

^[6] Старые локали -- это локали, не использующие UTF-8, с устаревшей
стандартной символьной кодировкой, например ISO 8859-1 (используется для
западно-европейских языков) или EUC-JP (используется для японского языка).

^[7] Программа установки шифрует групповые тома LVM 256-битным ключом AES и
использует поддержку «dm-crypt» в ядре.

^[8] Если честно, вы можете собрать MD устройство даже из обычных разделов,
расположенных на одном физическом жёстком диске, но это не даст никакой выгоды.

^[9] Использование ключевой фразы в качестве ключа означает, что раздел будет
настроен с помощью LUKS.

^[10] Однако, есть мнение, что ребята из служб на три буквы могут
восстанавливать данные даже после их неоднократной перезаписи на
магнитооптических носителях.

^[11] Note that the program which actually installs the packages is called dpkg
. However, this program is more of a low-level tool. apt is a higher-level
tool, which will invoke dpkg as appropriate. It knows how to retrieve packages
from your installation media, the network, or wherever. It is also able to
automatically install other packages which are required to make the package
you're trying to install work correctly.

^[12] You should know that to present this list, the installer is merely
invoking the tasksel program. It can be run at any time after installation to
install more packages (or remove them), or you can use a more fine-grained tool
such as aptitude. If you are looking for a specific single package, after
installation is complete, simply run aptitude install package, where package is
the name of the package you are looking for.

^[13] То есть: нажмите клавишу Alt с левой стороны от клавиши пробел и
функциональную клавишу F2 одновременно.

^[14] Для удаления существующей записи об узле можно воспользоваться командой: 
ssh-keygen -R <имя_узла|IP-адрес>.

Глава 7. Загрузка только что установленной системы Debian

Содержание

7.1. Момент истины
7.2. Монтирование шифрованных томов
    7.2.1. Устранение неполадок
7.3. Вход в систему

7.1. Момент истины

Первую самостоятельную загрузку системы инженеры-электрики называют «smoke test
».

If you did a default installation, the first thing you should see when you boot
the system is the menu of the grub bootloader. The first choices in the menu
will be for your new Debian system. If you had any other operating systems on
your computer (like Windows) that were detected by the installation system,
those will be listed lower down in the menu.

Если система не загружается, не волнуйтесь. Если установка завершилась успешно,
то это всего лишь результат какой-то несущественной проблемы, которая не
позволяет системе загрузить Debian. В большинстве случаев такие проблемы
решаются без повторной установки. Одним из методов решения проблем с загрузкой
является встроенный в программу установки режим восстановления (Раздел 8.6,
«Восстановление неработающей системы»).

Если вы новичок в Debian и Linux, вам может потребоваться помощь более опытных
пользователей. Чтобы получить помощь быстро, вы можете попробовать
воспользоваться IRC каналами #debian или #debian-boot сети OFTC. Или же вы
можете написать вв список рассылки debian-user. Также вы можете отправить отчёт
об установке как это описано в Раздел 5.4.7, «Отправка отчётов об ошибках
установки». Описывайте проблему как можно понятнее, добавьте все сообщения
которые отображались, они могут помочь определить причину проблемы.

Если у вас на компьютере есть другие операционные системы, и они не
определились или определились неправильно, отправьте отчёт об установке.

7.2. Монтирование шифрованных томов

Если вы создали шифрованные тома во время установки и назначили им точки
монтирования, то во время загрузки машины вас попросят ввести ключевую фразу на
каждый том.

Для разделов, зашифрованных dm-crypt, во время загрузки вы увидите следующее
сообщение:

Starting early crypto disks... part_crypt(starting)
Enter LUKS passphrase:

В первой строке приглашения, вместо part будет указано название используемого
раздела, например sda2 или md0. Вы, вероятно, задумаетесь: для какого тома
нужно вводить ключевую фразу? Для /home? Или для /var? Естественно, если у вас
только один шифрованный том, это легко и вы можете просто ввести ключевую
фразу, которую задали при настройке тома. Если же у вас несколько шифрованных
томов, то пригодятся заметки, которые вы сделали на последнем этапе
Раздел 6.3.4.6, «Настройка шифрованных томов». Если вы ранее не записали
соответствие между part_crypt и точкой монтирования, то можете выяснить это в
файлах /etc/crypttab и /etc/fstab на новой системе.

При монтировании зашифрованного корневого раздела приглашение может выглядеть
несколько иначе. Это зависит от генератора initramfs, который использовался при
создании initrd для загрузки системы. Пример для initrd, созданного с помощью
initramfs-tools:

Begin: Mounting root file system... ...
Begin: Running /scripts/local-top ...
Enter LUKS passphrase:

Во время ввода ключевой фразы символы не отображаются (даже звёздочками). Если
вы введёте неверную ключевую фразу, то у вас ещё есть две попытки. После
третьей попытки процесс загрузки пропустит этот том и начнётся монтирование
следующей файловой системы. Подробней смотрите в Раздел 7.2.1, «Устранение
неполадок».

После ввода всех ключевых фраз загрузка продолжится как обычно.

7.2.1. Устранение неполадок

Если некоторые шифрованные тома не были смонтированы из-за ввода неправильной
ключевой фразы, их можно смонтировать вручную после загрузки. Но есть несколько
случаев.

  • Первый случай касается корневого раздела. Если он не смонтирован, то
    процесс загрузки остановится, а вам придётся перезагрузить компьютер, чтобы
    попробовать ещё раз.

  • Самый простой случай -- шифрованные тома с данными /home или /srv. Вы
    можете просто смонтировать их вручную после загрузки машины.

    Для dm-crypt немного сложнее. Во-первых, вам нужно зарегистрировать тома с
    помощью device mapperвыполнив:

    # /etc/init.d/cryptdisks start

    Эта операция просканирует все тома, указанные в /etc/crypttab, и создаст
    соответствующие устройства в каталоге /dev после ввода правильных ключевых
    фраз (тома, зарегистрированные ранее, будут пропущены, поэтому вы можете
    спокойно запускать эту команду несколько раз). После успешной регистрации
    вы можете смонтировать тома как обычно:

    # mount /точка_монтирования

  • Если на любых несмонтированных томах содержатся некритичные системные файлы
    (/usr или /var), система должна загрузиться и вы сможете смонтировать тома
    вручную как в предыдущем случае. Однако, может потребоваться (пере)запуск
    каждой службы, которая обычно запускается на уровне выполнения по
    умолчанию, так как, скорее всего, они не смогли запуститься. Самый простой
    способ сделать это -- просто перезагрузить компьютер.

7.3. Вход в систему

После загрузки системы будет показано приглашение к входу в систему. Для входа
используйте персональный логин и пароль, которые вы указали во время процесса
установки. Система готова к работе.

Если вы новичок, то начните с просмотра документации, которая уже установлена в
системе. Есть несколько систем документации, продолжается работа над их
объединением. Вот несколько мест, откуда можно начать.

Документация на установленные программы находится в /usr/share/doc/ в
подкаталоге с именем этой программы (точнее, с именем пакета Debian, в котором
содержится эта программа). Однако более полная документация часто упакована
отдельно в специальные пакеты с документацией, которые по умолчанию не
устанавливаются. Например, документацию на программу управления пакетами apt
можно найти в пакетах apt-doc или apt-howto.

Также, /usr/share/doc/ содержит несколько специальных каталогов. Linux HOWTO
установлены в формате .gz в каталог /usr/share/doc/HOWTO/en-txt/. После
установки dhelp появляется файл /usr/share/doc/HTML/index.html со ссылками на
документацию.

Простой способ просмотреть эту документацию -- запустить текстовый браузер с
помощью команд:

$ cd /usr/share/doc/
$ w3m .

Точка после команды w3m служит для показа содержимого текущего каталога.

Если у вас установлено графическое окружение рабочего стола, то также вы можете
использовать веб-браузер. Запустите веб-браузер из меню приложений и введите /
usr/share/doc/ в строке адреса.

Также вы можете набрать info команда или man команда, чтобы получить
документацию по большинству команд доступных в командной строке. Набрав help,
вы увидите помощь по командам интерпретатора командной строки. А при вводе
имени команды с параметром --help обычно выдаётся короткая справка по
использованию программы. Если начало результата выполнения команды уехало за
пределы экрана, добавьте | more после команды, и это включит паузу при
заполнении всего экрана. Чтобы увидеть список всех доступных команд,
начинающихся с определённого символа, введите символ и нажмите клавишу
табуляции два раза.

Глава 8. Следующие шаги и что делать дальше

Содержание

8.1. Выключение системы
8.2. Самостоятельное ориентирование в Debian
    8.2.1. Система управления пакетами Debian
    8.2.2. Дополнительное программное обеспечение для Debian
    8.2.3. Управление версиями приложений
    8.2.4. Управление заданиями cron
8.3. Что почитать
8.4. Настройка почты
    8.4.1. Почтовая конфигурация по умолчанию
    8.4.2. Отправка почты из системы
    8.4.3. Настройка агента пересылки почты Exim4
8.5. Сборка нового ядра
8.6. Восстановление неработающей системы

8.1. Выключение системы

Чтобы выключить работающую Debian GNU/Linux систему, вы не должны использовать
кнопку сброса на передней панели корпуса компьютера или просто выключать
электропитание. Debian GNU/Linux нужно выключать правильно, иначе можно
потерять файлы и/или повредить жёсткий диск. Если вы работаете в окружении
рабочего стола, то обычно есть возможность «завершить сеанс» из меню
приложений, которая позволяет выключить (или перезагрузить) систему.

Также можно нажать комбинацию клавиш Ctrl+Alt+Del . Если комбинация клавиш не
работает или вы предпочитаете вводить команды, то как последний вариант можно
войти в систему как суперпользователь и выполнить необходимые команды. Для
перезагрузки используйте reboot. Для останова системы без последующего
включения используйте halt ^[15]. Для выключения питания машины используйте 
poweroff или shutdown -h now. Система инициализации systemd предоставляет
дополнительные команды, которые выполняют эти же функции; например, systemctl
reboot или systemctl poweroff.

8.2. Самостоятельное ориентирование в Debian

Debian слегка отличается от других дистрибутивов. Даже если вы знакомы с
другими дистрибутивами Linux, есть вещи, которые вы должны знать о Debian,
чтобы поддерживать систему в рабочем состоянии. Эта глава содержит материалы,
которые помогут вам ориентироваться; она не является руководством по
использованию Debian, она всего лишь кратко описывает систему для занятых
людей.

8.2.1. Система управления пакетами Debian

Наиболее важно разобраться в системе управления пакетами Debian. В сущности,
большая часть системы находится под контролем системы управления пакетами. Сюда
входят:

  • /usr (кроме /usr/local)

  • /var (вы можете сделать /var/local, там меняться ничего не будет)

  • /bin

  • /sbin

  • /lib

Например, если вы замените /usr/bin/perl, он будет работать, но позже, если вы
обновите пакет perl, файл, который вы положили будет заменён. Эксперты могут
обойти это, установив на пакеты флаг «hold» в aptitude.

One of the best installation methods is apt. You can use the command line
version of apt as well as tools like aptitude or synaptic (which are just
graphical frontends for apt). Note that apt will also let you merge main,
contrib, non-free, and non-free-firmware so you can have restricted packages
(strictly speaking not belonging to Debian) as well as packages from Debian GNU
/Linux at the same time.

8.2.2. Дополнительное программное обеспечение для Debian

Есть официальные и неофициальные репозитории ПО, которые не не включены в
установку Debian по умолчанию. В них содержится ПО, которое многие считают
полезным и хотели бы его иметь. Информацию о дополнительных репозиториях можно
найти на вики-странице Debian The Software Available for Debian's Stable
Release.

8.2.3. Управление версиями приложений

Альтернативность версий приложений управляется с помощью программы
update-alternatives. Если вы работаете с несколькими версиями одного
приложения, прочитайте страницу руководства к update-alternatives.

8.2.4. Управление заданиями cron

Любые работы относящиеся к администрированию системы должны проводится в
каталоге /etc, так как там расположены конфигурационные файлы. Если у вас есть
ежедневные, еженедельные или ночные задания cron для суперпользователя,
поместите их в каталог /etc/cron.{daily,weekly,monthly}. Они вызываются из /etc
/crontab и запускаются в алфавитном порядке.

С другой стороны, если задания: (а) нужно запускать от определённого
пользователя или (b) нужно запустить в определённое время или с определённой
частотой, вы можете использовать или /etc/crontab, или, что лучше, /etc/cron.d/
имя_задания. Это особые файлы, они содержат дополнительное поле, позволяющее
вам указать учётную запись пользователя, от которого будет выполняться задание
cron.

В любом случае, просто отредактируйте файлы, и cron обнаружит эти изменения
автоматически. Не нужно запускать специальную команду. Подробная информация
доступна в cron(8), crontab(5) и /usr/share/doc/cron/README.Debian.

8.3. Что почитать

Веб-сайт Debian содержит огромное количество документации по Debian. В
частности, посмотрите Debian GNU/Linux FAQ и Справочник по Debian. Каталог
документации Debian находится по адресуПроект Документации Debian. Можно
обратиться с вопросом к сообществу Debian подписавшись на один или более
списков рассылки Debian Подписка на списки рассылки. Также, не последнее место
занимают Архивы списков рассылки Debian, содержащие ценную информацию о Debian.

Если вам требуется информация по определённой программе, сначала, попробуйте
выполнить man название программы или info название программы.

Также, есть много полезной документации в каталоге /usr/share/doc. В частности,
в каталогах /usr/share/doc/HOWTO и /usr/share/doc/FAQ содержится море
интересных сведений. Информацию об ошибках смотрите в /usr/share/doc/debian/
bug*. Отличия в работе определённой программы, касающиеся Debian, смотрите в
файле /usr/share/doc/(имя пакета )/README.Debian.

Общая информация о GNU/Linux есть в проекте документации Linux. Здесь вы
найдёте разные HOWTO и ссылки на другие превосходные источники информации на
компоненты системы GNU/Linux.

Linux является реализацией Unix. В Linux Documentation Project (LDP) собран
набор HOWTO и книг о Linux.

Если вы новичок в Unix, то, вероятно, вам стоит купить несколько книг и
что-нибудь почитать. В списке Unix FAQs содержатся ссылки на некоторые
интересные исторические документы UseNet.

8.4. Настройка почты

Сегодня электронная почта (email) -- это очень важная часть жизни многих людей.
Так как при настройке почты используется много параметров, а правильность
настройки влияет на многие программы в Debian, в этом разделе мы попытаемся
описать основные моменты настройки.

Почтовая система состоит из трёх частей. Первая: пользовательский почтовый
агент [Mail User Agent] (MUA) -- это программа, с которой работает пользователь
для написания и чтения писем. Вторая: агент пересылки почты [Mail Transfer
Agent] (MTA) -- отвечает за пересылку сообщений между компьютерами. Третья:
агент доставки почты [Mail Delivery Agent] (MDA) -- отвечает за доставку
входящей почты в почтовый ящик пользователя.

Данные части могут выполняться разными программами, но могут быть и объединены
в одной или двух программах. Также можно настроить, чтобы разные виды почты
обрабатывались разными программами.

Исторически, в системах Linux и Unix очень популярным MUA является mutt. Как и
большинство классических программ Linux он имеет текстовый интерфейс. Часто он
используется в связке с exim или sendmail, работающих в качестве MTA и procmail
в качестве MDA.

С ростом популярности систем с графическим рабочим столом, становятся более
востребованными почтовые программы с графическим интерфейсом типа GNOME 
evolution, KDE kmail или Mozilla thunderbird. В этих программах объединены
функции MUA, MTA и MDA, но они могут (так часто и происходит) использоваться
совместно с классическими утилитами Linux.

8.4.1. Почтовая конфигурация по умолчанию

Even if you are planning to use a graphical mail program, it would be useful,
to have a traditional MTA/MDA installed and correctly set up on your Debian GNU
/Linux system. Reason is that various utilities running on the system^[16] can
send important notices by e-mail to inform the system administrator of
(potential) problems or changes.

For this you can install exim4 and mutt with apt install exim4 mutt. exim4 is a
combination MTA/MDA that is relatively small but very flexible. By default it
will be configured to only handle e-mail local to the system itself and e-mails
addressed to the system administrator (root account) will be delivered to the
regular user account created during the installation^[17].

При доставке почты она добавляется в файл /var/mail/учётная_запись. Почту можно
читать с помощью mutt.

8.4.2. Отправка почты из системы

Как было упомянуто ранее, установленная система Debian настроена для обработки
только локальной почты, она не может отправлять или принимать почту от других
систем.

Если вы хотите, чтобы exim4 обрабатывал внешнюю почту, перейдите в следующий
подраздел, в котором описаны основные параметры настройки. Обязательно
протестируйте приём и отправку почтовых сообщений.

Если вы будете использовать почтовую программу с графическим интерфейсом с
почтовым сервером вашего провайдера интернет (ISP) или вашей компании, то
необязательно настраивать exim4 для обработки внешней почты. Просто укажите в
любимой почтовой программе с графическим интерфейсом нужные серверы для
отправки и приёма сообщений (не описано в данном руководстве).

Однако, в этом случае вам потребуется правильно настроить отдельные утилиты,
чтобы они могли отправлять почту. Одной из таких утилит является reportbug,
программа для отправки сообщений об ошибках в пакетах Debian. По умолчанию, она
настроена на использование exim4.

Чтобы правильно настроить reportbug на использование внешнего почтового
сервера, запустите команду reportbug --configure и ответьте «нет» на вопрос о
доступности MTA. Затем вас попросят указать сервер SMTP, который нужно
использовать для отправки сообщений об ошибках.

8.4.3. Настройка агента пересылки почты Exim4

Если вы хотите, чтобы система также работала с внешней почтой, то вам нужно
перенастроить пакет exim4^[18]:

# dpkg-reconfigure exim4-config

После ввода этой команды (имея права суперпользователя), вас спросят, хотите ли
вы разделить конфигурацию на маленькие файлы. Если не знаете что делать,
выберите установку по умолчанию.

Затем вам будет предложено несколько общих почтовых сценариев. Выберите тот,
который подходит вам больше всего.

интернет-сайт

    Ваша система подключена к сети, почта отправляется и получается напрямую по
    протоколу SMTP. На следующих экранах вам зададут несколько основных
    вопросов, таких как почтовое имя вашей машины или список доменов, для
    которых вы принимаете или передаёте почту.

отправка почты через компьютер-шлюз (smarthost)

    По этому сценарию ваша исходящая почта переправляется на другую машину,
    называемую «smarthost», которая и отправит письмо по назначению. Smarthost
    обычно ещё и хранит входящую почту, адресованную вашему компьютеру, так что
    вам не надо постоянно находиться в сети. Это также означает, что вам нужно
    загружать почту со smarthost с помощью программ типа fetchmail.

    В большинстве случаев, в качестве smarthost используется почтовый сервер
    вашего ISP, что очень подходит пользователям, которые используют модемное
    подключение по телефонной линии. Также это может быть почтовый сервер
    компании или другая система в вашей сети.

отправка почты через smarthost; локальная почта отсутствует

    То же самое, что и предыдущее значение, кроме того, что система не будет
    настроена на обработку почты локального домена. Почта от самой системы
    (например, для системного администратора) всё равно будет обработана.

доставка только локальной почты

    Настроено в системе по умолчанию.

в данный момент конфигурация отсутствует

    Выберите этот вариант, если вы абсолютно уверены в том, что делаете. Это
    оставит вас с ненастроенной почтовой системой; до тех пор пока вы не
    настроите её, вы не сможете отправлять или получать почту и вы можете
    пропустить некоторые важные сообщения от ваших системных утилит.

Если ни один из этих сценариев не подходит, или нужна более тонкая настройка,
то после завершения установки вам нужно отредактировать файлы конфигурации в
каталоге /etc/exim4. Дополнительную информацию про exim4 можно найти в каталоге
/usr/share/doc/exim4; в файле README.Debian.gz содержатся дополнительные
подробности о настройке exim4 и указано где найти дополнительную документацию.

Заметим, что если у вас нет официального доменного имени и вы отправляете почту
в интернет напрямую, это может привести к тому, что ваша почта не будет
приниматься серверами, так как на них установлены средства борьбы со спамом.
Предпочтительней использовать почтовый сервер ISP. Если вы всё равно хотите
отправлять почту напрямую, то вам нужно использовать другой почтовый адрес, а
не сгенерированный по умолчанию. Если в качестве MTA используется exim4, это
это делается добавлением записи в файл /etc/email-addresses.

8.5. Сборка нового ядра

Может ли потребоваться компиляция нового ядра? Вероятно, в этом нет
необходимости, так как поставляемое в Debian ядро по умолчанию содержит почти
все возможности.

Тем не менее, если вы хотите собрать ядро самостоятельно, это возможно и мы
рекомендуем использовать цель «make deb-pkg». Подробней об этом читайте в
Debian Linux Kernel Handbook.

8.6. Восстановление неработающей системы

Иногда что-то идёт неправильно, и система, которую вы аккуратно установили
больше не загружается. Возможно, испортились настройки системного загрузчика во
время изменения, или не хочет загружаться новое ядро, или космические лучи
попали в жёсткий диск и исправили единичку на нолик в файле /sbin/init. В любом
случае, вам нужна система с которой можно всё исправить, и режим восстановления
может помочь в этом.

Чтобы войти в режим восстановления, выберите rescue в загрузочном меню, введите
rescue после приглашения boot: или загрузитесь с параметром загрузки rescue/
enable=true . В начале вы пройдёте по нескольким диалогам программы установки,
на которых есть пометка в углу экрана, что это режим восстановления, а не
полная установка. Не волнуйтесь, ваши данные не исчезнут! Режим восстановления
использует программу установки только для определения имеющихся устройств,
таких как диски и сетевые устройства, и они будут доступны во время
восстановления системы.

Вместо программы разметки, вам покажут список разделов, имеющихся в системе,
попросят выбрать один из них. Обычно, нужно выбрать раздел, содержащий корневую
систему, которую нужно восстановить. Кроме созданных непосредственно на дисках,
вы можете выбирать разделы на устройствах RAID и LVM.

Если возможно, программа установки запустит оболочку командной строки в
выбранной файловой системе, где вы сможете провести любые дополнительные
процедуры восстановления. Например, для переустановки системного загрузчика
GRUB в главную загрузочную запись первого жёсткого диска, введите команду
grub-install '(hd0)'.

Иногда программе установки не удаётся запустить оболочку командной строки в
выбранной корневой файловой системе. Возможной причиной может быть повреждение
файловой системы, и в этом случае выдаётся предупреждение и предлагается
запустить оболочку командной строки в среде программы установки. Здесь не так
много полезных программ, но и их часто достаточно для восстановления системы.
Выбранная корневая файловая система будет смонтирована в каталог /target.

В обоих случаях, после выхода из оболочки командной строки система будет
перезагружена.

И напоследок заметим, что восстановление нерабочей системы может оказаться
очень трудным делом, и это руководство не пытается описать все возможные
случаи, которые могут произойти и способы их решения. Если у вас есть проблемы
-- обратитесь к профессионалам.


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[15] В системе инициализации SysV halt выполняет тоже действие, что и poweroff
, но при системе инициализации systemd (по умолчанию начиная с jessie) это не
так.

^[16] Examples are: cron, quota, logcheck, aide, ...

^[17] The forwarding of mail for root to the regular user account is configured
in /etc/aliases. If no regular user account was created, the mail will of
course be delivered to the root account itself.

^[18] Конечно, также вы можете удалить exim4 и заменить его другим MTA/MDA.

Приложение A. Краткая инструкция по установке

Содержание

A.1. Предварительные сведения
A.2. Загрузка программы установки
    A.2.1. Optical disc
    A.2.2. Загрузка с карты памяти USB
    A.2.3. Загрузка по сети
    A.2.4. Загрузка с жёсткого диска
A.3. Установка
A.4. Отправьте нам отчёт об установке
A.5. И напоследок...

Данный документ описывает установку Debian GNU/Linux trixie на 64-bit PC («
amd64») с помощью нового debian-installer. Это краткое описание процесса
установки, в нём содержится вся информация, необходимая для большинства
установок. В тех местах, где полезно прочитать более обширное описание, будет
приведена ссылка на соответствующую главу этого документа.

A.1. Предварительные сведения

If you encounter bugs during your install, please refer to Раздел 5.4.7,
«Отправка отчётов об ошибках установки» for instructions on how to report them.
If you have questions which cannot be answered by this document, please direct
them to the debian-boot mailing list (debian-boot@lists.debian.org) or ask on
IRC (#debian-boot on the OFTC network).

A.2. Загрузка программы установки

The debian-cd team provides builds of installation images using
debian-installer on the Debian CD/DVD page. For more information on where to
get installation images, see Раздел 4.1, «Official Debian GNU/Linux
installation images».

Some installation methods require other images than those for optical media.
Раздел 4.2.1, «Where to Find Installation Files» explains how to find images on
Debian mirrors.

В следующих подразделах указано, какие образы требуются для каждого конкретного
вида установки.

A.2.1. Optical disc

The netinst CD image is a popular image which can be used to install trixie
with the debian-installer. This installation method is intended to boot from
the image and install additional packages over a network; hence the name «
netinst». The image has the software components needed to run the installer and
the base packages to provide a minimal trixie system. If you'd rather, you can
get a DVD image which will not need the network to install. You only need the
first image of such set.

Download whichever type you prefer and burn it to an optical disc. To boot the
disc, you may need to change your BIOS/UEFI configuration, as explained in
Раздел 3.6.1, «Invoking the BIOS/UEFI Set-Up Menu».

A.2.2. Загрузка с карты памяти USB

Также возможна установка со съёмных USB устройств хранения. Например, из
USB-брелка можно сделать удобный носитель установки Debian, который можно взять
с собой куда угодно.

The easiest way to prepare your USB memory stick is to download any Debian CD
or DVD image that will fit on it, and write the image directly to the memory
stick. Of course this will destroy anything already on the stick. This works
because Debian CD/DVD images are «isohybrid» images that can boot both from
optical and USB drives.

There are other, more flexible ways to set up a memory stick to use the
debian-installer, and it's possible to get it to work with smaller memory
sticks. For details, see our wiki.

While booting from USB storage is quite common on UEFI systems, this is
somewhat different in the older BIOS world. Some BIOSes can boot USB storage
directly, and some cannot. You may need to configure your BIOS/UEFI to enable «
USB legacy support» or «Legacy support». The boot device selection menu should
show «removable drive» or «USB-HDD» to get it to boot from the USB device. For
helpful hints and details, see Раздел 5.1.1, «Загрузка с карты памяти USB».

A.2.3. Загрузка по сети

debian-installer можно загрузить полностью из сети. Методы загрузки по сети
(netboot) зависят от архитектуры и настройки сетевой загрузки. Файлы для
загрузки debian-installer по сети лежат в каталоге netboot/.

Вероятно, проще всего будет настроить сетевую загрузку с помощью PXE.
Распакуйте файл netboot/pxeboot.tar.gz в /srv/tftp или в соответствующий
каталог вашего сервера tftp. Настройте сервер DHCP для передачи имени файла
pxelinux.0 клиентам и всё должно заработать. Подробную инструкцию смотрите в
Раздел 4.5, «Подготовка файлов для загрузки по TFTP».

A.2.4. Загрузка с жёсткого диска

It's possible to boot the installer using no removable media, but just an
existing hard disk, which can have a different OS on it. Download hd-media/
initrd.gz, hd-media/vmlinuz, and a Debian DVD image to the top-level directory
of the hard disk. Make sure that the image has a filename ending in .iso. Now
it's just a matter of booting linux with the initrd. Раздел 5.1.3, «Booting
from Linux using GRUB» explains one way to do it.

A.3. Установка

После запуска программа установки выводит приветствие. Нажмите Enter для
загрузки, или прочитайте инструкции про другие методы загрузки и параметры
(смотрите Раздел 5.3, «Параметры загрузки»).

Через некоторое время вас попросят выбрать язык. Используйте клавиши управления
курсором для выбора языка и нажмите Enter, чтобы продолжить. Затем вас попросят
выбрать страну из списка стран, где говорят на этом языке. Если её нет в
коротком списке, то доступен список стран всего мира.

Вас могут попросить выбрать раскладку клавиатуры. Выберите предлагаемую по
умолчанию, если не знаете какая лучше.

Now sit back while debian-installer detects some of your hardware, and loads
the rest of the installation image.

Затем программа установки попытается определить сетевое аппаратное обеспечение
и настроить сеть с помощью DHCP. Если у вас нет сети или вы не имеете DHCP, то
вам будет предложено настроить сеть вручную.

Setting up the network is followed by the creation of user accounts. By default
you are asked to provide a password for the «root» (administrator) account and
information necessary to create one regular user account. If you do not specify
a password for the «root» user, this account will be disabled but the sudo
package will be installed later to enable administrative tasks to be carried
out on the new system. By default, the first user created on the system will be
allowed to use the sudo command to become root.

Затем настраиваются часовой пояс и время. Программа установки попытается
подключиться к серверу времени в Интернет, чтобы проверить точность времени
компьютера. Часовой пояс выбирается на основе ранее указанной вами страны, и
программа установки попросит вас указать его явно только, если страна
расположена в нескольких часовых поясах.

Теперь пришло время разметки дисков. Сначала вам предложат автоматическую
разметку всего диска или только свободного пространства (см. Раздел 6.3.4.2,
«Направляющая разметка»). Этот режим рекомендуется для новичков или спешащих
людей. Если вы не хотите авторазметку, выберите в меню пункт Вручную.

If you have an existing Windows partition that you want to preserve, be very
careful with automatic partitioning. If you choose manual partitioning, you can
use the installer to resize existing FAT or NTFS partitions to create room for
the Debian install: simply select the partition and specify its new size.

На следующем экране вы увидите текущую таблицу разделов, формат разделов и куда
они будут монтироваться. Выберите раздел для изменения или удаления. Если вы
выбрали автоматическую разметку, то вам доступен только пункт меню Закончить
разметку и записать изменения на диск, нажав на который вы подтвердите
изменения. Не забудьте назначить по крайней мере один раздел для подкачки и
смонтировать один раздел в качестве корневого раздела /. В Раздел 6.3.4,
«Разметка разделов и выбор точек монтирования» подробно описано как
использовать программу разметки; в Приложение C, Разметка дисков в Debian
рассказано более подробно о процедуре разметки.

Далее debian-installer отформатирует разделы и начнёт установку базовой
системы, что может занять некоторое время. Затем устанавливается ядро.

The base system that was installed earlier is a working, but very minimal
installation. To make the system more functional the next step allows you to
install additional packages by selecting tasks. Before packages can be
installed apt needs to be configured as that defines from where the packages
will be retrieved. The «Standard system utilities» task will be selected by
default and should normally be installed. Select the «Desktop environment» task
if you would like to have a graphical desktop after the installation. See
Раздел 6.3.6.2, «Выбор и установка программного обеспечения» for additional
information about this step.

The last step is to install a boot loader. If the installer detects other
operating systems on your computer, it will add them to the boot menu and let
you know. By default GRUB will be installed to the UEFI partition/boot record
of the primary drive, which is generally a good choice. You'll be given the
opportunity to override that choice and install it elsewhere.

Далее debian-installer скажет, что установка завершена. Вытащите компакт-диск
или другой носитель с программой установки и нажмите Enter для перезагрузки
машины. После этого должна произойти загрузка в установленную систему и
появиться приглашение к входу в систему. Это описано в Глава 7, Загрузка только
что установленной системы Debian.

Если вам требуется дополнительная информация по процессу установки, посмотрите
Глава 6, Использование программы установки Debian.

A.4. Отправьте нам отчёт об установке

Если вы успешно справились с установкой с помощью debian-installer, пожалуйста,
найдите время и отправьте нам отчёт. Самый простой путь отправки отчёта --
установить пакет reportbug (apt install reportbug), настроить reportbug по
описанию из Раздел 8.4.2, «Отправка почты из системы» и запустить команду 
reportbug installation-reports.

Если завершить установку не получилось, то вероятно вы обнаружили ошибку в
debian-installer. Для улучшения программы установки необходимо, чтобы мы узнали
об этом, поэтому, пожалуйста, сообщите об ошибке. Вы можете использовать отчёт
об установке, чтобы сообщить о проблеме; если установить вообще ничего не
удалось, смотрите Раздел 5.4.6, «Сообщение о проблемах при установке».

A.5. И напоследок...

Мы надеемся, что установка Debian была несложной и что вы найдёте Debian
полезным. Вероятно, вам пригодится информация из Глава 8, Следующие шаги и что
делать дальше.

Приложение B. Автоматическая установка с помощью списка ответов

Содержание

B.1. Введение
    B.1.1. Методы использования файла ответов
    B.1.2. Ограничения
B.2. Использование автоматической установки
    B.2.1. Загрузка файла ответов
    B.2.2. Использование параметров загрузки для автоматизации
    B.2.3. Автоматический режим
    B.2.4. Полезные в автоматизации псевдонимы
    B.2.5. Examples of boot prompt preseeding
    B.2.6. Использование сервера DHCP для указания файлов автоматической
    конфигурации
B.3. Создание файла ответов
B.4. Содержимое файла ответов (для trixie)
    B.4.1. Локализация
    B.4.2. Speech synthesis
    B.4.3. Настройка сети
    B.4.4. Сетевая консоль
    B.4.5. Настройка сервера-зеркала
    B.4.6. Настройка учётной записи
    B.4.7. Настройка времени и часового пояса
    B.4.8. Разметка дисков
    B.4.9. Установка базовой системы
    B.4.10. Настройка Apt
    B.4.11. Выбор пакетов
    B.4.12. Установка загрузчика
    B.4.13. Завершение установки
    B.4.14. Автоматизация других пакетов
B.5. Дополнительные параметры
    B.5.1. Запуск пользовательских команд во время установки
    B.5.2. Использование автоматической установки для изменения значений по
    умолчанию
    B.5.3. Последовательная загрузка нескольких файлов ответов

В этом приложении описывается файл ответов на вопросы, который используется
debian-installer для автоматизации установки операционной системы.

Фрагменты конфигурации, используемые в этом приложении, также доступны в
примере файла ответов ../example-preseed.txt.

B.1. Введение

Автоматическая установка позволяет автоматизировать ручной ввод ответов на
вопросы программы установки. Это даёт возможность автоматизации наиболее
типичных установок, а также предоставляет дополнительные возможности,
недоступные во время обычной установки.

Автоматическая установка не является обязательной. Если вы укажите пустой файл
ответов, то программа установки станет работать также, как при установке
вручную. Каждый автоматический ответ на вопрос меняет (если поняли его
правильно!) ход установки.

B.1.1. Методы использования файла ответов

Есть три метода использования для автоматизации: initrd, файловый и сетевой.
Метод initrd работает при любом способе установки системы и поддерживает ответы
на большинство вопросов, но он наиболее трудоёмок. Файловый и сетевой методы
могут использоваться при различных способах установки.

В следующей таблице показано соответствие методов автоматической установки со
способами установки операционной системы.

┌────────────────────────────────────────────┬────────┬────────────┬──────────┐
│          способ установки системы          │ initrd │  файловый  │ сетевой  │
├────────────────────────────────────────────┼────────┼────────────┼──────────┤
│CD/DVD/USB                                  │да      │да          │да^[a]    │
├────────────────────────────────────────────┼────────┼────────────┼──────────┤
│netboot                                     │да      │нет         │да        │
├────────────────────────────────────────────┼────────┼────────────┼──────────┤
│hd-media (включая usb-носители)             │да      │да          │да^[a]    │
├────────────────────────────────────────────┴────────┴────────────┴──────────┤
│^[a] только если есть подключение к сети и указан соответствующий preseed/url│
└─────────────────────────────────────────────────────────────────────────────┘

An important difference between the preseeding methods is the point at which
the preconfiguration file is loaded and processed. For initrd preseeding this
is right at the start of the installation, before the first question is even
asked. Preseeding from the kernel command line happens just after. It is thus
possible to override configuration set in the initrd by editing the kernel
command line (either in the bootloader configuration or manually at boot time
for bootloaders that allow it). For file preseeding this is after the
installation image has been loaded. For network preseeding it is only after the
network has been configured.

Важно

Очевидно, что на любые вопросы, задаваемые перед загрузкой файла ответов,
нельзя указать готовые ответы (сюда включаются вопросы, которые задаются только
на среднем и низком уровне важности, например запуск определения аппаратуры). И
не существует удобного способа избежать этих вопросов кроме указания ответов на
них через параметры загрузки, как описано в Раздел B.2.2, «Использование
параметров загрузки для автоматизации».

Чтобы просто избежать вопросов, которые обычно задаются перед тем как начнёт
действовать автоматизация ответов, вы можете запустить программу установки в
режиме «auto». Это позволит отложить вопросы, которые обычно задаются перед
автоматической установкой (например, про язык, страну и выбор клавиатурной
раскладки), до появления работоспособной сети. Также этот режим используется
когда установка выполняется с критическим уровнем важности, что позволяет
избежать многих неважных вопросов. Подробней смотрите в Раздел B.2.3,
«Автоматический режим».

B.1.2. Ограничения

Хотя для большинства вопросов debian-installer могут быть заданы
предварительные ответы, есть несколько заметных исключений. Вы можете (пере)
разметить только весь диск или использовать только доступное место на диске;
невозможно задействовать существующие разделы.

B.2. Использование автоматической установки

You will first need to create a preconfiguration file and place it in the
location from where you want to use it. Creating the preconfiguration file is
covered later in this appendix. Putting it in the correct location is fairly
straightforward for network preseeding or if you want to read the file off a
usb-stick. If you want to include the file in an installation ISO image, you
will have to remaster the image. How to get the preconfiguration file included
in the initrd is outside the scope of this document; please consult the
developers' documentation for debian-installer.

Пример файла ответов, который можно взять за основу доступен здесь ../
example-preseed.txt. Данный файл основан на фрагментах конфигурации, включённых
в это приложение.

B.2.1. Загрузка файла ответов

Если используется метод initrd, то нужно убедиться, что файл с именем
preseed.cfg лежит в корневом каталоге initrd. Программа установки автоматически
проверяет наличие этого файла и загружает его.

For the other preseeding methods you need to tell the installer what file to
use when you boot it. This is normally done by passing the kernel a boot
parameter, either manually at boot time or by editing the bootloader
configuration file (e.g. syslinux.cfg) and adding the parameter to the end of
the append line(s) for the kernel.

Если вы указываете файл ответов в настройке системного загрузчика, то можно
изменить конфигурацию таким образом, чтобы не нажимать клавишу ввод для
загрузки программы установки. Для syslinux это достигается установкой timeout
равным 1 в файле syslinux.cfg.

Чтобы убедиться, что программа установки получила правильный файл ответов,
можно дополнительно указать контрольную сумму файла. Это значение вычисляется с
помощью md5sum, и если его указать, то оно должно соответствовать указываемому
файлу, иначе программа установки не будет использовать данный файл.

Boot parameters to specify:
- if you're netbooting:
  preseed/url=http://host/path/to/preseed.cfg
  preseed/url/checksum=5da499872becccfeda2c4872f9171c3d
- or
  preseed/url=tftp://host/path/to/preseed.cfg
  preseed/url/checksum=5da499872becccfeda2c4872f9171c3d

- if you're booting a remastered installation image:
  preseed/file=/cdrom/preseed.cfg
  preseed/file/checksum=5da499872becccfeda2c4872f9171c3d

- if you're installing from USB media (put the preconfiguration file in the
  toplevel directory of the USB stick):
  preseed/file=/hd-media/preseed.cfg
  preseed/file/checksum=5da499872becccfeda2c4872f9171c3d

Заметим, что preseed/url можно укоротить до url, preseed/file -- до file, а
preseed/file/checksum -- од preseed-md5, если они передаются в параметрах
загрузки.

B.2.2. Использование параметров загрузки для автоматизации

Если файл ответов не может быть использован для автоматизации некоторых шагов,
установку всё ещё можно сделать полностью автоматической, передав нужные
значения ответов в командной строке запуска программы установки.

Параметры загрузки также можно использовать не только для автоматизации
установки, а просто для того, чтобы указать ответ на определённый вопрос.
Несколько примеров такого использования есть в разных местах этого руководства.

Чтобы установить значение, используемое внутри debian-installer, просто укажите
путь/до/переменная=значение для любой автоматизируемой переменной, описанной в
примерах в этом приложении. Если значение будет использоваться для настройки
пакетов в устанавливаемой системе, то нужно перед переменной указывать владелец
^[19], например, владелец:путь/до/переменной=значение. Если вы не указываете
владельца, то значение переменной не копируется в базу данных debconf
устанавливаемой системы и поэтому не будет использоваться во время настройки
соответствующего пакета.

Обычно, автоматизация ответов приводит к тому, что вопрос задан не будет. Чтобы
установить для вопроса ответ по умолчанию и оставить вопрос задаваемым,
используйте в качестве оператора «?=» вместо «=». Смотрите также Раздел B.5.2,
«Использование автоматической установки для изменения значений по умолчанию».

Заметим, что для некоторых переменных, которые часто задаются в приглашении
загрузчика, имеются короткие названия. Если имеется короткое название, то оно
используется в примерах в этом приложении вместо полного имени переменной.
Например, переменная preseed/url сокращается до url. Ещё пример: псевдоним
tasks раскрывается в tasksel:tasksel/first.

Обозначение «---» в параметрах загрузки имеет специальное значение. Параметры
ядра, указанные после «---», могут быть скопированы в конфигурацию
установленного системного загрузчика (если это умеет программа установки для
загрузчика). Программа установки автоматически фильтрует все параметры
(например, параметры предварительной настройки), которые распознаёт.

Примечание

В настоящее время ядра linux версии (2.6.9 и новее) максимально могут принять
32 параметра в командной строке и 32 параметра через переменные окружения,
считая все параметры, добавляемые программой установки по умолчанию. Если это
число превышено, то ядро прекращает работу с ошибкой. (Для ранних версий ядер
эти значения меньше.)

В большинстве установок некоторые параметры по умолчанию в файле конфигурации
загрузчика, типа vga=normal, можно безопасно удалить, что может позволить вам
добавить больше параметров автоматизации.

Примечание

Не всегда возможно задать значения с пробелами в параметрах загрузки, даже если
заключить их в кавычки.

B.2.3. Автоматический режим

Есть несколько возможностей программы установки Debian, объединив которые с
помощью простых команд в приглашении к загрузке, можно получить автоматическую
установку любого уровня настраиваемости.

Это включается с помощью выбора Automated install при загрузке, также
называемом auto для некоторых архитектур или методов загрузки. В этом разделе
auto означает не параметр, а выбор метода загрузки и добавляется в загрузочные
параметры в приглашении к загрузке. О том, как добавлять загрузочные параметры,
смотрите Раздел 5.1.5, «Экран запуска».

Вот один из примеров использования настроек в приглашении к загрузке:

auto url=autoserver

В этом случае для установки согласно полученным настройкам с DHCP сервера будет
найдена машина autoserver из записей DNS, возможно к имени будет добавлено имя
локального домена, если он передаётся в DHCP. Если в сети используется доменное
имя example.com, и этот домен передаётся по DHCP, то в результате файл с
ответами будет получен с http://autoserver.example.com/d-i/trixie/./
preseed.cfg.

Последняя часть этого url (d-i/trixie/./preseed.cfg) берётся из auto-install/
defaultroot. По умолчанию в него включён каталог trixie, чтобы для будущих
версий можно было задать своё название, что позволит людям контролировать
процесс перехода на новую версию. Часть /./ используется для указания корня,
относительно которого будут заданы остальные пути (для использования в preseed/
include и preseed/run). Это позволяет указывать файлы с полным URL (пути,
начинающиеся с /) или даже пути относительно места, где был найден последний
файл ответов. Это может быть использовано для написание более переносимых
сценариев, для того чтобы полное дерево сценариев можно было переместить в
новое место ничего при этом не сломав, например скопировать файлы на
USB-носитель, если ранее они брались с веб-сервера. Продолжая пример, если в
файле ответов значение preseed/run заменить на /scripts/late_command.sh, то
файл будет получен с http://autoserver.example.com/d-i/trixie/./scripts/
late_command.sh.

Если в сети нет локальных серверов DHCP или DNS, или, если вы не хотите
использовать пути по умолчанию к preseed.cfg, то вы всё ещё можете явно задать
url, и, если вы не используете элемент /./, то это будет началом пути (третий /
в URL). Вот пример, для которого нужна минимальная поддержка служб в локальной
сети:

auto url=http://192.168.1.2/path/to/mypreseed.file

Это работает так:

  • если в URL не указан протокол, то используется http,

  • если в имени машины нет точек, то будет добавлен домен, полученный по DHCP,
    и

  • если нет / после имени машины, то добавляется путь по умолчанию.

Также, помимо указания url, вы можете задать настройки, которые не влияют
напрямую на поведение самого debian-installer, но будут переданы во все
сценарии, заданные заданы с помощью preseed/run в загруженном файле ответов. В
настоящий момент, как пример использования, есть только auto-install/classes с
псевдонимом classes. Это можно использовать так:

auto url=example.com classes=class_A;class_B

classes, например, может означать тип устанавливаемой системы или используемую
локализацию.

Естественно, можно расширить эту концепцию, и если вы это делаете,имеет смысл
задействовать пространство имён auto-install. Это может выглядеть как
auto-install/style, что затем будет использовано в ваших сценариях. Если вы
думаете, что вам это нужно, напишите в список рассылки <
debian-boot@lists.debian.org>, для того чтобы мы смогли избежать конфликта
имён, и возможно, добавили псевдонимы для ваших параметров.

Выбор загрузки auto пока определён не для всех архитектур. Такой же эффект
можно получить просто добавив два параметра auto=true priority=critical в
командной строке параметров ядра. Параметр ядра auto -- это псевдоним для
auto-install/enable и установка его в trueзадерживает выдачу вопросов о локали
и клавиатуре, чтобы была возможность настроить их автоматически, а priority
является псевдонимом для debconf/priority, и установка в значение critical
заставляет программу установки не задавать вопросы с меньшим уровнем важности.

When an Automatic install is selected without also specifying a preseed
configuration, the user will be prompted to provide a preseed location.
Alternatively, if a preseed configuration has been specified, then that prompt
is normally suppressed in order to enable a fully non-interactive install.
However, if the intent is to modify defaults by using a preseed.cfg in an
initrd, then the result should really behave as though no preseeding has yet
been specified, even though it has. In that case, the debconf variable
auto-install/cloak_initrd_preseed can be set to true (e.g. in the initrd's
preseed.cfg). to get the required behaviour.

Для автоматизации с использованием DHCP могут пригодиться следующие
дополнительные параметры: interface=auto netcfg/dhcp_timeout=60, будет выбрана
первая рабочая сетевая карта, ответ на DHCP запрос будет ожидаться больше чем
обычно.

Подсказка

Большой пример использования данной интегрированной среды, включающий примеры
сценариев и классов, можно найти на сайте разработчика. На примерах с сайта
также показано много других замечательных эффектов, которых можно достичь, если
творчески подойти к процессу автоматизации.

B.2.4. Полезные в автоматизации псевдонимы

При использование автоматизации установки (режим auto) могут пригодиться
следующие псевдонимы. Заметим, что сокращаются только имена вопросов, и вам
всегда нужно указывать ещё и значение. Например, auto=true или interface=eth0.

priority               debconf/priority
fb                     debian-installer/framebuffer
auto                   auto-install/enable
classes                auto-install/classes
файловый               preseed/file
url                    preseed/url
theme                  debian-installer/theme
language               debian-installer/language
country                debian-installer/country
locale                 debian-installer/locale
keymap                 keyboard-configuration/xkb-keymap
modules                anna/choose_modules
firmware               hw-detect/firmware-lookup
interface              netcfg/choose_interface
domain                 netcfg/get_domain
hostname               netcfg/get_hostname
protocol               mirror/protocol
suite                  mirror/suite
recommends             base-installer/install-recommends
tasks                  tasksel:tasksel/first
desktop (рабочий стол) tasksel:tasksel/desktop
preseed-md5            preseed/file/checksum

B.2.5. Examples of boot prompt preseeding

Here are some examples of how the boot prompt might look like (you will need to
adapt this to your needs; also see Раздел 5.1.5, «Экран запуска»).

# To set French as language and France as country:
/install.amd/vmlinuz vga=788 initrd=/install.amd/gtk/initrd.gz language=fr country=FR --- quiet
# To set English as language and Germany as country, and use a German keyboard layout:
/install.amd/vmlinuz vga=788 initrd=/install.amd/gtk/initrd.gz language=en country=DE locale=en_US.UTF-8 keymap=de --- quiet
# To install the MATE desktop:
/install.amd/vmlinuz vga=788 initrd=/install.amd/gtk/initrd.gz desktop=mate-desktop --- quiet
# To install the web-server task:
/install.amd/vmlinuz initrd=/install.amd/initrd.gz tasksel:tasksel/first=web-server ---

B.2.6. Использование сервера DHCP для указания файлов автоматической
конфигурации

Также возможно использовать DHCP для указания файла автоматической
конфигурации, загружаемого по сети. DHCP позволяет указать имя файла. Обычно,
он указывается для способа установки по сети, но если он задан в виде URL, то
установочный носитель, который поддерживает автоматическую установку по сети,
загрузит файл с указанного в URL адреса и использует его как файл
автоматической установки. Вот пример, как можно настроить dhcpd.conf для
третьей версии сервера ISC DHCP (Debian пакет isc-dhcp-server).

if substring (option vendor-class-identifier, 0, 3) = "d-i" {
    filename "http://host/preseed.cfg";
}

Заметим, что пример выше ограничивает использование имени файла только DHCP
клиентами с идентификатором «d-i», поэтому он не влияет на простых DHCP
клиентов, а только на программу установки. Вы также можете поместить текст в
строфу указав определённую машину, чтобы избежать автоматизации всех установок
в сети.

При автоматизации с помощью DHCP лучше указывать только значения специфичные
для вашей сети, например, желаемые сервера-зеркала Debian. В этом случае при
установке по сети машины получат правильные сервера-зеркала, а оставшаяся
установка будет выполнена в интерактивном режиме. Использование DHCP для полной
автоматической установки Debian тоже возможна, но с большой осторожностью.

B.3. Создание файла ответов

Файл ответов аналогичен формату файла используемому программой 
debconf-set-selections. Общая форма строки файла ответов:

<владелец> <имя вопроса> <тип вопроса> <значение>

Файл должен начинаться с #_preseed_V1

При написании файла ответов есть несколько правил, которые нужно помнить.

  • Между типом и значением вставляйте только один пробел или отступ(tab):
    любой дополнительный пробельный символ будет включён в значение.

  • Строка может быть разбита на несколько строк, с помощью добавления
    обратного слеша («\») в конец строки. Хорошо разделять строку после имени
    вопроса; плохо -- между типом и значением. При обратном объединении
    нескольких строк все начальные/конечные пробельные символы будут сжаты в
    один.

  • Владельцем переменных debconf (шаблонов), используемых только в самой
    программе установки, нужно назначать «d-i»; для переменных автоматизации
    установки, используемых в установленной системе, должно использоваться имя
    пакета, содержащее соответствующий шаблон debconf. В базу данных debconf в
    установленной системе попадут только переменные, у которых владельцем
    установлено нечто, отличное от «d-i».

  • Для большинства вопросов нужно указывать ответы на английском языке, а не
    их перевод. Однако, есть несколько вопросов (например, в partman), где
    нужно использовать ответы на родном языке.

  • В ответах некоторых вопросов вместо английского текста указывается код,
    который показывается во время установки.

  • Начинайте с #_preseed_V1

  • A comment consists of a line which starts with a hash character («#») and
    extends up to the length of that line.

Самый простой путь создания файла ответов это использовать файл примера
Раздел B.4, «Содержимое файла ответов (для trixie)» в качестве основы и
изменить его.

Альтернативный метод -- выполнить установку вручную и затем, после
перезагрузки, использовать команду debconf-get-selections из пакета
debconf-utils, чтобы сохранить базу данных debconf и базу данных программы
установки cdebconf в один файл:

$ echo "#_preseed_V1" > файл
$ debconf-get-selections --installer >> файл
$ debconf-get-selections >> файл

Однако, таким образом созданный файл будет содержать некоторые элементы,которые
не должны быть автоматизированы, и всё-таки для большинства пользователей лучше
использовать файл примера.

Примечание

Этот метод основан на том, что в конце установки, база данных программы
установки cdebconf сохраняется в установленной системе в /var/log/installer/
cdebconf. Однако, так как база данных может содержать частную информацию, по
умолчанию файл разрешено читать только суперпользователю.

Каталог /var/log/installer и все файлы в нём будут удалены из системы при
вычистке пакета installation-report.

Для выяснения возможных ответов на вопросы можно использовать редактор nano для
просмотра файла /var/lib/cdebconf прямо во время процесса установки. В файле
templates.dat хранятся необработанные шаблоны, а в questions.dat -- текущие
значения и значения, назначенные переменным.

Для проверки правильности формата файла ответов до установки, можно
использовать команду debconf-set-selections -c preseed.cfg.

B.4. Содержимое файла ответов (для trixie)

Фрагменты конфигурации, используемые в этом приложении, также доступны в
примере файла ответов ../example-preseed.txt.

Заметим, что показанный пример основан на установке для архитектуры Intel x86.
Если вы выполняете установку на другую архитектуру, то некоторые примеры
(например, выбор клавиатуры и установка загрузчика) могут различаться и должны
быть заменены на соответствующие настройки debconf для этой архитектуры.

О том, как работают различные компоненты Debian Installer, можно найти в
Раздел 6.3, «Применение отдельных компонент».

B.4.1. Локализация

При обычной установке вопросы о локализации задаются первыми, поэтому их
значения можно указать только в методе initrd или параметрах загрузки ядра.
Автоматический режим (Раздел B.2.3, «Автоматический режим») включает настройку
auto-install/enable=true (обычно, через псевдоним auto). Это задерживает
вопросы локализации для того, чтобы их можно было указать с любым методом.

Для указания языка и страны можно использовать локаль; возможна любая
комбинация для языка, если она поддерживается debian-installer, и страны. Если
в локали указана недопустимая комбинация, то программа установки автоматически
выберет локаль, подходящую для выбранного языка. Чтобы указать локаль в
параметре загрузки, используйте locale=ru_RU.UTF-8.

Хотя этот метод очень прост в использовании, с его помощью нельзя задать любые
комбинации языка, страны и локали^[20]. Поэтому есть возможность задать
автоматический ответ для каждого параметра отдельно. Язык и страну также можно
указывать в параметрах запуска.

# Автоответ только для языка, страны и локали.
d-i debian-installer/locale string en_US.UTF-8

# Значения можно указывать отдельно для каждого параметра.
#d-i debian-installer/language string en
#d-i debian-installer/country string NL
#d-i debian-installer/locale string en_GB.UTF-8
# В добавок, можно указать дополнительные локали для генерации.
#d-i localechooser/supported-locales multiselect en_US.UTF-8, nl_NL.UTF-8

При настройке клавиатуры выбирается раскладка и (для нелатинских раскладок)
клавиша переключения между нелатинской раскладкой и раскладкой US. Во время
установки доступны только основные варианты раскладок. Дополнительные варианты
доступны только в установленной системе; их можно выбрать с помощью команды 
dpkg-reconfigure keyboard-configuration.

# Выбор клавиатуры.
d-i keyboard-configuration/xkb-keymap select ru
# d-i keyboard-configuration/toggle select No toggling

Чтобы не выполнять настройку клавиатуры укажите в keymap значение skip-config.
В результате останется активной клавиатурная раскладка ядра.

B.4.2. Speech synthesis

When installing with software speech synthesis (i.e. speakup.synth=soft passed
on the kernel command line), the sound board and the voice to be used can be
preseeded.

Since speech synthesis is started very early, this can only be preseeded from
initrd or the kernel command line.

Preseeding espeakup/voice also enables configuring the installed system with
speech accessibility features. This takes effect even if software speech
synthesis was not actually enabled inside the installer.

# Which ALSA card to be used for software speech.
# Can be a number from 0, or an ID as seen in
# /sys/class/sound/card*/id
#d-i espeakup/card string 0

# Which espeak-ng voice to be used
#d-i espeakup/voice string en

B.4.3. Настройка сети

Of course, preseeding the network configuration won't work if you're loading
your preconfiguration file from the network. But it's great when you're booting
from optical disc or USB stick. If you are loading preconfiguration files from
the network, you can pass network config parameters by using kernel boot
parameters.

Если нужно использовать определённый интерфейс для загрузки по сети перед
загрузкой файла ответов из сети, используйте параметр загрузки interface=eth1.

Хотя автоматическая настройка сети обычно невозможна при загрузки файла ответов
по сети (с помощью «preseed/url»), вы можете обойти этот недостаток, например,
если задав статический адрес на сетевом интерфейса. Данное обходное решение
заставит запуститься настройку сети ещё раз после загрузки файла ответов, если
создать сценарий «preseed/run» со следующими строчками:

kill-all-dhcp; netcfg

Следующие переменные debconf относятся к настройке сети.

# Disable network configuration entirely. This is useful for cdrom
# installations on non-networked devices where the network questions,
# warning and long timeouts are a nuisance.
#d-i netcfg/enable boolean false

# netcfg will choose an interface that has link if possible. This makes it
# skip displaying a list if there is more than one interface.
d-i netcfg/choose_interface select auto

# To pick a particular interface instead:
#d-i netcfg/choose_interface select eth1

# To set a different link detection timeout (default is 3 seconds).
# Values are interpreted as seconds.
#d-i netcfg/link_wait_timeout string 10

# If you have a slow dhcp server and the installer times out waiting for
# it, this might be useful.
#d-i netcfg/dhcp_timeout string 60
#d-i netcfg/dhcpv6_timeout string 60

# Automatic network configuration is the default.
# If you prefer to configure the network manually, uncomment this line and
# the static network configuration below.
#d-i netcfg/disable_autoconfig boolean true

# If you want the preconfiguration file to work on systems both with and
# without a dhcp server, uncomment these lines and the static network
# configuration below.
#d-i netcfg/dhcp_failed note
#d-i netcfg/dhcp_options select Configure network manually

# Static network configuration.
#
# IPv4 example
#d-i netcfg/get_ipaddress string 192.168.1.42
#d-i netcfg/get_netmask string 255.255.255.0
#d-i netcfg/get_gateway string 192.168.1.1
#d-i netcfg/get_nameservers string 192.168.1.1
#d-i netcfg/confirm_static boolean true
#
# IPv6 example
#d-i netcfg/get_ipaddress string fc00::2
#d-i netcfg/get_netmask string ffff:ffff:ffff:ffff::
#d-i netcfg/get_gateway string fc00::1
#d-i netcfg/get_nameservers string fc00::1
#d-i netcfg/confirm_static boolean true

# Any hostname and domain names assigned from dhcp take precedence over
# values set here. However, setting the values still prevents the questions
# from being shown, even if values come from dhcp.
d-i netcfg/get_hostname string unassigned-hostname
d-i netcfg/get_domain string unassigned-domain

# If you want to force a hostname, regardless of what either the DHCP
# server returns or what the reverse DNS entry for the IP is, uncomment
# and adjust the following line.
#d-i netcfg/hostname string somehost

# Disable that annoying WEP key dialog.
d-i netcfg/wireless_wep string
# The wacky dhcp hostname that some ISPs use as a password of sorts.
#d-i netcfg/dhcp_hostname string radish

# If you want to completely disable firmware lookup (i.e. not use firmware
# files or packages that might be available on installation images):
#d-i hw-detect/firmware-lookup string never

# If non-free firmware is needed for the network or other hardware, you can
# configure the installer to always try to load it, without prompting. Or
# change to false to disable asking.
#d-i hw-detect/load_firmware boolean true

Заметим, что netcfg автоматически выберет маску сети,если она не указана в
netcfg/get_netmask. В этом случае, переменная будет помечена как seen при
автоматической установке. Аналогично netcfg выберет подходящий адрес шлюза,
если не указано значение в netcfg/get_gateway. Но есть специальная настройка:
netcfg/get_gateway можно установить в «none», чтобы указать, что шлюз вообще не
должен использоваться.

B.4.4. Сетевая консоль

# Используйте следующие настройки, если хотите использовать компоненту
# network-consoleдля удалённой установки через SSH. Это имеет смысл, если вы
# намереваетесь выполнять оставшуюся часть установки вручную.
#d-i anna/choose_modules string network-console
#d-i network-console/authorized_keys_url string http://10.0.0.1/openssh-key
#d-i network-console/password password r00tme
#d-i network-console/password-again password r00tme

More information related to network-console can be found in Раздел 6.3.10,
«Installation over network-console».

B.4.5. Настройка сервера-зеркала

В зависимости от используемого метода установки для загрузки дополнительных
компонент программы установки, установки базовой системы и настройки файла /etc
/apt/sources.list в установленной системе можно использовать сервер-зеркало.

Параметр mirror/suite определяет версию дистрибутива для устанавливаемой
системы.

Параметр mirror/udeb/suite определяет версию дистрибутива для дополнительных
компонент программы установки. Он нужен только если компоненты загружаются по
сети и должны соответствовать версии, которая была использована для сборки
initrd, который используется для установки с помощью одноимённого метода.
Обычно программа установки автоматически определяет правильное значение, и этот
параметр задавать ненужно.

# Mirror protocol:
# If you select ftp, the mirror/country string does not need to be set.
# Default value for the mirror protocol: http.
#d-i mirror/protocol string ftp
d-i mirror/country string manual
d-i mirror/http/hostname string http.us.debian.org
d-i mirror/http/directory string /debian
d-i mirror/http/proxy string

# Suite to install.
#d-i mirror/suite string testing
# Suite to use for loading installer components (optional).
#d-i mirror/udeb/suite string testing

B.4.6. Настройка учётной записи

Могут быть автоматически настроены пароль суперпользователя и имя и пароль
первого обычного пользователя. Пароли могут быть заданы как нешифрованные
текстовые значения или в виде хешей crypt(3).

Предупреждение

Обратите внимание, что автоматическую настройку паролей использовать
небезопасно, так как любой может получить доступ к файлу ответов и узнать
пароли. Хранение хешей паролей считается безопасным, если для них не
используются нестойкие алгоритмы хеширования DES или MD5, которые доступны для
атак перебором. Для вычисления хешей рекомендуется использовать алгоритмы
SHA-256 и SHA512.

# Пропустить создание учётной записи суперпользователя (в обычной учётной
# записи пользователя можно использовать sudo).
#d-i passwd/root-login boolean false
# Или же пропустить создание обычной учётной записи пользователя.
#d-i passwd/make-user boolean false

# Пароль суперпользователя, любой открытым текстом
#d-i passwd/root-password password r00tme
#d-i passwd/root-password-again password r00tme
# или в виде хеша crypt(3).
#d-i passwd/root-password-crypted password [хеш crypt(3)]

# Создать учётную запись обычного пользователя.
#d-i passwd/user-fullname string Debian User
#d-i passwd/username string debian
# Пароль обычного пользователя, или открытым текстом
#d-i passwd/user-password password insecure
#d-i passwd/user-password-again password insecure
# или в виде хеша crypt(3).
#d-i passwd/user-password-crypted password [хеш crypt(3)]
# Создать первую учётную запись с заданным UID вместо значения по
# умолчанию.
#d-i passwd/user-uid string 1010

# Учётная запись будет добавлена в несколько стандартных начальных групп.
# Чтобы это изменить -- отредактируйте и раскомментируйте строчку ниже.
#d-i passwd/user-default-groups string audio cdrom video

Также, в начале значений переменных passwd/root-password-crypted и passwd/
user-password-crypted можно указать знак «!». В этом случае, соответствующая
учётная запись будет заблокирована. Это может быть удобно для учётной записи
суперпользователя, если используется другой метод настройки, предоставляющий
возможность выполнить административные действия или вход в систему от имени
суперпользователя (например, используя аутентификацию по SSH ключу или sudo).

С помощью следующей команды (доступной из пакета whois) можно сгенерировать хеш
SHA-512 из crypt(3) для пароля:

mkpasswd -m sha-512

B.4.7. Настройка времени и часового пояса

# Задаёт, установлены или нет аппаратные часы по Гринвичу.
d-i clock-setup/utc boolean true

# Здесь вы можете указать любое допустимое значение для $TZ; смотрите
# допустимые значения в файле /usr/share/zoneinfo/.
d-i time/zone string US/Eastern

# Определяет, нужно ли использовать NTP для установки часов во время установки
d-i clock-setup/ntp boolean true
# Используемый сервер NTP. Значение по умолчанию указывается здесь.
#d-i clock-setup/ntp-server string ntp.example.com

B.4.8. Разметка дисков

Использование настроек разметки жёсткого диска в автоматической установке очень
ограничено; поддерживаются параметры только для partman-auto. Вы можете выбрать
разметку только свободного места на диске или всего диска. Разметку диска можно
выбрать из одного из имеющихся в программе установки наборов, пользовательского
набора из файла или набора из файла ответов.

Расширенные возможности разметки с использованием RAID, LVM и шифрования
поддерживаются в автоматической установке, но не так гибки как при разметке без
автоматической установки.

Представленные далее примеры показывают только основы по использованию наборов.
Подробности смотрите в файлах partman-auto-recipe.txt и
partman-auto-raid-recipe.txt из пакета debian-installer. Также эти файлы
доступны в репозитории debian-installer. Заметим, что список поддерживаемых
возможностей может поменяться между выпусками.

Предупреждение

Идентификация дисков зависит от порядка загрузки драйверов. Если в системе есть
несколько дисков, проверьте, что выбирается правильный диск перед тем как
использовать автоматическую установку.

B.4.8.1. Пример разметки

# If the system has free space you can choose to only partition that space.
# This is only honoured if partman-auto/method (below) is not set.
#d-i partman-auto/init_automatically_partition select biggest_free

# Alternatively, you may specify a disk to partition. If the system has only
# one disk the installer will default to using that, but otherwise the device
# name must be given in traditional, non-devfs format (so e.g. /dev/sda
# and not e.g. /dev/discs/disc0/disc).
# For example, to use the first SCSI/SATA hard disk:
#d-i partman-auto/disk string /dev/sda
# In addition, you'll need to specify the method to use.
# The presently available methods are:
# - regular: use the usual partition types for your architecture
# - lvm:     use LVM to partition the disk
# - crypto:  use LVM within an encrypted partition
d-i partman-auto/method string lvm

# You can define the amount of space that will be used for the LVM volume
# group. It can either be a size with its unit (eg. 20 GB), a percentage of
# free space or the 'max' keyword.
d-i partman-auto-lvm/guided_size string max

# If one of the disks that are going to be automatically partitioned
# contains an old LVM configuration, the user will normally receive a
# warning. This can be preseeded away...
d-i partman-lvm/device_remove_lvm boolean true
# The same applies to pre-existing software RAID array:
d-i partman-md/device_remove_md boolean true
# And the same goes for the confirmation to write the lvm partitions.
d-i partman-lvm/confirm boolean true
d-i partman-lvm/confirm_nooverwrite boolean true

# You can choose one of the predefined partitioning recipes:
# - atomic: all files in one partition
# - home:   separate /home partition
# - multi:  separate /home, /var, and /tmp partitions
# - server: separate /var and /srv partitions; swap limitted to 1G
# - small_disk: scheme dedicated to small harddrives (under 10GB)
d-i partman-auto/choose_recipe select atomic

# Or provide a recipe of your own...
# If you have a way to get a recipe file into the d-i environment, you can
# just point at it.
#d-i partman-auto/expert_recipe_file string /hd-media/recipe

# If not, you can put an entire recipe into the preconfiguration file in one
# (logical) line. This example creates a small /boot partition, suitable
# swap, and uses the rest of the space for the root partition:
#d-i partman-auto/expert_recipe string                         \
#      boot-root ::                                            \
#              40 50 100 ext3                                  \
#                      $primary{ } $bootable{ }                \
#                      method{ format } format{ }              \
#                      use_filesystem{ } filesystem{ ext3 }    \
#                      mountpoint{ /boot }                     \
#              .                                               \
#              500 10000 1000000000 ext3                       \
#                      method{ format } format{ }              \
#                      use_filesystem{ } filesystem{ ext3 }    \
#                      mountpoint{ / }                         \
#              .                                               \
#              64 512 300% linux-swap                          \
#                      method{ swap } format{ }                \
#              .

# The full recipe format is documented in the file partman-auto-recipe.txt
# included in the 'debian-installer' package or available from D-I source
# repository. This also documents how to specify settings such as file
# system labels, volume group names and which physical devices to include
# in a volume group.

## Partitioning for EFI
# If your system needs an EFI partition you could add something like
# this to the recipe above, as the first element in the recipe:
#               538 538 1075 free                              \
#                      $iflabel{ gpt }                         \
#                      $reusemethod{ }                         \
#                      method{ efi }                           \
#                      format{ }                               \
#               .                                              \
#
# The fragment above is for the amd64 architecture; the details may be
# different on other architectures. The 'partman-auto' package in the
# D-I source repository may have an example you can follow.

# This makes partman automatically partition without confirmation, provided
# that you told it what to do using one of the methods above.
d-i partman-partitioning/confirm_write_new_label boolean true
d-i partman/choose_partition select finish
d-i partman/confirm boolean true
d-i partman/confirm_nooverwrite boolean true

# Force UEFI booting ('BIOS compatibility' will be lost). Default: false.
#d-i partman-efi/non_efi_system boolean true
# Ensure the partition table is GPT - this is required for EFI
#d-i partman-partitioning/choose_label select gpt
#d-i partman-partitioning/default_label string gpt

# When disk encryption is enabled, skip wiping the partitions beforehand.
#d-i partman-auto-crypto/erase_disks boolean false

B.4.8.2. Разметка с использованием RAID

Также вы можете автоматизировать настройку массивов программного RAID.
Поддерживаются RAID уровни 0, 1, 5, 6 и 10, создание неполных массивов
(degraded arrays) и можно указать запасные устройства.

Если вы используете RAID 1, то можете автоматизировать установку grub на все
устройства массива, см. Раздел B.4.12, «Установка загрузчика».

Предупреждение

В данном типе автоматизации разметки легко ошибиться. Также эта возможность
тестировалась относительно мало разработчиками debian-installer.
Ответственность при создании правильного набора (то есть, чтобы он был
логически верным и не имел конфликтов) лежит на пользователе. Если возникают
проблемы -- см. /var/log/syslog.

# Метод должен быть установлен в значение "raid".
#d-i partman-auto/method string raid
# Задать размечаемые диски. Они будут иметь одинаковую разметку,
# поэтому это работает только, если диски одинакового размера.
#d-i partman-auto/disk string /dev/sda /dev/sdb

# Далее нужно указать какие физические разделы будут использоваться.
#d-i partman-auto/expert_recipe string \
#      multiraid ::                                         \
#              1000 5000 4000 raid                          \
#                      $primary{ } method{ raid }           \
#              .                                            \
#              64 512 300% raid                             \
#                      method{ raid }                       \
#              .                                            \
#              500 10000 1000000000 raid                    \
#                      method{ raid }                       \
#              .

# Наконец, нужно указать как использовать определённые ранее разделы
# в настройке RAID. Указывайте правильные номера разделов
# для логических разделов. Поддерживается RAID 0, 1, 5, 6 и 10;
# устройства разделяются с помощью "#".
# Параметры:
# <raidtype> <devcount> <sparecount> <fstype> <mountpoint> \
#          <devices> <sparedevices>

#d-i partman-auto-raid/recipe string \
#    1 2 0 ext3 /                    \
#          /dev/sda1#/dev/sdb1       \
#    .                               \
#    1 2 0 swap -                    \
#          /dev/sda5#/dev/sdb5       \
#    .                               \
#    0 2 0 ext3 /home                \
#          /dev/sda6#/dev/sdb6       \
#    .

# Полностью формат набора описан в файле partman-auto-raid-recipe.txt,
# включённом в пакет debian-installer и репозиторий D-I.

# Это заставит partman сделать разметку автоматически, без подтверждения.
d-i partman-md/confirm boolean true
d-i partman-partitioning/confirm_write_new_label boolean true
d-i partman/choose_partition select finish
d-i partman/confirm boolean true
d-i partman/confirm_nooverwrite boolean true

B.4.8.3. Управление монтированием разделов

Обычно, файловые системы монтируются с использованием в качестве ключа
универсального уникального идентификатора (UUID); это позволяет монтировать их
правильно, даже если изменились их имена устройств. UUID-ы длинные и их сложно
запоминать, поэтому, по вашему желанию, программа установки может смонтировать
файловые системы основываясь на традиционных именах устройств, или на основе
назначенных вами меток. Если вы укажите программе установки монтировать по
меткам, то все файловые системы без метки будут смонтированы на основе UUID.

Для устройств со стабильными именами, такими как логические тома LVM, при
монтировании будет продолжено использование их традиционных имён, а не UUID-ы.

Предупреждение

Традиционные имена устройств могут изменяться из-за порядка, в котором ядро
обнаруживает устройства при загрузке, что может приводить к монтированию не тех
файловых систем. Подобным образом, могут встретиться одинаковые метки, если вы
подключаете новый диск или USB-устройство, и если это случается, то ваша
система начинает работать непредсказуемым образом.

# По умолчанию, используется монтирование по UUID, но вы можете
# выбрать "traditional", чтобы использовать обычные имена устройств
# или "label", чтобы попробовать монтирование по меткам, перед
# тем как откатиться к UUID-ам.
#d-i partman/mount_style select uuid

B.4.9. Установка базовой системы

Для этого этапа, фактически, не так много автоматизируемых настроек. В основном
они касаются установки ядра.

# Настроить APT для отмены автоматической установки рекомендуемых пакетов.
# Использование данного параметра может привести к установке неполноценной
# системы, и он должен использоваться только
# очень опытными пользователями.
#d-i base-installer/install-recommends boolean false

# Устанавливаемый пакет (мета) с образом ядра; можно указать «none»,
# если ядро устанавливать не нужно.
#d-i base-installer/kernel/image string linux-image-686

B.4.10. Настройка Apt

Настройка файла /etc/apt/sources.list и основных параметров конфигурации
выполняется автоматически на основании метода установки и ответов на ранее
заданные вопросы. Необязательно вы можете добавить другие (локальные)
репозитории.

# Choose, if you want to scan additional installation media
# (default: false).
d-i apt-setup/cdrom/set-first boolean false
# You can choose to install non-free firmware.
#d-i apt-setup/non-free-firmware boolean true
# You can choose to install non-free and contrib software.
#d-i apt-setup/non-free boolean true
#d-i apt-setup/contrib boolean true
# Uncomment the following line, if you don't want to have the sources.list
# entry for a DVD/BD installation image active in the installed system
# (entries for netinst or CD images will be disabled anyway, regardless of
# this setting).
#d-i apt-setup/disable-cdrom-entries boolean true
# Uncomment this if you don't want to use a network mirror.
#d-i apt-setup/use_mirror boolean false
# Select which update services to use; define the mirrors to be used.
# Values shown below are the normal defaults.
#d-i apt-setup/services-select multiselect security, updates
#d-i apt-setup/security_host string security.debian.org

# Additional repositories, local[0-9] available
#d-i apt-setup/local0/repository string \
#       http://local.server/debian stable main
#d-i apt-setup/local0/comment string local server
# Enable deb-src lines
#d-i apt-setup/local0/source boolean true
# URL to the public key of the local repository; you must provide a key or
# apt will complain about the unauthenticated repository and so the
# sources.list line will be left commented out.
#d-i apt-setup/local0/key string http://local.server/key
# or one can provide it in-line by base64 encoding the contents of the
# key file (with `base64 -w0`) and specifying it thus:
#d-i apt-setup/local0/key string base64://LS0tLS1CRUdJTiBQR1AgUFVCTElDIEtFWSBCTE9DSy0tLS0tCi4uLgo=
# The content of the key file is checked to see if it appears to be ASCII-armoured.
# If so it will be saved with an ".asc" extension, otherwise it gets a '.gpg' extension.
# "keybox database" format is currently not supported. (see generators/60local in apt-setup's source)

# By default the installer requires that repositories be authenticated
# using a known gpg key. This setting can be used to disable that
# authentication. Warning: Insecure, not recommended.
#d-i debian-installer/allow_unauthenticated boolean true

# Uncomment this to add multiarch configuration for i386
#d-i apt-setup/multiarch string i386


B.4.11. Выбор пакетов

Вы можете выбрать любую доступную комбинацию устанавливаемых задач. Доступные
задачи:

  • standard (стандартные инструменты)

  • desktop (графический рабочий стол)

  • gnome-desktop (рабочий стол Gnome)

  • xfce-desktop (рабочий стол XFCE)

  • kde-desktop (рабочий стол KDE Plasma)

  • cinnamon-desktop (рабочий стол Cinnamon)

  • mate-desktop (рабочий стол MATE)

  • lxde-desktop (рабочий стол LXDE)

  • web-server (веб-сервер)

  • ssh-server (сервер SSH)

Также вы можете не выбирать задачи и выполнить установку списка пакетов
каким-то другим способом. Мы рекомендуем всегда включать задачу standard.

Or if you don't want the tasksel dialog to be shown at all, preseed pkgsel/
run_tasksel (no packages are installed via tasksel in that case).

Если вы хотите установить несколько отдельных пакетов в дополнении к пакетам,
устанавливаемым задачами, то вы можете использовать параметр pkgsel/include. В
значении этого параметра в качестве разделителя можно использовать запятые или
пробелы, поэтому также его можно указать в командной строке ядра.

#tasksel tasksel/first multiselect standard, web-server, kde-desktop

# Or choose to not get the tasksel dialog displayed at all (and don't install
# any packages):
#d-i pkgsel/run_tasksel boolean false

# Individual additional packages to install
#d-i pkgsel/include string openssh-server build-essential
# Whether to upgrade packages after debootstrap.
# Allowed values: none, safe-upgrade, full-upgrade
#d-i pkgsel/upgrade select none

# You can choose, if your system will report back on what software you have
# installed, and what software you use. The default is not to report back,
# but sending reports helps the project determine what software is most
# popular and should be included on the first DVD.
#popularity-contest popularity-contest/participate boolean false

B.4.12. Установка загрузчика

# Grub is the boot loader (for x86).

# This is fairly safe to set, it makes grub install automatically to the UEFI
# partition/boot record if no other operating system is detected on the machine.
d-i grub-installer/only_debian boolean true

# This one makes grub-installer install to the UEFI partition/boot record, if
# it also finds some other OS, which is less safe as it might not be able to
# boot that other OS.
d-i grub-installer/with_other_os boolean true

# Due notably to potential USB sticks, the location of the primary drive can
# not be determined safely in general, so this needs to be specified:
#d-i grub-installer/bootdev  string /dev/sda
# To install to the primary device (assuming it is not a USB stick):
#d-i grub-installer/bootdev  string default

# Alternatively, if you want to install to a location other than the UEFI
# parition/boot record, uncomment and edit these lines:
#d-i grub-installer/only_debian boolean false
#d-i grub-installer/with_other_os boolean false
#d-i grub-installer/bootdev  string (hd0,1)
# To install grub to multiple disks:
#d-i grub-installer/bootdev  string (hd0,1) (hd1,1) (hd2,1)

# Optional password for grub, either in clear text
#d-i grub-installer/password password r00tme
#d-i grub-installer/password-again password r00tme
# or encrypted using an MD5 hash, see grub-md5-crypt(8).
#d-i grub-installer/password-crypted password [MD5 hash]

# Use the following option to add additional boot parameters for the
# installed system (if supported by the bootloader installer).
# Note: options passed to the installer will be added automatically.
#d-i debian-installer/add-kernel-opts string nousb

Хеш MD5 для пароля на grub можно сгенерировать с помощью grub-md5-crypt или
командой из примера в Раздел B.4.6, «Настройка учётной записи».

B.4.13. Завершение установки

# During installations from serial console, the regular virtual consoles
# (VT1-VT6) are normally disabled in /etc/inittab. Uncomment the next
# line to prevent this.
#d-i finish-install/keep-consoles boolean true

# Avoid that last message about the install being complete.
d-i finish-install/reboot_in_progress note

# This will prevent the installer from ejecting the disc during the reboot,
# which is useful in some situations.
#d-i cdrom-detect/eject boolean false

# This is how to make the installer shutdown when finished, but not
# reboot into the installed system.
#d-i debian-installer/exit/halt boolean true
# This will power off the machine instead of just halting it.
#d-i debian-installer/exit/poweroff boolean true

B.4.14. Автоматизация других пакетов

# В зависимости от выбранного для установки ПО, или если что-то идёт
# неправильно во время процесса установки, существует вероятность появления других
# вопросов. Естественно, их тоже можно автоматизировать. Чтобы получить список
# всех возможных вопросов, которые могут быть заданы во время установки, выполните
# установку, а затем запустите следующие команды:
#   debconf-get-selections --installer > файл
#   debconf-get-selections >> файл

B.5. Дополнительные параметры

B.5.1. Запуск пользовательских команд во время установки

Инструментарий автоматической установки предлагает очень мощную и гибкую
возможность -- способность запуска команд или сценариев в определённые моменты
установки.

When the filesystem of the target system is mounted, it is available in /
target. If an installation CD/DVD is used, when it is mounted it is available
in /cdrom.

# Автоматизация d-i по сути небезопасна. Программа установки не выполняет
# проверок на переполнения буфера или другого использования значений
# такого направления из файла ответов. Используйте файлы ответов только из
# надёжных источников! Для использования дома, и потому что это обычно
# полезно, здесь показано как запускать свои команды оболочки внутри
# программы установки автоматически.

# Эта первая команда, которая выполняется как можно раньше сразу после
# чтения файла ответов.
#d-i preseed/early_command string anna-install какой-то-udeb
# Эта команда выполняется непосредственно перед запуском утилиты разметки.
# Это может пригодиться для динамической автоматической настройки утилиты
# разметки, зависящей от состояния дисков (которое может быть
# непонятно при работе preseed/early_command).
#d-i partman/early_command \
#       string debconf-set partman-auto/disk "$(list-devices disk | head -n1)"
# Эта команда выполняется перед окончанием установки, пока ещё
# есть рабочий каталог /target. Вы можете выполнить chroot в /target
# и непосредственно использовать его, или же воспользоваться командами
# apt-install и in-target для облегчения задачи установки пакетов и
# запуска команд в целевой системе.
#d-i preseed/late_command string apt-install zsh; in-target chsh -s /bin/zsh

B.5.2. Использование автоматической установки для изменения значений по
умолчанию

С помощью автоматической установки можно изменить ответы по умолчанию, но
вопросы всё равно будут задаваться. Для этого после задания ответа на вопрос
нужно установить флаг seen в «false» после указания ответа на вопрос.

d-i foo/bar string value
d-i foo/bar seen false

Того же эффекта можно достигнуть для всех вопросов, указав параметр preseed/
interactive=true в приглашении к загрузке. Также это может помочь при отладке
или тестировании вашего файла ответов.

Заметим, что владелец «d-i» должен использоваться только для переменных,
используемых в самой программе установки. Для переменных, принадлежащих
устанавливаемым в систему пакетам,вы должны использовать имя этого пакета. См.
сноску к Раздел B.2.2, «Использование параметров загрузки для автоматизации».

Если вы выполняете автоматизацию через параметры загрузки, то можете заставить
программу установки задавать соответствующий вопрос с помощью оператора «?=», а
именно foo/bar?=value (или owner:foo/bar?=value). Естественно, это действует
только на параметры, которые относятся к отображаемым во время установки
вопросам, но никак не на «внутренние» параметры.

Чтобы получить более подробную отладочную информацию, используйте загрузочный
параметры DEBCONF_DEBUG=5. T Он заставит debconf печатать намного больше
подробностей о текущих настройках каждой переменной и о ходе выполнения
сценариев установки каждого пакета.

B.5.3. Последовательная загрузка нескольких файлов ответов

В файлах ответов поддерживаются ссылки на дополнительные файлы ответов. Любые
настройки файлов, загруженных позже, будут перекрывать настройки из файлов,
загруженных ранее. Это позволяет поместить, например, общие настройки сети в
один файл, а более специфичные для определённых конфигураций в другие файлы.

# Можно указать более одного файла, разделив их пробелами; все будут
# загружены. Включаемые файлы, в свою очередь, тоже могут содержать
# директивы preseed/include. Заметим, что если имена файлов
# относительные, то они берутся
# из того же каталога что и файл ответов, в который они включены.
#d-i preseed/include string x.cfg

# Программу установки можно заставить проверять контрольные суммы файлов
# ответов перед их использованием. В данный момент поддерживается только
# md5sums; в списке md5sums файлы должны указываться в том же порядке,
# что и при включении файлов.
#d-i preseed/include/checksum string 5da499872becccfeda2c4872f9171c3d

# Для большей гибкости можно запустить команду оболочки и если она выдаст
# имена файлов ответов, включить эти файлы.
#d-i preseed/include_command \
#      string if [ "`hostname`" = bob ]; then echo bob.cfg; fi

# Наиболее гибкий из всех способ -- загрузить и выполнить программу.
# Программа может использовать команды, например, debconf-set для
# управления базой данных debconf.
# Можно указать более одного файла, разделив их пробелами
# Заметим, что если имена файлов относительные, то они ищутся в том же
# каталоге откуда взят файл ответов, который запускает их.
#d-i preseed/run string foo.sh

Также возможно цепочечное выполнение автоматизации из initrd или файла, а затем
автоматизацию по сети, если задать preseed/url в файлах исполняемых первыми.
Это приведёт выполнению автоматизации по сети, когда сеть станет доступна.
Нужно быть осторожным при настройке, так как будут выполняться два разных по
сути метода автоматизации, что, например, приведёт к выполнению команды из
preseed/early дважды: один раз из первого метода, второй раз после включения
сети.


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[19] Владелец переменной debconf (или шаблона) -- это, обычно, имя пакета, в
котором содержится соответствующий шаблон debconf. Переменными самой программы
установки владеет «d-i». Шаблоны и переменные могут иметь более одного
владельца, что влияет на их удаление из базы данных debconf при вычистке
пакета.

^[20] При задании значения для locale равным en_NL, например, приведёт к
установке системы с локалью по умолчанию en_US.UTF-8. Если, например, требуется
en_GB.UTF-8, то значения для автоматического ответа нужно задавать отдельно для
каждого параметра.

Приложение C. Разметка дисков в Debian

Содержание

C.1. Дисковые разделы Debian и их размеры
C.2. Структура каталогов
C.3. Рекомендуемые схемы разметки
C.4. Имена устройств в Linux
C.5. Программы разметки в Debian
    C.5.1. Разметка для 64-bit PC

C.1. Дисковые разделы Debian и их размеры

Как минимум, для GNU/Linux требуется один раздел. Вы можете иметь единственный
раздел, содержащий всю операционную систему, приложения и ваши личные файлы.
Большинство людей считают, что также необходим раздел подкачки, хотя это не
совсем верно. «Раздел подкачки (swap)» -- это рабочее пространство для
операционной системы, которое позволяет использовать дисковое пространство в
качестве «виртуальной памяти». Linux работает с виртуальной памятью более
эффективно, если она расположена в отдельном разделе. Linux может использовать
для подкачки обычный файл, но это не рекомендуется.

Однако большинство людей выделяют под GNU/Linux больше одного раздела. Есть две
причины, по которым возможно вы захотите разделить файловую систему на
несколько маленьких разделов. Первая -- это безопасность. Если что-то
повредится в файловой системе, пострадает только один раздел. То есть, вам
нужно будет восстановить (из резервной копии, которую вы заботливо храните)
только часть системы. Как минимум, вам нужно создать так называемый «корневой
раздел». Он содержит наиболее важные компоненты системы. Если любой другой
раздел будет повреждён, вы всё равно сможете загрузиться в GNU/Linux чтобы
починить систему. Это может спасти вас от неприятной полной переустановки
системы.

Вторая причина обычно более важна для бизнеса, но на самом деле это зависит от
того, в каком качестве используется машина. Например, почтовый сервер, получая
спам, может легко переполнить раздел письмами. Если вы сделаете для /var/mail
отдельный раздел на почтовом сервере, большинство систем будут продолжать
работать даже если вас заспамят.

Единственным настоящим препятствием по использованию нескольких разделов
является то, что часто трудно предсказать размер, который для них нужно
выбрать. Если вы сделаете раздел слишком маленьким, то вам придётся или
переустанавливать всю систему или постоянно перемещать файлы из-за нехватки
места на разделе. С другой стороны, если сделать раздел слишком большим, то это
трата места впустую, а оно могло пригодиться где-нибудь ещё. В наши дни
дисковое пространство дёшево, но зачем выбрасывать деньги на ветер?

C.2. Структура каталогов

Debian GNU/Linux придерживается стандарта Filesystem Hierarchy Standard для
каталогов и имён файлов. Этот стандарт позволяет пользователям и программному
обеспечению быть уверенным в расположении файлов и каталогов. Уровень корневого
каталога представляется просто косой чертой /. На корневом уровне, все системы
Debian содержат следующие каталоги:

┌───────┬────────────────────────────────────────────────────────────┐
│Каталог│                          Содержит                          │
├───────┼────────────────────────────────────────────────────────────┤
│bin    │необходимые исполняемые файлы                               │
├───────┼────────────────────────────────────────────────────────────┤
│boot   │статичные файлы системного загрузчика                       │
├───────┼────────────────────────────────────────────────────────────┤
│dev    │файлы устройств                                             │
├───────┼────────────────────────────────────────────────────────────┤
│etc    │настройки системы данной машины                             │
├───────┼────────────────────────────────────────────────────────────┤
│home   │домашние каталоги пользователей                             │
├───────┼────────────────────────────────────────────────────────────┤
│lib    │необходимые библиотеки общего пользования и модули ядра     │
├───────┼────────────────────────────────────────────────────────────┤
│media  │содержит точки монтирования для съёмных носителей           │
├───────┼────────────────────────────────────────────────────────────┤
│mnt    │точка монтирования для временно монтируемой файловой системы│
├───────┼────────────────────────────────────────────────────────────┤
│proc   │виртуальный каталог для системной информации                │
├───────┼────────────────────────────────────────────────────────────┤
│root   │домашний каталог суперпользователя                          │
├───────┼────────────────────────────────────────────────────────────┤
│run    │изменяемые данные времени выполнения                        │
├───────┼────────────────────────────────────────────────────────────┤
│sbin   │необходимые системные исполняемые файлы                     │
├───────┼────────────────────────────────────────────────────────────┤
│sys    │виртуальный каталог для системной информации                │
├───────┼────────────────────────────────────────────────────────────┤
│tmp    │временные файлы                                             │
├───────┼────────────────────────────────────────────────────────────┤
│usr    │вторичная иерархия                                          │
├───────┼────────────────────────────────────────────────────────────┤
│var    │изменяемые данные                                           │
├───────┼────────────────────────────────────────────────────────────┤
│srv    │Данные сервисов, предоставляемых системой                   │
├───────┼────────────────────────────────────────────────────────────┤
│opt    │дополнительное программное обеспечение                      │
└───────┴────────────────────────────────────────────────────────────┘

Далее следует список важных предположений относительно каталогов и разделов.
Заметьте, что дисковое пространство может использоваться совершенно по-разному,
в зависимости от настроек системы и специфики решаемых задач. Приводимые здесь
рекомендации являются лишь отправной точкой в решении задачи разметки.

  • The root partition / must always physically contain /etc, /bin, /sbin, /
    lib, /dev and /usr, otherwise you won't be able to boot. This means that
    you should provide at least 700-850MB of disk space for the root partition
    including /usr, or 5-6GB for a workstation or a server installation.

  • Каталог /var содержит: все изменяющиеся данные типа новостных статей,
    сообщений электронной почты, веб-сайтов, баз данных, кэша системы
    управления пакетами и т.д. Размер каталога целиком зависит от степени
    использования компьютера, но для большинства людей он определяется работой
    с системой управления пакетами. Если вы собираетесь установить всё, что
    предлагает Debian, при чём сразу, то 2 или 3 гигабайта для /var должно
    хватить. Если вы собираетесь производить установку по частям (то есть,
    установить службы и утилиты, потом программы для работы с текстом, потом X,
    ...), то можно уложиться в 300-500 МБ. Если пространство жёсткого диска
    дорого и вы не планируете делать глобальных обновлений системы, то вам
    будет достаточно 30 или 40 МБ.

  • Каталог /tmp содержит: временные данные создаваемые запущенными
    программами. Обычно достаточно 40-100 МБ. Некоторые приложения --
    управление резервным копированием, утилиты работы с CD/DVD и
    мультимедийными данными -- могут использовать /tmp для временного хранения
    файлов. Если вы планируете использовать данные приложения, то должны
    выделить пространство под /tmp согласно вашим потребностям.

  • Каталог /home содержит: отдельный подкаталог для каждого пользователя, где
    хранятся личные данные. Его размер зависит от количества пользователей в
    системе и какие файлы они будут хранить в своих каталогах. В зависимости от
    планируемого использования вы должны зарезервировать около 100 МБ для
    каждого пользователя, но можете изменить это значение согласно своим
    требованиям. Выделите больше места, если планируете хранить много
    мультимедийных файлов (картинок, MP3, фильмов) в своём домашнем каталоге.

C.3. Рекомендуемые схемы разметки

For new users, personal Debian boxes, home systems, and other single-user
setups, a single / partition (plus swap) is probably the easiest, simplest way
to go. The recommended partition type is ext4.

Для многопользовательских систем или систем с большим дисковым пространством
будет лучше создать для /var, /tmp и /home собственные разделы, отдельные от /.

You might need a separate /usr/local partition if you plan to install many
programs that are not part of the Debian distribution. If your machine will be
a mail server, you might need to make /var/mail a separate partition. If you
are setting up a server with lots of user accounts, it's generally good to have
a separate, large /home partition. In general, the partitioning situation
varies from computer to computer depending on its uses.

Для очень сложных систем вы должны прочитать Multi Disk HOWTO. В нём содержится
подробная информация, которая будет наиболее интересна провайдерам Интернет и
людям, настраивающим серверы.

With respect to the issue of swap partition size, there are many views. One
rule of thumb which works well is to use as much swap as you have system
memory. It also shouldn't be smaller than 512MB, in most cases. Of course,
there are exceptions to these rules.

As an example, an older home machine might have 512MB of RAM and a 20GB SATA
drive on /dev/sda. There might be a 8GB partition for another operating system
on /dev/sda1, a 512MB swap partition on /dev/sda3 and about 11.4GB on /dev/sda2
as the Linux partition.

Про то, как будет использовано дисковое пространство можно определить по
задачам, которые вы захотите установить после установки системы; смотрите
Раздел D.2, «Дисковое пространство, необходимое для задач».

C.4. Имена устройств в Linux

Имена дисков и разделов в Linux могут отличаться от имён в других операционных
системах. Для того чтобы создавать и монтировать разделы вам нужно знать какие
имена используются в Linux. Вот основы схемы именования:

  • Первый обнаруженный жёсткий диск называется /dev/sda.

  • Второй обнаруженный жёсткий диск называется /dev/sdbи так далее.

  • Первый SCSI CD-ROM называется /dev/scd0, также можно использовать /dev/sr0.

Имена разделов диска получаются добавлением к имени диска десятичного числа:
sda1 и sda2 представляют первый и второй разделы на первом диске SCSI в
системе.

Вот реальный пример. Предположим, что вы имеете систему с 2-мя SCSI дисками,
один имеет SCSI адрес 2, а другой SCSI адрес 4. Первый диск (с адресом 2)
называется sda, а второй sdb. Если диск sda содержит 3 раздела, то их имена
будут sda1, sda2 и sda3. То же относится к диску sdb и его разделам.

Заметим, что если вы имеете два адаптера SCSI (то есть, контроллера), то
порядок дисков может показаться непонятным. Лучшее решение в этом случае
посмотреть загрузочные сообщения; предполагается, что вы знаете модели дисков и
/или их объём.

В Linux первичные разделы представляются как имя диска плюс число от 1 до 4.
Например, первый первичный раздел первого диска называется /dev/sda1.
Логические разделы нумеруются начиная с 5, поэтому первый логический раздел на
том же диске называется /dev/sda5. Помните, что это расширенный раздел, то есть
первичный раздел содержащий логические разделы, сам по себе не использующийся.

C.5. Программы разметки в Debian

Для работы с различными типами жёстких дисков и компьютерных архитектур
разработчиками Debian были адаптированы несколько разновидностей программ
разметки. На вашей машине могут работать программы, представленные в списке
далее.

partman

    Рекомендуемая утилита разметки в Debian. Этот швейцарский армейский нож
    может также изменять размеры разделов, создавать файловые системы (как «
    format» в Windows) и назначать им точки монтирования.

fdisk

    Самая первая программа разметки дисков в Linux, хороша для гуру.

    Будьте осторожны, если у вас на машине есть разделы FreeBSD. В
    устанавливаемые ядра включена поддержка этих разделов, но способ их
    отображения в fdisk может отличаться. Смотрите Linux+FreeBSD HOWTO

cfdisk

    Простая в использовании, полноэкранная программа разметки дисков для
    повседневного использования.

    Заметим, что cfdisk не понимает разделов FreeBSD, и ещё раз, поэтому имена
    устройств могут различаться.

Одна из этих программ будет запущена по умолчанию, когда вы выберете Разметка
дисков (или типа того). Возможно использовать другую утилиту разметки из
командной строки на VT2, но это не рекомендуется.

Не забудьте пометить раздел загрузки как «Загрузочный».

C.5.1. Разметка для 64-bit PC

If you are using a new harddisk (or want to wipe out the whole partition table
of your disk), a new partition table needs to be created. The «Guided
partitioning» does this automatically, but when partitioning manually, move the
selection on the top-level entry of the disk and hit Enter. That will create a
new partition table on that disk. In expert mode, you will then be asked for
the type of the partition table. Default for UEFI-based systems is «gpt», while
for the older BIOS world the default value is «msdos». In a standard priority
installation those defaults will be used automatically.

Примечание

When a partition table with type «gpt» was selected (default for UEFI systems),
a free space of 1 MB will automatically get created at the beginning of the
disk. This is intended and required to embed the GRUB2 bootloader.

If you have an existing other operating system such as Windows and you want to
preserve that operating system while installing Debian, you may need to resize
its partition to free up space for the Debian installation. The installer
supports resizing of both FAT and NTFS filesystems; when you get to the
installer's partitioning step, select the option Manual and then simply select
an existing partition and change its size.

While modern UEFI systems don't have such limitations as listed below, the old
PC BIOS generally adds additional constraints for disk partitioning. There is a
limit to how many «primary» and «logical» partitions a drive can contain.

On such old PC BIOS system, «primary» partitions are the original partitioning
scheme for PC disks. However, there can only be four of them. To get past this
limitation, «extended» and «logical» partitions were invented. By setting one
of your primary partitions as an extended partition, you can subdivide all the
space allocated to that partition into logical partitions. You can create up to
60 logical partitions per extended partition; however, you can only have one
extended partition per drive.

Приложение D. Разное

Содержание

D.1. Устройства Linux
    D.1.1. Установка мыши
D.2. Дисковое пространство, необходимое для задач
D.3. Установка Debian GNU/Linux из системы Unix/Linux
    D.3.1. Начинаем
    D.3.2. Установка debootstrap
    D.3.3. Запуск debootstrap
    D.3.4. Настройка базовой системы
    D.3.5. Установка ядра
    D.3.6. Установка системного загрузчика
    D.3.7. Удалённый доступ: установка SSH и настройка доступа
    D.3.8. Заключительные шаги
D.4. Установка Debian GNU/Linux через Parallel Line IP (PLIP)
    D.4.1. Требования
    D.4.2. Настройка источника
    D.4.3. Установка приёмника
D.5. Установка Debian GNU/Linux с использованием PPP через Ethernet (PPPoE)

D.1. Устройства Linux

В Linux в каталоге /dev содержатся различные специальные файлы. Эти файлы
называются файлами устройств. Доступ к устройствам в мире Unix отличается от
того, как это сделано в других операционных системах. Здесь это делается через
специальный файл, который в действительности обслуживается драйвером (часть
ядра Linux), осуществляющим доступ к устройству. Другим, менее используемым
типов файла устройства является канал. Ниже перечислены наиболее важные файлы
устройств.

┌────┬──────────────────────────────────────┐
│sda │Первый жёсткий диск                   │
├────┼──────────────────────────────────────┤
│sdb │Второй жёсткий диск                   │
├────┼──────────────────────────────────────┤
│sda1│Первый раздел на первом жёстком диске │
├────┼──────────────────────────────────────┤
│sdb7│Седьмой раздел на втором жёстком диске│
└────┴──────────────────────────────────────┘

┌───┬──────────────┐
│sr0│Первый CD-ROM │
├───┼──────────────┤
│sr1│Второй CD-ROM │
└───┴──────────────┘

┌───────┬──────────────────────────────────────────────────────────┐
│ttyS0  │Serial port 0, also referred to as COM1                   │
├───────┼──────────────────────────────────────────────────────────┤
│ttyS1  │Serial port 1, also referred to as COM2                   │
├───────┼──────────────────────────────────────────────────────────┤
│psaux  │Устройство мышь PS/2                                      │
├───────┼──────────────────────────────────────────────────────────┤
│gpmdata│Псевдо-устройство, повторитель данных от демона GPM (мыши)│
└───────┴──────────────────────────────────────────────────────────┘

┌─────┬────────────────────────────────────────────┐
│cdrom│Символическая ссылка на привод CD-ROM       │
├─────┼────────────────────────────────────────────┤
│mouse│Символическая ссылка на файл устройства мыши│
└─────┴────────────────────────────────────────────┘

┌────┬────────────────────────────────────────────────┐
│null│Всё, что записывается в это устройство, исчезнет│
├────┼────────────────────────────────────────────────┤
│zero│Можно бесконечно читать нули из этого устройства│
└────┴────────────────────────────────────────────────┘

D.1.1. Установка мыши

Мышь можно использовать одновременно в консоли Linux (с помощью gpm) и в среде
X window. Обычно, для этого достаточно установить gpm и X-сервер. Они должны
быть настроены на использование /dev/input/mice в качестве устройства мыши. В
gpm нужно установить протокол работы с мышью exps2, а в X -- ExplorerPS/2. Это
производится в соответствующих файлах настройки /etc/gpm.conf и /etc/X11/
xorg.conf.

D.2. Дисковое пространство, необходимое для задач

A standard installation for the amd64 architecture, including all standard
packages and using the default kernel, takes up 843MB of disk space. A minimal
base installation, without the «Standard system utilities» task selected, will
take 647MB.

Важно

В обоих случаях -- это реальное дисковое пространство, которое используется 
после завершения установки и удаления всех временных файлов. Сюда не входит
место, занятое в файловой системе, например, журнальными файлами. Это означает,
что во время процесса установки и просто работы системы потребуется значительно
больше места на диске.

В таблице ниже приведено количество используемого места при установке задач,
описанных в tasksel. Данные величины получены с помощью aptitude. Заметим, что
некоторые пакеты входят в несколько задач одновременно, поэтому полный размер
установки для двух задач вместе может быть меньше, чем полный размер,
полученный сложением размеров.

By default the installer will install the GNOME desktop environment, but
alternative desktop environments can be selected either by using one of the
special installation images, or by specifying the desired desktop environment
during installation (see Раздел 6.3.6.2, «Выбор и установка программного
обеспечения»).

Заметьте, что при подсчёте размера разделов к размеру стандартной установки
нужно добавить размеры из таблицы. Большинство размеров из колонки «Размер
после установки» нужно приплюсовывать к /usr и /lib, а размеры из колонки «
Размер загрузки» занимает место (временно) в /var.

┌─────────────────┬───────────────────┬──────────────┬────────────────────────┐
│     Задача      │   Размер после    │    Размер    │  Требуемое место для   │
│                 │  установки (МБ)   │загрузки (МБ) │     установки (МБ)     │
├─────────────────┼───────────────────┼──────────────┼────────────────────────┤
│Окружение        │                   │              │                        │
│рабочего стола   │                   │              │                        │
├─────────────────┼───────────────────┼──────────────┼────────────────────────┤
│  • GNOME (по    │3323               │861           │4184                    │
│умолчанию)       │                   │              │                        │
├─────────────────┼───────────────────┼──────────────┼────────────────────────┤
│  • KDE Plasma   │5429               │1499          │6928                    │
├─────────────────┼───────────────────┼──────────────┼────────────────────────┤
│  • Xfce         │2771               │734           │3505                    │
├─────────────────┼───────────────────┼──────────────┼────────────────────────┤
│  • LXDE         │2635               │708           │3343                    │
├─────────────────┼───────────────────┼──────────────┼────────────────────────┤
│  • MATE         │3197               │832           │4029                    │
├─────────────────┼───────────────────┼──────────────┼────────────────────────┤
│  • Cinnamon     │3852               │1027          │4879                    │
├─────────────────┼───────────────────┼──────────────┼────────────────────────┤
│веб сервер       │116                │26            │142                     │
├─────────────────┼───────────────────┼──────────────┼────────────────────────┤
│SSH-сервер       │2                  │1             │3                       │
└─────────────────┴───────────────────┴──────────────┴────────────────────────┘

Если вы выбрали установку не на английском языке, tasksel может автоматически
установить задачу по локализации, если она существует для вашего языка.
Необходимое пространство на диске зависит от языка; добавьте около 350 МБ на
загрузку и установку.

D.3. Установка Debian GNU/Linux из системы Unix/Linux

В этом разделе объясняется, как установить Debian GNU/Linux из существующей
системы Unix или Linux без использования управляемой из меню программы
установки, основанной на библиотеке ncurses, как это описывается в остальном
руководстве. Это «междистрибутивное» HOWTO попросили пользователи, переходящие
на Debian GNU/Linux из Redhat, Mandriva и SUSE. В этом разделе подразумевается
наличие некоторого опыта работы с командами *nix и навигации по файловой
системе. Здесь символ $ означает команду, вводимую в текущей пользовательской
системе, а # относится к команде, вводимой в Debian chroot.

Как только вы получите новую систему Debian, настроенную по вашим
предпочтениям, вы можете перенести свои данные (если они есть) в неё и
продолжать работу. Поэтому такая установка Debian GNU/Linux считается «с
нулевым временем простоя» (zero downtime). Также это мудрый способ работы с
аппаратурой, которая не может нормально работать с разными загрузочными или
установочными носителями.

Примечание

Так как это, по большей части, ручная процедура, вы должны помнить, что вам
придётся сделать множество начальных настроек системы самостоятельно, которые
также требуют больше знаний о Debian и Linux в общем, чем при выполнение
обычной установки. Вы не должны ожидать, что эта процедура настроит вам систему
так, как это делается при обычной установке. Также вы должны помнить,что эта
процедура выполняет только основные этапы настройки системы. Может
потребоваться дополнительная установка и/или настройка.

D.3.1. Начинаем

С помощью имеющихся утилит *nix для работы с разделами диска, переразметьте
диск как нужно, создав не менее одной файловой системы и раздел подкачки
(swap). Вам потребуется около 647 МБ для консольной версии установки или около
2635 МБ, если вы планируете установить X (или ещё больше, если вы будете
устанавливать окружение рабочего стола типа GNOME или KDE Plasma).

Затем создайте файловые системы на разделах. Например, чтобы создать файловую
систему ext3 на разделе /dev/sda6 (это корневой раздел в нашем примере):

# mke2fs -j /dev/sda6

Чтобы создать файловую систему ext2, не указывайте параметр -j.

Проинициализируйте и активируйте раздел подкачки (замените номер раздела на
свой):

# mkswap /dev/sda5
# sync
# swapon /dev/sda5

Смонтируйте один раздел как /mnt/debinst (точка установки, она будет корневой
(/) файловой системой в вашей новой системе). Имя точки монтирования абсолютно
произвольное.

# mkdir /mnt/debinst
# mount /dev/sda6 /mnt/debinst

Примечание

Если вы хотите монтировать некоторые файловые системы (например, /usr) с
отдельных разделов, то нужно создать и смонтировать эти каталоги вручную, перед
тем как перейти к следующему этапу.

D.3.2. Установка debootstrap

Утилита, которой пользуется программа установки Debian и которая признана
официальным способом установки базовой системы Debian является debootstrap. Она
использует wget и ar, но зависит только от /bin/sh и часто используемых
инструментов Unix/Linux^[21]. Установите wget и ar, если их ещё нет в системе,
а затем загрузите и установите debootstrap.

Или вы можете использовать следующую процедуру установки вручную. Создайте
рабочий каталог для распаковки в него .deb:

# mkdir work
# cd work

Двоичный файл debootstrap расположен в архиве Debian (убедитесь, что вы выбрали
правильный файл, соответствующий вашей архитектуре). Скачайте debootstrap .deb
из пула, скопируйте пакет в рабочий каталог и извлеките из него файлы. Для
установки файлов вам потребуются привилегии суперпользователя (root).

# ar -x debootstrap_0.X.X_all.deb
# cd /
# zcat /full-path-to-work/work/data.tar.gz | tar xv

D.3.3. Запуск debootstrap

Команда debootstrap может скачивать необходимые файлы прямо из архива. В
примере ниже вы можете заменить http.us.debian.org/debian на любой
сервер-зеркало архива Debian, лучше всего использовать из наиболее близкой к
вам сети. Список серверов http://www.debian.org/mirror/list.

If you have a trixie Debian GNU/Linux installation image mounted at /cdrom, you
could substitute a file URL instead of the http URL: file:/cdrom/debian/

Замените ARCH в команде debootstrap на один из следующих вариантов: amd64,
arm64, armhf, ppc64el, riscv64, s390x.

# /usr/sbin/debootstrap --arch ARCH trixie \
     /mnt/debinst http://ftp.us.debian.org/debian

Если целевая архитектура отличается от архитектуры узла, то добавьте параметр
--foreign.

D.3.4. Настройка базовой системы

Теперь у вас есть настоящая система Debian на диске, хотя и небогатая
возможностями. Выполните chroot в неё:

# LANG=C.UTF-8 chroot /mnt/debinst /bin/bash

Если целевая архитектура отличается от архитектуры узла, то сначала вам нужно
скопировать на узел qemu-user-static:

# cp /usr/bin/qemu-ARCH-static /mnt/debinst/usr/bin
# LANG=C.UTF-8 chroot /mnt/debinst qemu-ARCH-static /bin/bash

После выполнения chroot, вам может потребоваться выполнить настройку терминала
для совместимости с базовой системой Debian, например:

# export TERM=xterm-color

В зависимости от значения TERM, вам может потребоваться установить пакет
ncurses-term для поддержки терминала.

Если целевая архитектура отличается от архитектуры узла, вам нужно завершить
многоступенчатую начальную загрузку:

/debootstrap/debootstrap --second-stage

D.3.4.1. Создание файлов устройств

В данный момент /dev/ содержит только основные файлы устройств. Для следующих
этапов установки могут потребоваться дополнительные файлы устройств. Есть
несколько способов их создания; выбор более подходящего зависит от: a) системы,
с которой производится установка; б) будет ли использоваться модульность ядро;
в) используются в новой системе динамические (например, посредством udev) или
статические файлы устройств.

Некоторые доступные способы:

  • установка пакета makedev и создание используемого по умолчанию набора
    статических файлов устройств (после выполнения chroot)

    # apt install makedev
    # mount none /proc -t proc
    # cd /dev
    # MAKEDEV generic

  • создание вручную только выбранных файлов устройств с помощью MAKEDEV

  • привязка смонтированного /dev имеющейся системы поверх /dev в
    устанавливаемой системе; заметим, что сценарии postinst некоторых пакетов
    могут пытаться создавать файлы устройств, поэтому данный параметр нужно
    использовать осторожно

D.3.4.2. Монтирование разделов

You need to create /etc/fstab.

# editor /etc/fstab

Here is a sample you can modify to suit:

# /etc/fstab: static file system information.
#
# file system    mount point   type    options                  dump pass
/dev/XXX         /             ext3    defaults                 0    1
/dev/XXX         /boot         ext3    ro,nosuid,nodev          0    2

/dev/XXX         none          swap    sw                       0    0
proc             /proc         proc    defaults                 0    0

/dev/cdrom       /media/cdrom  iso9660 noauto,ro,user,exec      0    0

/dev/XXX         /tmp          ext3    rw,nosuid,nodev          0    2
/dev/XXX         /var          ext3    rw,nosuid,nodev          0    2
/dev/XXX         /usr          ext3    rw,nodev                 0    2
/dev/XXX         /home         ext3    rw,nosuid,nodev          0    2

Use mount -a to mount all the file systems you have specified in your /etc/
fstab, or, to mount file systems individually, use:

# mount /path   # e.g.: mount /usr

Current Debian systems have mountpoints for removable media under /media, but
keep compatibility symlinks in /. Create these as as needed, for example:

# cd /media
# mkdir cdrom0
# ln -s cdrom0 cdrom
# cd /
# ln -s media/cdrom

You can mount the proc file system multiple times and to arbitrary locations,
though /proc is customary. If you didn't use mount -a, be sure to mount proc
before continuing:

# mount -t proc proc /proc

Команда ls /proc теперь должна показывать, что каталог не пустой. Если это не
так, можно смонтировать proc за пределами chroot:

# mount -t proc proc /mnt/debinst/proc

D.3.4.3. Настройка часового пояса

Настройка в третьей строке файла /etc/adjtime имеет значение «UTC» или «LOCAL»
и определяет как система должна интерпретировать аппаратные часы -- установлены
ли они по UTC или показывают местное время. Следующая команда позволяет указать
это.

# editor /etc/adjtime

Пример:

0.0 0 0.0
0
UTC

Следующая команда позволяет указать часовой пояс.

# dpkg-reconfigure tzdata

D.3.4.4. Настройка сети

Для настройки сети, отредактируйте /etc/network/interfaces, /etc/resolv.conf, /
etc/hostname и /etc/hosts.

# editor /etc/network/interfaces

Здесь приведены некоторые простые примеры из /usr/share/doc/ifupdown/examples:

######################################################################
# /etc/network/interfaces -- configuration file for ifup(8), ifdown(8)
# See the interfaces(5) manpage for information on what options are
# available.
######################################################################

# The loopback interface isn't really required any longer, but can be used
# if needed.
#
# auto lo
# iface lo inet loopback

# To use dhcp:
#
# auto eth0
# iface eth0 inet dhcp

# An example static IP setup: (network, broadcast and gateway are optional)
#
# auto eth0
# iface eth0 inet static
#     address 192.168.0.42
#     network 192.168.0.0
#     netmask 255.255.255.0
#     broadcast 192.168.0.255
#     gateway 192.168.0.1

Укажите ваши серверы имён и директивы поиска в /etc/resolv.conf:

# editor /etc/resolv.conf

Пример простого /etc/resolv.conf:

search hqdom.local
nameserver 10.1.1.36
nameserver 192.168.9.100

Укажите системное имя узла (от 2 до 63 символов):

# echo DebianHostName > /etc/hostname

И базовый /etc/hosts с поддержкой IPv6:

127.0.0.1 localhost
127.0.1.1 DebianHostName

# The following lines are desirable for IPv6 capable hosts
::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
ff02::3 ip6-allhosts

Если у вас несколько сетевых карт, то вам нужно разместить имена модулей
драйверов в файле /etc/modules в желаемом порядке. Позже при загрузке каждая
карта будет связана с именем интерфейса (eth0, eth1 и т.д.) как вы и ожидали.

D.3.4.5. Настройка Apt

Debootstrap создаст очень общий /etc/apt/sources.list, который позволит
установить дополнительные пакеты. Однако, вы можете захотеть добавить
дополнительные источники, например для пакетов с исходным кодом и обновлений
безопасности:

deb-src http://ftp.us.debian.org/debian trixie main

deb http://security.debian.org/ trixie-security main
deb-src http://security.debian.org/ trixie-security main

Обязательно запустите apt update после изменения списка источников.

D.3.4.6. Настройка раскладки клавиатуры и локалей

Чтобы использовать язык, отличный от английского, нужно настроить локаль. Для
этого установите пакет поддержки locales и настройте его. Рекомендуется
использовать UTF-8 локали.

# apt install locales
# dpkg-reconfigure locales

Для настройки раскладки клавиатуры (если нужно):

# apt install console-setup
# dpkg-reconfigure keyboard-configuration

Заметим, что клавиатура не может быть настроена, пока работа производится в
chroot, но настройка будет произведена после следующей перезагрузки.

D.3.5. Установка ядра

Если вы намерены загружать эту систему, то вам скорее всего понадобится ядро
Linux и системный загрузчик. Определите доступные пакеты с ядрами с помощью:

# apt search linux-image

Затем установите пакет с ядром, указав подходящий вам вариант.

# apt install linux-image-arch-etc

D.3.6. Установка системного загрузчика

Чтобы сделать систему Debian GNU/Linux загружаемой, настройте системный
загрузчик на загрузку установленного ядра с нового корневого раздела. Заметим,
что debootstrap не устанавливает системный загрузчик, хотя вы можете
использовать apt внутри вашего Debian chroot, чтобы сделать это.

Check info grub for instructions on setting up the bootloader. If you are
keeping the system you used to install Debian, just add an entry for the Debian
install to your existing grub2 grub.cfg.

Установить и настроить grub2 легко:

# apt install grub-pc
# grub-install /dev/sda
# update-grub

Вторая команда устанавливает grub2 (в данном случае в MBR диска sda). Последняя
команда создаёт приемлемый и рабочий файл /boot/grub/grub.cfg.

Заметим, что это предполагает, что файловое устройство /dev/sda было создано
ранее. Есть другие методы установки grub2, но они здесь не описаны.

D.3.7. Удалённый доступ: установка SSH и настройка доступа

Если вы можете войти в систему через консоль, то можете пропустить этот раздел.
Если система должна быть доступна через сеть, то вам нужно установить SSH и
настроить доступ.

# apt install ssh

По умолчанию вход суперпользователем с паролем запрещён, поэтому для настройки
доступа нужно задать пароль и включить вход для root с паролем:

# passwd
# editor /etc/ssh/sshd_config

Параметр для включения:

PermitRootLogin yes

Также, для учётной записи root возможен вход по ключу ssh:

# mkdir /root/.ssh
# cat << EOF > /root/.ssh/authorized_keys
ssh-rsa ....
EOF

И, наконец, настройка доступа для обычного пользователя с паролем:

# adduser joe
# passwd joe

D.3.8. Заключительные шаги

Как упоминалось ранее, установленная система мало что умеет. Если вы хотите
сделать систему более пригодной для работы, можно установить все пакеты с
приоритетом «стандарт»:

# tasksel install standard

Конечно, также вы можете использовать apt для установки отдельных пакетов.

После установки все скаченные пакеты будут сохранены в каталог /var/cache/apt/
archives/. Вы можете освободить немного места запустив:

# apt clean

D.4. Установка Debian GNU/Linux через Parallel Line IP (PLIP)

Этот раздел описывает установку Debian GNU/Linux на компьютер без сетевой карты
Ethernet, но подключённый к другому компьютеру-шлюзу с помощью нуль-модемного
кабеля (также называемого нуль-принтерным кабелем). Компьютер-шлюз должен быть
подключён к сети, где есть сервер-зеркало Debian (например, к Интернет).

В примере, показанном в приложении, мы будем настраивать PLIP соединение со
шлюзом подключённым к Интернет через соединение по телефонной линии (ppp0). Мы
будет использовать IP-адреса 192.168.0.1 и 192.168.0.2 для PLIP интерфейсов
системы приёмника и системы источника соответственно(эти адреса не должны
использоваться в вашем сетевом адресном пространстве).

PLIP соединение, настроенное в время установки будет также работать и после
перезагрузки в установленную систему (смотрите Глава 7, Загрузка только что
установленной системы Debian).

Перед тем как начать, проверьте настройки BIOS (IO base address и IRQ)
параллельных портов на обеих системах. Наиболее распространённые значения: io=
0x378, irq=7.

D.4.1. Требования

  • На компьютер приёмник, называемый приёмник, будет установлен Debian.

  • Системные установочные носители; смотрите Раздел 2.4, «Установочные
    носители».

  • Другой компьютер, подключённый к Интернет, называемый источник, будет
    использоваться в качестве шлюза.

  • Нуль-модемный кабель DB-25. Подробней о кабеле и как его сделать смотрите
    PLIP-Install-HOWTO.

D.4.2. Настройка источника

Сценарий, показанный ниже -- это простой пример настройки компьютера источника
в качестве шлюза в Интернет через ppp0.

#!/bin/sh

# We remove running modules from kernel to avoid conflicts and to
# reconfigure them manually.
modprobe -r lp parport_pc
modprobe parport_pc io=0x378 irq=7
modprobe plip

# Configure the plip interface (plip0 for me, see dmesg | grep plip)
ifconfig plip0 192.168.0.2 pointopoint 192.168.0.1 netmask 255.255.255.255 up

# Configure gateway
modprobe iptable_nat
iptables -t nat -A POSTROUTING -o ppp0 -j MASQUERADE
echo 1 > /proc/sys/net/ipv4/ip_forward

D.4.3. Установка приёмника

Загрузитесь с установочного носителя. Установка должна быть запущена в
экспертном режиме; в приглашении к загрузке введите expert. Если требуется
задать параметры для модулей ядра, вы также должны указать их в приглашении к
загрузке. Например, для загрузки программы установки и настройки значений
параметров «io» и «irq» для модуля parport_pc, введите следующее:

expert parport_pc.io=0x378 parport_pc.irq=7

Ниже показаны ответы, которые нужно ввести на различных этапах установки.

 1. Load installer components from installation media

    В списке выберите параметр plip-modules; это сделает доступным PLIP
    драйвера для программы установки.

 2. Определение сетевой карты

      □ Если приёмник имеет сетевую карту, будет показан список модулей
        драйверов для обнаруженных карт. Если вы хотите, чтобы debian-installer
        использовал всё равно plip, то снимите выделение со всех показанных
        модулей драйверов. Естественно, если приёмник не имеет сетевой карты,
        программа установки не покажет этого списка.

      □ Так как ранее сетевой карты обнаружено/выбрано не было, программа
        установки попросит выбрать модуль сетевого устройства из списка.
        Выберите модуль plip.

 3. Настройка сети

      □ Настроить сеть автоматически с помощью DHCP: нет

      □ IP-адрес: 192.168.0.1

      □ Адрес PPP: 192.168.0.2

      □ Адреса DNS-серверов: можно указать те же адреса что и для источника
        (смотрите /etc/resolv.conf)

D.5. Установка Debian GNU/Linux с использованием PPP через Ethernet (PPPoE)

В некоторых странах PPP через Ethernet (PPPoE) является широко распространённым
протоколом для широкополосных подключений (ADSL или кабельных) к провайдеру
сервиса Интернет. По умолчанию программа установки не поддерживает настройку
сети с использованием PPPoE, но этого можно легко добиться. В этом разделе
будет описано как это сделать.

PPPoE соединение, настроенное в время установки, будет также работать и после
перезагрузки в установленную систему (смотрите Глава 7, Загрузка только что
установленной системы Debian).

To have the option of setting up and using PPPoE during the installation, you
will need to install using one of the CD-ROM/DVD images that are available. It
is not supported for other installation methods (e.g. netboot).

Процесс установки через PPPoE практически не отличается от любого другого
способа установки. Далее будут описаны различия.

  • Загрузите программу установки с параметром загрузки modules=ppp-udeb^[22].
    Это гарантирует, что компонента PPPoE (ppp-udeb) будет загружена и и
    запущена автоматически.

  • Далее выполните обычные начальные шаги установки (выбор языка, страны и
    клавиатуры; загрузка дополнительных компонент программы установки^[23]).

  • На следующем этапе происходит определение сетевого аппаратного обеспечения
    с целью распознавания имеющихся в системе карт Ethernet.

  • После этого запускается настройка PPPoE. Программа установки попытается
    найти концентратор PPPoE (специальный сервер обработки подключений PPPoE)
    через все найденные интерфейсы Ethernet.

    Может случиться так, что концентратор не будет найден с первой попытки. Это
    может происходить из-за медленной или перегруженной сети или серверов. В
    большинстве случаев вторая попытка обнаружения концентратора будет
    успешной; чтобы попытаться ещё раз, выберите Настройка и установление
    PPPoE-соединения из главного меню программы установки.

  • После того как концентратор найден, будет предложено ввести регистрационную
    информацию (имя пользователя и пароль для PPPoE).

  • С этого момента программа установки будет использовать полученную
    информацию для установления соединения PPPoE. Если всё правильно,
    соединение PPPoE должно настроиться и программа установки сможет
    использовать его для подключения к Интернет и получения пакетов (если
    потребуется). Если регистрационная информация неверна или возникли какие-то
    ошибки, то программа установки остановится, но настройку можно попытаться
    повторить ещё раз выбрав в меню Настройка и установление PPPoE-соединения.


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[21] Сюда входят базовые утилиты GNU и команды типа sed, grep, tar и gzip.

^[22] О том, как добавлять загрузочные параметры, см. Раздел 5.1.5, «Экран
запуска»

^[23] Компонента ppp-udeb загружается на этом этапе как одна из дополнительных
компонент. При выполнении установки со средним или низким приоритетом
(экспертный режим), можно вручную выбрать ppp-udeb, а не вводить параметр «
modules» в строке приглашения к загрузке.

Приложение E. Общие сведения

Содержание

E.1. Об этом документе
E.2. Как помочь в разработке этого документа
E.3. Люди, внёсшие значительный вклад в написание этого руководства
E.4. Торговые марки

E.1. Об этом документе

Настоящее руководство было создано для программы debian-installer из Sarge, оно
основано на руководстве по установке c использованием boot-floppies
дистрибутива Woody, которое в свою очередь было основано на более ранних
руководствах по установке Debian, а также на руководстве дистрибутива Progeny,
выпущенном под лицензией GPL в 2003 году.

При написании этого документа использовался формат DocBook XML. Выходные
форматы созданы различными программами при помощи данных из пакетов docbook-xml
и docbook-xsl.

В целях повышения удобства сопровождения этого документа, мы применяем
некоторые возможности XML, такие как сущности (entities) и профилирующие
атрибуты (profiling attributes). Они играют роль, схожую с переменными и
условиями в языках программирования. Исходный XML-текст этого документа
содержит информацию обо всех архитектурах, а для изоляции
архитектурно-зависимых кусочков текста использованы профилирующие атрибуты.

E.2. Как помочь в разработке этого документа

При наличии проблем или предложений по этому документу, лучше всего отправить
их в виде сообщения об ошибке в пакете installation-guide. Как это сделать
можно прочитать в документации к пакету reportbug или на сайте системы
отслеживания ошибок Debian. Также загляните в список открытых ошибок
руководства по установке, не сообщил ли уже кто-то о вашей проблеме. Если такая
ошибка есть, то вы можете послать дополнительную или полезную информацию на
адрес <XXXX@bugs.debian.org>, где XXXX -- это номер сообщённой ошибки.

Ещё лучше взять копию исходных текстов этого документа в формате DocBook и
сделать заплатку к ним. Исходные тексты можно найти в проекте
installation-guide на salsa. Если вы не знакомы в DocBook, не беспокойтесь: в
каталоге с руководствами есть простая шпаргалка, которая поможет вам приступить
к работе. DocBook похож на html, но ориентирован на содержание текста, а не на
его представление. Заплаткам в списке рассылки debian-boot (смотрите ниже)
всегда рады. О том, как получить исходные тексты через git, можно прочитать в
файле README, который находится в корне каталога с исходными текстами.

Не связывайтесь с авторами этого документа напрямую -- для обсуждения в том
числе и этого руководства существует список рассылки debian-installer, который
доступен по адресу <debian-boot@lists.debian.org>. На странице подписки на
списки рассылки Debian описано, как на него можно подписаться. Также доступны
архивы этого и других списков.

E.3. Люди, внёсшие значительный вклад в написание этого руководства

Первоначально, этот документ был написан Брюсом Перенсом (Bruce Perens), Свеном
Рудольфом (Sven Rudolph), Игорем Гробманом (Igor Grobman), Джеймсом Триси
(James Treacy) и Адамом Ди Карло (Adam Di Carlo). Себастьян Лей (Sebastian)
написал "Краткое руководство по установке".

Мирослав Куре (Miroslav Kuře) описал много новых возможностей в в
debian-installer из Sarge. Франц Поп (Frans Pop) был главным редактором и
ответственным за выпуск в дистрибутивах Etch, Lenny и Squeeze.

Очень многие пользователи и разработчики Debian внесли свой вклад в этот
документ. Особо нужно отметить Михаэля Шмитца (Michael Schmitz) (поддержка
m68k), Франка Нойманна (Frank Neumann) (первый автор руководства по установке
на Amiga), Арто Астала (Arto Astala), Эрика Делонея (Eric Delaunay), Бена
Коллинза (Ben Collins) (все трое -- информация по SPARC), Тапио Лейтонена
(Tapio Lehtonen) и Стефана Бортцмайера (Stéphane Bortzmeyer) за тексты и
многочисленные правки. Мы благодарим Паскаля ЛеБеля (Pascal Le Bail) за
полезную информацию о загрузке с USB-карт памяти.

Множество полезной информации можно найти в HOWTO по сетевой загрузке под
авторством Джима Минта (Jim Mintha) (URL на данный момент недоступен), Debian
FAQ, Linux/m68k FAQ, FAQ по Linux для процессоров SPARC, Linux/Alpha FAQ и в
других документах. Мы хотим поблагодарить сопровождающих этих свободно
доступных и полезных источников информации.

При создании раздела о chroot установке (Раздел D.3, «Установка Debian GNU/
Linux из системы Unix/Linux») были использованы материалы, написанные Карстеном
М. Селфом (Karsten M. Self).

При создании раздела об установке через plip соединение (Раздел D.4, «Установка
Debian GNU/Linux через Parallel Line IP (PLIP)») было использовано
PLIP-Install-HOWTO, написанное Гилесом Ламиралем (Gilles Lamiral).

E.4. Торговые марки

Все торговые марки являются собственностью их владельцев.

Приложение F. GNU General Public License

Version 2, June 1991

Copyright (C) 1989, 1991 Free Software Foundation, Inc.
51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA.

Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.

F.1. Preamble

The licenses for most software are designed to take away your freedom to share
and change it. By contrast, the gnu General Public License is intended to
guarantee your freedom to share and change free software -- to make sure the
software is free for all its users. This General Public License applies to most
of the Free Software Foundation's software and to any other program whose
authors commit to using it. (Some other Free Software Foundation software is
covered by the gnu Library General Public License instead.) You can apply it to
your programs, too.

When we speak of free software, we are referring to freedom, not price. Our
General Public Licenses are designed to make sure that you have the freedom to
distribute copies of free software (and charge for this service if you wish),
that you receive source code or can get it if you want it, that you can change
the software or use pieces of it in new free programs; and that you know you
can do these things.

To protect your rights, we need to make restrictions that forbid anyone to deny
you these rights or to ask you to surrender the rights. These restrictions
translate to certain responsibilities for you if you distribute copies of the
software, or if you modify it.

For example, if you distribute copies of such a program, whether gratis or for
a fee, you must give the recipients all the rights that you have. You must make
sure that they, too, receive or can get the source code. And you must show them
these terms so they know their rights.

We protect your rights with two steps: (1) copyright the software, and (2)
offer you this license which gives you legal permission to copy, distribute and
/or modify the software.

Also, for each author's protection and ours, we want to make certain that
everyone understands that there is no warranty for this free software. If the
software is modified by someone else and passed on, we want its recipients to
know that what they have is not the original, so that any problems introduced
by others will not reflect on the original authors' reputations.

Finally, any free program is threatened constantly by software patents. We wish
to avoid the danger that redistributors of a free program will individually
obtain patent licenses, in effect making the program proprietary. To prevent
this, we have made it clear that any patent must be licensed for everyone's
free use or not licensed at all.

The precise terms and conditions for copying, distribution and modification
follow.

F.2. GNU GENERAL PUBLIC LICENSE

TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION

0. This License applies to any program or other work which contains a notice
placed by the copyright holder saying it may be distributed under the terms of
this General Public License. The «Program», below, refers to any such program
or work, and a «work based on the Program» means either the Program or any
derivative work under copyright law: that is to say, a work containing the
Program or a portion of it, either verbatim or with modifications and/or
translated into another language. (Hereinafter, translation is included without
limitation in the term «modification».) Each licensee is addressed as «you».

Activities other than copying, distribution and modification are not covered by
this License; they are outside its scope. The act of running the Program is not
restricted, and the output from the Program is covered only if its contents
constitute a work based on the Program (independent of having been made by
running the Program). Whether that is true depends on what the Program does.

1. You may copy and distribute verbatim copies of the Program's source code as
you receive it, in any medium, provided that you conspicuously and
appropriately publish on each copy an appropriate copyright notice and
disclaimer of warranty; keep intact all the notices that refer to this License
and to the absence of any warranty; and give any other recipients of the
Program a copy of this License along with the Program.

You may charge a fee for the physical act of transferring a copy, and you may
at your option offer warranty protection in exchange for a fee.

2. You may modify your copy or copies of the Program or any portion of it, thus
forming a work based on the Program, and copy and distribute such modifications
or work under the terms of Section 1 above, provided that you also meet all of
these conditions:

 a. You must cause the modified files to carry prominent notices stating that
    you changed the files and the date of any change.

 b. You must cause any work that you distribute or publish, that in whole or in
    part contains or is derived from the Program or any part thereof, to be
    licensed as a whole at no charge to all third parties under the terms of
    this License.

 c. If the modified program normally reads commands interactively when run, you
    must cause it, when started running for such interactive use in the most
    ordinary way, to print or display an announcement including an appropriate
    copyright notice and a notice that there is no warranty (or else, saying
    that you provide a warranty) and that users may redistribute the program
    under these conditions, and telling the user how to view a copy of this
    License. (Exception: if the Program itself is interactive but does not
    normally print such an announcement, your work based on the Program is not
    required to print an announcement.)

These requirements apply to the modified work as a whole. If identifiable
sections of that work are not derived from the Program, and can be reasonably
considered independent and separate works in themselves, then this License, and
its terms, do not apply to those sections when you distribute them as separate
works. But when you distribute the same sections as part of a whole which is a
work based on the Program, the distribution of the whole must be on the terms
of this License, whose permissions for other licensees extend to the entire
whole, and thus to each and every part regardless of who wrote it.

Thus, it is not the intent of this section to claim rights or contest your
rights to work written entirely by you; rather, the intent is to exercise the
right to control the distribution of derivative or collective works based on
the Program.

In addition, mere aggregation of another work not based on the Program with the
Program (or with a work based on the Program) on a volume of a storage or
distribution medium does not bring the other work under the scope of this
License.

3. You may copy and distribute the Program (or a work based on it, under
Section 2) in object code or executable form under the terms of Sections 1 and
2 above provided that you also do one of the following:

 a. Accompany it with the complete corresponding machine-readable source code,
    which must be distributed under the terms of Sections 1 and 2 above on a
    medium customarily used for software interchange; or,

 b. Accompany it with a written offer, valid for at least three years, to give
    any third party, for a charge no more than your cost of physically
    performing source distribution, a complete machine-readable copy of the
    corresponding source code, to be distributed under the terms of Sections 1
    and 2 above on a medium customarily used for software interchange; or,

 c. Accompany it with the information you received as to the offer to
    distribute corresponding source code. (This alternative is allowed only for
    noncommercial distribution and only if you received the program in object
    code or executable form with such an offer, in accord with Subsection b
    above.)

The source code for a work means the preferred form of the work for making
modifications to it. For an executable work, complete source code means all the
source code for all modules it contains, plus any associated interface
definition files, plus the scripts used to control compilation and installation
of the executable. However, as a special exception, the source code distributed
need not include anything that is normally distributed (in either source or
binary form) with the major components (compiler, kernel, and so on) of the
operating system on which the executable runs, unless that component itself
accompanies the executable.

If distribution of executable or object code is made by offering access to copy
from a designated place, then offering equivalent access to copy the source
code from the same place counts as distribution of the source code, even though
third parties are not compelled to copy the source along with the object code.

4. You may not copy, modify, sublicense, or distribute the Program except as
expressly provided under this License. Any attempt otherwise to copy, modify,
sublicense or distribute the Program is void, and will automatically terminate
your rights under this License. However, parties who have received copies, or
rights, from you under this License will not have their licenses terminated so
long as such parties remain in full compliance.

5. You are not required to accept this License, since you have not signed it.
However, nothing else grants you permission to modify or distribute the Program
or its derivative works. These actions are prohibited by law if you do not
accept this License. Therefore, by modifying or distributing the Program (or
any work based on the Program), you indicate your acceptance of this License to
do so, and all its terms and conditions for copying, distributing or modifying
the Program or works based on it.

6. Each time you redistribute the Program (or any work based on the Program),
the recipient automatically receives a license from the original licensor to
copy, distribute or modify the Program subject to these terms and conditions.
You may not impose any further restrictions on the recipients' exercise of the
rights granted herein. You are not responsible for enforcing compliance by
third parties to this License.

7. If, as a consequence of a court judgment or allegation of patent
infringement or for any other reason (not limited to patent issues), conditions
are imposed on you (whether by court order, agreement or otherwise) that
contradict the conditions of this License, they do not excuse you from the
conditions of this License. If you cannot distribute so as to satisfy
simultaneously your obligations under this License and any other pertinent
obligations, then as a consequence you may not distribute the Program at all.
For example, if a patent license would not permit royalty-free redistribution
of the Program by all those who receive copies directly or indirectly through
you, then the only way you could satisfy both it and this License would be to
refrain entirely from distribution of the Program.

If any portion of this section is held invalid or unenforceable under any
particular circumstance, the balance of the section is intended to apply and
the section as a whole is intended to apply in other circumstances.

It is not the purpose of this section to induce you to infringe any patents or
other property right claims or to contest validity of any such claims; this
section has the sole purpose of protecting the integrity of the free software
distribution system, which is implemented by public license practices. Many
people have made generous contributions to the wide range of software
distributed through that system in reliance on consistent application of that
system; it is up to the author/donor to decide if he or she is willing to
distribute software through any other system and a licensee cannot impose that
choice.

This section is intended to make thoroughly clear what is believed to be a
consequence of the rest of this License.

8. If the distribution and/or use of the Program is restricted in certain
countries either by patents or by copyrighted interfaces, the original
copyright holder who places the Program under this License may add an explicit
geographical distribution limitation excluding those countries, so that
distribution is permitted only in or among countries not thus excluded. In such
case, this License incorporates the limitation as if written in the body of
this License.

9. The Free Software Foundation may publish revised and/or new versions of the
General Public License from time to time. Such new versions will be similar in
spirit to the present version, but may differ in detail to address new problems
or concerns. Each version is given a distinguishing version number. If the
Program specifies a version number of this License which applies to it and «any
later version», you have the option of following the terms and conditions
either of that version or of any later version published by the Free Software
Foundation. If the Program does not specify a version number of this License,
you may choose any version ever published by the Free Software Foundation.

10. If you wish to incorporate parts of the Program into other free programs
whose distribution conditions are different, write to the author to ask for
permission. For software which is copyrighted by the Free Software Foundation,
write to the Free Software Foundation; we sometimes make exceptions for this.
Our decision will be guided by the two goals of preserving the free status of
all derivatives of our free software and of promoting the sharing and reuse of
software generally.

NO WARRANTY

11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY FOR
THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT WHEN OTHERWISE
STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE
PROGRAM «AS IS» WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED,
INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY AND
PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE PROGRAM PROVE DEFECTIVE, YOU
ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.

12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL
ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR REDISTRIBUTE THE
PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY
GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR
INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA
BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A
FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS), EVEN IF SUCH HOLDER
OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.

END OF TERMS AND CONDITIONS

F.3. How to Apply These Terms to Your New Programs

If you develop a new program, and you want it to be of the greatest possible
use to the public, the best way to achieve this is to make it free software
which everyone can redistribute and change under these terms.

To do so, attach the following notices to the program. It is safest to attach
them to the start of each source file to most effectively convey the exclusion
of warranty; and each file should have at least the «copyright» line and a
pointer to where the full notice is found.

one line to give the program's name and a brief idea of what it does.
Copyright (C) year  name of author

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.

Also add information on how to contact you by electronic and paper mail.

If the program is interactive, make it output a short notice like this when it
starts in an interactive mode:

Gnomovision version 69, Copyright (C) year name of author
Gnomovision comes with absolutely no warranty; for details
type show w. This is free software, and you are welcome
to redistribute it under certain conditions; type show c
for details.

The hypothetical commands «show w» and «show c» should show the appropriate
parts of the General Public License. Of course, the commands you use may be
called something other than «show w» and «show c»; they could even be
mouse-clicks or menu items -- whatever suits your program.

You should also get your employer (if you work as a programmer) or your school,
if any, to sign a «copyright disclaimer» for the program, if necessary. Here is
a sample; alter the names:

Yoyodyne, Inc., hereby disclaims all copyright interest in the
program Gnomovision (which makes passes at compilers) written
by James Hacker.

signature of Ty Coon, 1 April 1989
Ty Coon, President of Vice

This General Public License does not permit incorporating your program into
proprietary programs. If your program is a subroutine library, you may consider
it more useful to permit linking proprietary applications with the library. If
this is what you want to do, use the GNU Lesser General Public License instead
of this License.

